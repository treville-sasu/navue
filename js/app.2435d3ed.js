(function(e){function webpackJsonpCallback(t){for(var r,i,n=t[0],o=t[1],u=t[2],l=0,d=[];l<n.length;l++)i=n[l],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);c&&c(t);while(d.length)d.shift()();return s.push.apply(s,u||[]),checkDeferredModules()}function checkDeferredModules(){for(var e,t=0;t<s.length;t++){for(var r=s[t],i=!0,n=1;n<r.length;n++){var o=r[n];0!==a[o]&&(i=!1)}i&&(s.splice(t--,1),e=__webpack_require__(__webpack_require__.s=r[0]))}return e}var t={},r={app:0},a={app:0},s=[];function jsonpScriptSrc(e){return __webpack_require__.p+"js/"+({}[e]||e)+"."+{"chunk-005ab131":"594b787a","chunk-313997a6":"fec7ec03","chunk-b6b35876":"d70da22c","chunk-62628b26":"50514f37","chunk-a7b1e534":"3471326a","chunk-4eb1fb42":"58531e2c","chunk-0fc0d246":"8904d73a","chunk-2d0c8dd2":"9a88fa8f","chunk-2d221f18":"b758eb1f","chunk-698fb2b4":"7041edc4"}[e]+".js"}function __webpack_require__(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,__webpack_require__),a.l=!0,a.exports}__webpack_require__.e=function requireEnsure(e){var t=[],s={"chunk-005ab131":1,"chunk-b6b35876":1,"chunk-62628b26":1,"chunk-a7b1e534":1,"chunk-4eb1fb42":1};r[e]?t.push(r[e]):0!==r[e]&&s[e]&&t.push(r[e]=new Promise((function(t,a){for(var s="css/"+({}[e]||e)+"."+{"chunk-005ab131":"e5fee7d8","chunk-313997a6":"31d6cfe0","chunk-b6b35876":"fbf42266","chunk-62628b26":"087493d1","chunk-a7b1e534":"2be39ee0","chunk-4eb1fb42":"917d8e77","chunk-0fc0d246":"31d6cfe0","chunk-2d0c8dd2":"31d6cfe0","chunk-2d221f18":"31d6cfe0","chunk-698fb2b4":"31d6cfe0"}[e]+".css",i=__webpack_require__.p+s,n=document.getElementsByTagName("link"),o=0;o<n.length;o++){var c=n[o],u=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(u===s||u===i))return t()}var l=document.getElementsByTagName("style");for(o=0;o<l.length;o++){c=l[o],u=c.getAttribute("data-href");if(u===s||u===i)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var s=t&&t.target&&t.target.src||i,n=new Error("Loading CSS chunk "+e+" failed.\n("+s+")");n.code="CSS_CHUNK_LOAD_FAILED",n.request=s,delete r[e],d.parentNode.removeChild(d),a(n)},d.href=i;var h=document.getElementsByTagName("head")[0];h.appendChild(d)})).then((function(){r[e]=0})));var i=a[e];if(0!==i)if(i)t.push(i[2]);else{var n=new Promise((function(t,r){i=a[e]=[t,r]}));t.push(i[2]=n);var o,c=document.createElement("script");c.charset="utf-8",c.timeout=120,__webpack_require__.nc&&c.setAttribute("nonce",__webpack_require__.nc),c.src=jsonpScriptSrc(e);var u=new Error;o=function(t){c.onerror=c.onload=null,clearTimeout(l);var r=a[e];if(0!==r){if(r){var s=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+s+": "+i+")",u.name="ChunkLoadError",u.type=s,u.request=i,r[1](u)}a[e]=void 0}};var l=setTimeout((function(){o({type:"timeout",target:c})}),12e4);c.onerror=c.onload=o,document.head.appendChild(c)}return Promise.all(t)},__webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,r){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},__webpack_require__.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(__webpack_require__.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)__webpack_require__.d(r,a,function(t){return e[t]}.bind(null,a));return r},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e["default"]}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="/",__webpack_require__.oe=function(e){throw console.error(e),e};var i=window["webpackJsonp"]=window["webpackJsonp"]||[],n=i.push.bind(i);i.push=webpackJsonpCallback,i=i.slice();for(var o=0;o<i.length;o++)webpackJsonpCallback(i[o]);var c=n;s.push([0,"chunk-vendors"]),checkDeferredModules()})({0:function(e,t,r){e.exports=r("56d7")},"00b4":function(e,t,r){"use strict";r.d(t,"a",(function(){return Flight}));var a=r("a14d"),s=r("062a");class Flight extends a["b"]{constructor({name:e,notes:t,checked:r=[],milestones:a=[]}={},...s){let i=s;super({name:e,notes:t,checked:r,milestones:a},...i)}addBranch(e,t){return this.branches.push(new a["a"](s["a"],t,...e)),this}get duration(){return this.branches.reduce((e,t)=>e+(t.last().properties.timestamp-t.first().properties.timestamp),0)/1e3}}},"039a":function(e,t,r){"use strict";r("7174")},"062a":function(e,t,r){"use strict";r.d(t,"a",(function(){return Location}));var a=r("f9de"),s=r("3634"),i=r("5568"),n=r("27f4");class Location extends a["a"]{get bbox(){return Object(i["a"])(Object(n["a"])(this.toGeoJSON(),Number(this.properties.accuracy),{units:"meters"}))}bounds(e){return Object(i["a"])(Object(n["a"])(this.toGeoJSON(),e,{units:"meters"}))}legFrom(e){return{distance:e.distanceTo(this),heading:e.bearingTo(this),speed:this._speedFrom(e),verticalSpeed:this._verticalSpeedFrom(e)}}willBeIn(e,t){if(this.properties.speed&&this.properties.heading)return this.destinationPoint(this.properties.speed*e,this.properties.heading,t);throw"cannot calculate futur position, speed & heading should be provided"}_delayFrom({properties:{timestamp:e}}){return(this.properties.timestamp-e)/1e3}_climbFrom({properties:{altitude:e}}){return this.properties.altitude-e}_speedFrom(e){if(0==this._delayFrom(e))throw"Teleportation is not yet a possibility";return new s["g"](this.distanceTo(e)/this._delayFrom(e))}_verticalSpeedFrom(e){if(0==this._delayFrom(e))throw"Teleportation is not yet a possibility";return new s["g"](this._climbFrom(e)/this._delayFrom(e))}static from({accuracy:e,speed:t,heading:r,...a}={}){return arguments[0]instanceof this?arguments[0]:(e&&(e=s["d"].from(e)),t&&(t=s["g"].from(t)),r&&(r=s["b"].from(r)),super.from({accuracy:e,speed:t,heading:r,...a}))}static fromGeolocationPosition({coords:{latitude:e,longitude:t,altitude:r,accuracy:a,altitudeAccuracy:i,heading:n,speed:o},timestamp:c}){return r&&(r=new s["a"](r,"m",{reference:"WGS84",accuracy:i})),a&&(a=new s["d"](a,"m")),o&&(o=new s["g"](o,"m/s")),n&&(n=new s["b"](n,"Â°")),new this([t,e,r],{accuracy:a,altitude:r,speed:o,heading:n,timestamp:c})}}},"08df":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return c}));var a=r("62d7"),s=r.n(a);const i={data(){return{chartOptions:{elements:{line:{backgroundColor:[s.a["primaryFade"],s.a["successFade"],s.a["infoFade"],s.a["warningFade"]],borderColor:[s.a["primary"],s.a["success"],s.a["info"],s.a["warning"]],color:[s.a["primary"],s.a["success"],s.a["info"],s.a["warning"]]}}},envelopesDataset:{showLines:!0,showLine:!0,fill:"start",borderWidth:2,pointRadius:5,pointHoverRadius:5,tension:0},cgDataset:{borderWidth:2,pointRadius:5,pointHoverRadius:5}}}},n={methods:{readTextFileAsync(e){return new Promise((t,r)=>{let a=new FileReader;a.onload=()=>{t(a.result)},a.onerror=r,a.readAsText(e)})},downloadJSON(e,t){let r=new Blob([JSON.stringify(e,void 0,2)],{type:"application/json",name:t});const a=document.createElement("a");a.href=URL.createObjectURL(r),a.download=t,a.click()},async uploadJSON(e){let t;return t=JSON.parse(await this.readTextFileAsync(e)),t}}},o={methods:{openWarning(e){return this.$buefy.snackbar.open({position:"is-bottom",type:"is-danger",duration:5e3,queue:!1,...e})},confirmAction(e){return this.$buefy.dialog.confirm({type:"is-danger",hasIcon:!0,...e})}}},c={data(){return{wakeLock:null}},mixins:[o],mounted(){"wakeLock"in navigator&&(this.requestWakeLock(),document.addEventListener("visibilitychange",this.requestWakeLock))},beforeDestroy(){"wakeLock"in navigator&&(document.removeEventListener("visibilitychange",this.requestWakeLock),this.wakeLock&&this.wakeLock.release())},methods:{async requestWakeLock(){"visible"===document.visibilityState&&(this.wakeLock=await navigator.wakeLock.request("screen"))}}}},"0c9a":function(e,t,r){"use strict";r.d(t,"a",(function(){return Moment}));var a=r("bd67"),s=r("3634");class Moment extends a["a"]{constructor(e,t,r={}){super({mass:new s["i"](e),lever:new s["d"](t),...r})}get value(){return this.mass.value*this.lever.value}get _value(){return this.mass*this.lever}valueOf(){return this._value}get unit(){return`${this.mass.unit}.${this.lever.unit}`}toJSON(){return{...this,type:this.constructor.name}}static from({type:e,mass:t,lever:r,...a}={}){if(arguments[0]instanceof this)return arguments[0];if(e==this.name)return t&&(t=s["i"].from(t)),r&&(r=s["d"].from(r)),new this(t,r,a);throw`Invalid data : 'type' should be '${this.name}' got '${e}'`}static linearCoG(...e){let t=e.flat().reduce((e,{mass:t,lever:r})=>(e.mass=e.mass.add(t,{precision:t.precision}),e.lever=e.lever.add(new s["d"](r).prod(t),{precision:r.precision}),e),new Moment(0,0));return t.lever=t.lever.prod(1/t.mass),t}}},1:function(e,t){},"1caf":function(e,t,r){"use strict";r.d(t,"a",(function(){return Navigation}));var a=r("a14d"),s=r("f9de"),i=r("d30b");class Navigation extends a["b"]{constructor({name:e,notes:t,assets:r={}}={},...a){let s=a;super({name:e,notes:t,assets:r},...s)}get poi(){return this.branches.flatMap(e=>e.map(e=>e.properties.name).filter(e=>/^[A-Z]{4}$/.test(e)).flat())}addBranch(e=[],t){return this.branches.push(new a["a"](s["a"],t,...e)),this}getWaypoint(e,t){return this.branches[e]&&this.branches[e].features[t]}indexOf(e){let t,r=this.branches.findIndex(r=>(t=r.features.indexOf(e))>=0);return-1==r||-1==t?void 0:[r,t]}removeWaypoint(e,t){let r=this.getBranch(e);if(!r)throw`'${e}' can't be coerced as a Branch`;return r.remove(t)?r:void this.removeBranch(r)}getNextWaypoint(e){const t=this.indexOf(e);return t?this.getWaypoint(t[0],t[1]+1)||this.getWaypoint(t[0]+1,0):void 0}toGeoJSON(e){switch(e){case"Feature":case"MultiLineString":return Object(i["f"])(this.branches.flatMap(e=>e.toGeoJSON("MultiLineString").features),{bbox:this.bbox});case"Geodesics":return Object(i["f"])(this.branches.flatMap(e=>e.toGeoJSON("Geodesics").features),{bbox:this.bbox});default:return super.toGeoJSON(e)}}}},"1db5":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var a=r("08df");const s={mixins:[a["b"],a["c"]],props:{create:Boolean,edit:Boolean,persistent:Boolean,exist:Boolean},data(){return{search:"",upload:[]}},mounted(){!this.persistent&&!this.exist||this.selectedData||this.createData()},computed:{dataType(){return this.constructor.name},fromDB(){return this.selectedData&&this.selectedData._id&&this.selectedData._rev},selectedData:{get(){return this.$store.state[this.storeKey]},set(e){try{this.$store.commit(this.storeKey,e)}catch(t){0,this.$buefy.dialog.alert({title:"Cannot load item",message:"Selected record is corrupted. It will be purged from database. Do you want to download it localy before ?",type:"is-danger",hasIcon:!0,trapFocus:!0,icon:"cloud-download-outline",confirmText:"Download & Delete",onConfirm:()=>{this.downloadJSON(e,"navue-corrupted-item.json")},canCancel:!0,cancelText:"Just delete it"}),this.$store.dispatch("deleteFromDB",e)}}},selectedName(){return this.selectedData?this.selectedData[this.searchedProperty]:void 0}},pouch:{availableData(){let e={type:this.dataType};return e[this.searchedProperty]={$regex:RegExp(this.search,"i")},{database:"navue",selector:e}}},methods:{createData(e){this.selectedData=new this.constructor(e)},async saveData(){try{this.selectedData=await this.$store.dispatch("saveToDB",this.selectedData),this.openWarning({message:`"${this.selectedName}" saved`})}catch(e){this.dispatchError(e)}},discardData(){this.selectedData=void 0},async deleteData(){try{await this.$store.dispatch("deleteFromDB",this.selectedData),this.selectedData=null,this.openWarning({message:`"${this.selectedName}" deleted`})}catch(e){this.dispatchError(e)}},async importData(e){try{let t=await this.uploadJSON(e);this.selectedData=this.cloneData(t),this.openWarning({message:`"${this.selectedName}" imported`})}catch(t){this.dispatchError(t)}},exportData(){this.selectedData&&this.downloadJSON(this.selectedData,this.selectedName+".json")},cloneData(e){let t=e.clone();return delete t._id,delete t._rev,t.name&&(t.name+="-1"),t.registration&&(t.registration+="(cloned)"),t},dispatchError(e){console.error(e),this.openWarning(e)}}}},3634:function(e,t,r){"use strict";r.d(t,"d",(function(){return Distance})),r.d(t,"a",(function(){return Altitude})),r.d(t,"g",(function(){return Speed})),r.d(t,"c",(function(){return Consumption})),r.d(t,"i",(function(){return Weight})),r.d(t,"b",(function(){return Azimuth})),r.d(t,"f",(function(){return Pressure})),r.d(t,"h",(function(){return Temperature})),r.d(t,"e",(function(){return Frequency}));var a=r("bd67");class Quantity extends a["a"]{constructor(e,t,{type:r,unit:a,precision:s,...i}={}){if(arguments[0]instanceof Quantity)return arguments[0];super(i),t?this.unit=t:this._unit=void 0,e||0===e?this.value=e:(this._value=void 0,this.precision=void 0),s&&(this.precision=s),a&&(this.unit=a)}get value(){return this.constructor.significantValue(this._to(this._value),this.precision)}set value(e){let t=Number(e);if(Number.isNaN(t))throw`\`${e}\` could not be coerced to a number`;this._value=this._from(t),this.precision=this.constructor.significantFigures(e)}get unit(){return this._unit||this.constructor.baseUnit}set unit(e){if(!this.constructor.units[e])throw`'${e}' is not an available unit`;this._unit=e}get factor(){return this.constructor.units[this.unit]}_from(e,t=this.unit){return Number(e)/this._factor(t)}_to(e,t=this.unit){return Number(e)*this._factor(t)}_factor(e){if(this.constructor.units[e])return this.constructor.units[e];throw`'${e}' is not an available unit`}to(e){return this._to(this._value,e)}as(e,t){return Object.assign(this.constructor.from(this),{unit:e,precision:t})}add(e,t){if("number"==typeof e||e instanceof this.constructor)return new this.constructor(this+e,void 0,{precision:Math.min(this.precision,e.precision),unit:this._unit,...t});throw"operands should be of the same type"}prod(e,t){return new this.constructor(this*e,void 0,{precision:Math.min(this.precision,e.precision||this.constructor.significantFigures(e)),unit:this._unit,...t})}valueOf(){return this._value}toString(){let e=Math.max(1,Math.min(this.precision||0,21));return`${isNaN(this.value)?"-":this.value.toLocaleString(void 0,{minimumSignificantDigits:e,maximumSignificantDigits:e})} ${this.unit}`}toJSON(){let{_value:e,_unit:t,...r}=this;return{...r,value:this.value,unit:this.unit,type:this.constructor.name}}static significantFigures(e){let t;if(0===e)return 0;if("number"===typeof e)t=Math.abs(e).toExponential();else{if("string"!==typeof e||Number.isNaN(Number(e)))return;t=e.replace(/^\+|-/,"").replace(/^0+/,"")}t=t.replace(".","");const r=t.lastIndexOf("e");return r>0?r:t.length}static significantValue(e,t=1){if(0===e)return 0;const r=Math.pow(10,t-Math.floor(Math.log(e<0?-e:e)/Math.LN10)-1);return Math.round(e*r)/r}static get units(){throw"list of available units should be set on constructor."}static get baseUnit(){return Object.keys(this.units)[Object.values(this.units).indexOf(1)]}static from({type:e,value:t,unit:r,...a}={}){if(!e||this.name==e)return new this(t,r,a)}}class Distance extends Quantity{static get units(){return{m:1,Km:.001,ft:3.28084,NM:539957e-9,mi:621371e-9,yd:1.09361}}}class Altitude extends Distance{constructor(e,t,{reference:r,...a}={}){if("FL"==t)r="QNE";else if(t&&!r)throw`property 'reference' should be given, got '${r}'`;super(e,t,{...a,reference:r})}get value(){return"FL"==this.unit?this.constructor.significantValue(this._to(this._value),2):this._to(this._value)}set value(e){super.value=e}toString(){return"FL"==this.unit?"FL"+String(this.value).padStart(3,"0"):this.value&&this.reference?`${super.toString()} ${this.reference}`:void 0}static get references(){return["MSL","AGL","QNH","QNE","QFE","WGS84"]}static get units(){return{m:1,ft:3.28084,FL:.0328084}}}class Speed extends Quantity{static get units(){return{"m/s":1,"km/h":3.6,"ft/min":196.85,kt:1.94384,mph:2.23694}}}class Volume extends Quantity{static get units(){return{m3:1,L:1e3,"gal US":264.172,"gal Imp":219.969}}}class Consumption extends Volume{static get references(){return["h","1000ft","u"]}toString(e){return`${super.toString(e)}/${this.reference}`}}class Weight extends Quantity{static get units(){return{kg:1,lb:2.20462,t:.001,"L-avgas":1/.721,"L-JetA1":1.25}}}class Angle extends Quantity{static get units(){return{rad:1,"Â°":180/Math.PI,gon:200/Math.PI,rev:.5/Math.PI,"â¥":3200/Math.PI}}}class Azimuth extends Angle{get value(){return this._to((this._value+2*Math.PI)%(2*Math.PI))}set value(e){super.value=e}}class Pressure extends Quantity{static get units(){return{Pa:1,hPa:.01,Psi:1/6894.76,atm:1/101325,bar:1e-5,inHg:1/3386.389}}}class Temperature extends Quantity{static get units(){return{"Â°C":[1,0],K:[1,273.15],"Â°F":[9/5.32]}}_from(e,t=this.unit){return Number(e)/this._factor(t)[0]+this._factor(t)[1]}_to(e,t=this.unit){return(Number(e)-this._factor(t)[1])*this._factor(t)[0]}}class Frequency extends Quantity{static get units(){return{Hz:1,KHz:.001,MHz:1e-5,GHz:1e-8}}}},"56d7":function(e,t,r){"use strict";r.r(t);var a=r("2b0e"),render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("Navbar",{staticClass:" is-hidden-printer"}),r("router-view")],1)},s=[],Navbarvue_type_template_id_51df16b2_render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-navbar",{staticClass:"is-radiusless",attrs:{"fixed-top":""}},[r("template",{slot:"brand"},[r("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/"}}},[r("img",{attrs:{src:"img/icons/android-chrome-192x192.png",alt:"Navue, a navigation tool for general aviation."}})]),r("b-navbar-item",{attrs:{tag:"span"}},[r("b-tag",{attrs:{type:"is-danger"}},[e._v("beta")])],1)],1),r("template",{slot:"start"},[r("b-navbar-item",{attrs:{tag:"router-link",to:{name:"Briefing"}}},[e._v("Briefing")]),r("b-navbar-item",{attrs:{tag:"router-link",to:{name:"Fly"}}},[e._v("Fly")]),r("b-navbar-item",{attrs:{tag:"router-link",to:{name:"Debriefing"},disabled:""}},[e._v("Debriefing")]),r("b-navbar-item",{attrs:{tag:"router-link",to:{name:"Monitor"}}},[e._v("Monitor")])],1),r("template",{slot:"end"},[r("b-navbar-item",[r("AircraftManager",{attrs:{triggers:["click","hover"]},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.selected;return[r("b-button",{attrs:{type:"is-primary","icon-right":"chevron-down"}},[e._v(" "+e._s(a?a.registration:"Select an aircraft")+" ")])]}}])})],1),r("b-navbar-dropdown",{attrs:{hoverable:"",collapsible:"",right:""}},[r("template",{slot:"label"},[r("b-icon",{attrs:{icon:"account"}})],1),r("b-navbar-item",{staticStyle:{"min-width":"30vw"},attrs:{tag:"div"}},[r("Login")],1)],2)],1)],2)},i=[],n=r("7226"),Loginvue_type_template_id_6bf1e9f2_render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("nav",{staticClass:"level"},[r("div",{staticClass:"level-item has-text-centered"},[r("div",[r("p",{staticClass:"heading"},[e._v("Aircrafts")]),r("p",{staticClass:"title"},[e._v(e._s(e.userStats.Aircraft||0))])])]),r("div",{staticClass:"level-item has-text-centered"},[r("div",[r("p",{staticClass:"heading"},[e._v("Navigations")]),r("p",{staticClass:"title"},[e._v(e._s(e.userStats.Navigation||0))])])]),r("div",{staticClass:"level-item has-text-centered"},[r("div",[r("p",{staticClass:"heading"},[e._v("Flights")]),r("p",{staticClass:"title"},[e._v(e._s(e.userStats.Flight||0))])])]),r("div",{staticClass:"level-item has-text-centered"},[r("div",[r("p",{staticClass:"heading"},[e._v("Storage")]),r("p",{staticClass:"title"},[e._v(e._s(e._f("percent")(e.userStats.storage||0)))])])])]),r("b-loading",{attrs:{"is-full-page":!1,active:!!e.error}}),e.currentUser?r("div",[r("nav",{staticClass:"level is-mobile"},[r("div",{staticClass:"level-item has-text-centered"},[r("b-icon",{attrs:{icon:e.syncIcons[e.syncStatus]}})],1),r("div",{staticClass:"level-item has-text-centered"},[r("h5",{staticClass:"title is-5"},[e._v(e._s(e.currentUser.name))])])]),r("nav",{staticClass:"level"},[r("div",{staticClass:"level-item has-text-centered"},[r("b-button",{attrs:{type:"is-primary","icon-left":"account-arrow-right-outline"},on:{click:e.logoutUser}},[e._v("Sign out")])],1),r("div",{staticClass:"level-item has-text-centered"},[r("b-button",{attrs:{type:"is-primary is-light","icon-left":"account-edit-outline"},on:{click:e.openDetails}},[e._v("Edit")])],1)])]):r("fieldset",[r("b-field",{attrs:{label:"Email",horizontal:""}},[r("b-input",{attrs:{type:"email",icon:"email",placeholder:"pilote@navue.io",required:""},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),r("b-field",{attrs:{label:"Password",horizontal:""}},[r("b-input",{attrs:{type:"password",icon:"lock",placeholder:"*******",required:"","password-reveal":""},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),r("b-field",{attrs:{"is-grouped":""}},[r("b-button",{staticClass:"is-primary",attrs:{"icon-left":"account-arrow-left-outline",expanded:""},on:{click:function(t){return e.loginUser(e.username,e.password)}}},[e._v("Sign in")]),r("b-button",{staticClass:"is-primary is-light",attrs:{"icon-left":"account-plus-outline"},on:{click:function(t){return e.createUser(e.username,e.password)}}},[e._v("Create Account")]),e.gotLocalData?r("b-button",{staticClass:"is-danger is-light",attrs:{"icon-left":"database-remove"},on:{click:e.cleanLocal}},[e._v("Clear device")]):e._e()],1)],1)],1)},o=[],UserDetailsvue_type_template_id_1c085ece_render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"modal-card"},[r("header",{staticClass:"modal-card-head"},[r("p",{staticClass:"modal-card-title"},[e._v(e._s(e.value.name))]),r("button",{staticClass:"delete",attrs:{type:"button"},on:{click:function(t){return e.$emit("close")}}})]),r("fieldset",{staticClass:"modal-card-body"},[r("b-taglist",e._l(e.value.roles,(function(t){return r("b-tag",{key:t,attrs:{type:"is-primary",size:"is-medium"}},[e._v(e._s(t))])})),1),r("b-field",{attrs:{label:"Licences"}},[r("b-taginput",{attrs:{ellipsis:"",icon:"label",placeholder:"Add a Licence","aria-close-label":"Delete this tag"},model:{value:e.value.licences,callback:function(t){e.$set(e.value,"licences",t)},expression:"value.licences"}})],1),r("b-field",{attrs:{label:"Organization"}},[r("b-input",{attrs:{type:"text",icon:"domain"},model:{value:e.value.organization,callback:function(t){e.$set(e.value,"organization",t)},expression:"value.organization"}})],1),r("b-button",{attrs:{type:"is-primary","icon-left":"account-edit-outline",expanded:""},on:{click:function(t){return e.updateMetadata(e.metadata)}}},[e._v("Save")]),r("div",{staticClass:"divider is-danger"},[e._v("Danger Zone")]),r("b-field",{attrs:{type:"is-warning"}},[r("b-input",{attrs:{type:"password","password-reveal":"",expanded:"",autocomplete:"new-password",icon:"account-key"},model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}}),r("p",{staticClass:"control"},[r("b-button",{attrs:{type:"is-warning is-light","icon-left":"lock-reset"},on:{click:function(t){return e.confirmAndupdatePassword(e.newPassword)}}},[e._v("Change Password")])],1)],1),r("b-button",{attrs:{expanded:"",type:"is-danger","icon-left":"account-remove"},on:{click:function(t){return e.confirmAnddeleteUser()}}},[e._v("Delete Account")])],1),r("footer",{staticClass:"modal-card-foot"},[e._v(" Member since "+e._s(e._f("asDate")(e.value.created_at))+" ")])])},c=[];const u={data(){return{syncHandle:null,remoteDbUrl:new URL("https://db.treville.fr:8443")}},async created(){let e,t,r,a={_id:"_design/user",views:{"count-items":{map:function({type:e}){emit(e)}.toString(),reduce:"_count"},stats:{map:function({type:e,length:t,duration:r}){switch(e){case"Navigation":emit("NavigationDistance",t||0);break;case"Flight":emit("FlightTime",r||0);break;default:emit(e)}}.toString(),reduce:"_sum"}}};try{({_rev:e,views:t}=await this.$pouch.get(a._id))}catch{r=!0}finally{(r||JSON.stringify(t)!=JSON.stringify(a.views))&&await this.$pouch.put({_rev:e,...a})}},computed:{currentUser:{get(){return this.$store.state.currentUser},set(e){this.$store.commit("currentUser",e)}},remoteDB(){return this.$pouch.getDB(this.remoteDbUrl)}},methods:{async setCurrentUser(){try{const{userCtx:{name:e}}=await this.remoteDB.getSession();if(e)return this.currentUser=await this.remoteDB.getUser(e),this.$pouch.getDB(new URL(this.userDBname(this.currentUser.name),this.remoteDbUrl));new Error("No session available.")}catch(e){console.error(e)}},userDBname(e){return"userdb-"+Array.from(e).map(e=>e.charCodeAt(0)<128?e.charCodeAt(0).toString(16):encodeURIComponent(e).replace(/%/g,"").toLowerCase()).join("")},getUserStats(e){return Promise.allSettled([e.query("user/count-items",{group:!0}).then(({rows:e})=>e.reduce((e,t)=>(e[t.key]=t.value,e),{})),navigator.storage.estimate().then(({usage:e,quota:t})=>({storage:e/t}))]).then(e=>e.reduce((e,{status:t,value:r})=>("fulfilled"==t&&(e={...e,...r}),e),{})).catch(console.error)},startSync(e,t){this.stopSync(),this.syncHandle=this.$pouch.sync(e,{}),t&&this.syncHandle.on("active",e=>t("active",e)).on("change",e=>t("change",e)).on("paused",e=>t("paused",e)).on("complete",e=>t("complete",e)).on("error",e=>t("error",e)).on("denied",e=>t("denied",e))},stopSync(){if(this.syncHandle)return this.syncHandle.cancel()},async cleanLocal(){await this.$pouch.viewCleanup();try{await this.$pouch.destroy()}finally{this.$store.commit("cleanStore")}}}};var l=r("08df"),d={name:"UserDetails",mixins:[u,l["c"]],data(){return{value:this.user,newPassword:null,confirm:{deleteUser:{title:"Deleting account",message:"Are you sure you want to <b>delete</b> your account? This action cannot be undone.",confirmText:"Delete Account"},updatePassword:{type:"is-warning",title:"Change Password",message:"Are you sure you want to <b>change</b> current password.",confirmText:"Change password"}}}},props:["user"],computed:{metadata(){const{_id:e,_rev:t,type:r,name:a,roles:s,...i}=this.value;return i}},methods:{async confirmAnddeleteUser(){const{result:e}=await this.confirmAction(this.confirm.deleteUser);if(e)try{await this.remoteDB.deleteUser(this.value.name),this.$emit("update:user"),this.$emit("close"),this.openWarning({message:"Account deleted."})}catch(t){this.openWarning(t)}},async updateMetadata(e){try{await this.remoteDB.putUser(this.value.name,{metadata:e}),this.$emit("update:user"),this.$emit("close"),this.openWarning({message:"Account saved."})}catch(t){this.openWarning(t)}},async confirmAndupdatePassword(e){const{result:t}=await this.confirmAction(this.confirm.updatePassword);if(t)try{await this.remoteDB.changePassword(this.value.name,e),this.$emit("close"),this.openWarning({message:"Password changed."})}catch(r){this.openWarning(r)}finally{this.newPassword=null}}},filters:{asDate(e){return new Date(e).toLocaleString(void 0,{year:"numeric",month:"long",day:"numeric"})}}},h=d,p=r("2877"),m=Object(p["a"])(h,UserDetailsvue_type_template_id_1c085ece_render,c,!1,null,null,null),f=m.exports,b={name:"Login",mixins:[u,l["c"]],data(){return{statsFeed:void 0,username:null,password:null,userStats:{},importData:{title:"Import data",type:"is-warning",message:"Some data are present in this device. Would you like to import them into your account ?",confirmText:"Yes",cancelText:"No"},syncStatus:"complete",syncIcons:{active:"cloud-sync-outline fade",change:"cloud-sync-outline fade",paused:"cloud-check-outline",complete:"cloud-off-outline",error:"weather-cloudy-alert",denied:"weather-cloudy-alert"},serverPresent:void 0,error:!1}},async mounted(){this.serverPresent=await this.checkServer("navue")},async created(){await this.setupUser()},beforeDestroy(){this.statsFeed&&this.statsFeed.cancel()},computed:{gotLocalData(){return this.userStats.constructor===Object&&Object.keys(this.userStats).length>1}},methods:{async checkServer(e){try{return clearTimeout(this.error),this.error=!1,await this.remoteDB.info()}catch(t){this.error=setTimeout(this.checkServer,3e3,e)}},async createUser(e,t){try{await this.remoteDB.signUp(e,t,{metadata:{created_at:new Date}}),this.openWarning({message:"Welcome on navue !",duration:5e3}),await this.loginUser(e,t)}catch(r){this.openWarning(r)}},async setupUser(){try{this.setUserStats(),this.setStatsFeed();const e=await this.setCurrentUser();if(e)return await this.startSync(e,this.syncHandler),!0}catch(e){console.error(e)}},async loginUser(e,t){this.stopSync();try{if(await this.remoteDB.logIn(e,t),this.gotLocalData){const{result:e}=await this.confirmAction(this.importData);e||this.cleanLocal()}await this.setupUser(),this.openWarning({message:"You're in !",duration:1e3}),this.username=this.password=null}catch(r){this.openWarning(r)}},async logoutUser(){this.stopSync();try{await this.remoteDB.logOut(),this.currentUser=void 0,this.openWarning({message:"You're out !",duration:1e3})}catch(e){this.openWarning(e)}finally{this.cleanLocal()}},setStatsFeed(){this.statsFeed=this.$pouch.getDB().on("destroyed",e=>{e&&(this.$pouch.getDB(),this.statsFeed&&this.statsFeed.cancel(),this.setUserStats(),this.statsFeed=this.setStatsFeed())}).changes({since:"now",live:!0,view:"user/count-items",filter:"_view"}).on("change",this.setUserStats)},async setUserStats(){this.userStats=await this.getUserStats(this.$pouch)},async checkSession(){try{return await this.setCurrentUser()}catch{this.logoutUser()}},syncHandler(e,t){this.syncStatus=e,e in["error","denied"]&&this.openWarning(t)},openDetails(){this.modal=this.$buefy.modal.open({parent:this,component:f,props:{user:this.currentUser},events:{"update:user":this.checkSession},hasModalCard:!1,trapFocus:!0,"append-to-body":!0})}},filters:{percent(e){return Math.ceil(100*e)+"%"}}},g=b,v=(r("039a"),Object(p["a"])(g,Loginvue_type_template_id_6bf1e9f2_render,o,!1,null,null,null)),y=v.exports,_={name:"Navbar",components:{AircraftManager:n["a"],Login:y},computed:{currentAircraft(){return this.$store.state.currentAircraft}}},w=_,k=Object(p["a"])(w,Navbarvue_type_template_id_51df16b2_render,i,!1,null,null,null),S=k.exports,O={components:{Navbar:S}},x=O,D=(r("5c0b"),Object(p["a"])(x,render,s,!1,null,null,null)),N=D.exports,j=r("acfa"),F=r("2c4e");const $=new j["a"]("/service-worker.js");var C=$;if("serviceWorker"in navigator){const e={type:"is-warning",actionText:null,indefinite:!1,duration:1e3};$.addEventListener("installed",t=>{t.isUpdate?F["a"].open({...e,message:"Loading new version of naVue."}):F["a"].open({...e,message:"naVue is now installed on your device."})}),$.addEventListener("waiting",()=>{F["a"].open({...e,indefinite:!0,message:"A new version of naVue is available.",actionText:"Use it now",onAction:()=>{$.messageSW({type:"SKIP_WAITING"})}})}),$.addEventListener("controlling",()=>{window.location.reload()}),$.addEventListener("activated",()=>{F["a"].open({...e,message:"Welcome to the new version of naVue."})}),$.register()}var L=r("8c4f");a["a"].use(L["a"]);const A=[{path:"/",name:"Home",component:()=>r.e("chunk-0fc0d246").then(r.bind(null,"bb51"))},{path:"/aircraft",name:"Aircraft",component:()=>Promise.all([r.e("chunk-313997a6"),r.e("chunk-2d221f18")]).then(r.bind(null,"cd01"))},{path:"/brief",name:"Briefing",component:()=>Promise.all([r.e("chunk-005ab131"),r.e("chunk-313997a6"),r.e("chunk-b6b35876"),r.e("chunk-62628b26")]).then(r.bind(null,"a0f4"))},{path:"/fly",name:"Fly",component:()=>Promise.all([r.e("chunk-005ab131"),r.e("chunk-313997a6"),r.e("chunk-b6b35876"),r.e("chunk-a7b1e534")]).then(r.bind(null,"ef23"))},{path:"/debrief",name:"Debriefing",component:()=>r.e("chunk-2d0c8dd2").then(r.bind(null,"5760"))},{path:"/monitor",name:"Monitor",component:()=>r.e("chunk-2d0c8dd2").then(r.bind(null,"5760"))},{path:"/preflight",name:"Preflight",component:()=>Promise.all([r.e("chunk-005ab131"),r.e("chunk-4eb1fb42")]).then(r.bind(null,"80b7"))},{path:"/about",name:"About",component:()=>r.e("chunk-698fb2b4").then(r.bind(null,"f820"))}],P=new L["a"]({mode:"history",routes:A,linkActiveClass:"is-active"});var M=P,U=r("2f62"),B=r("1caf"),J=r("b98f"),E=r("062a"),I=r("00b4");a["a"].use(U["a"]);var W=new U["a"].Store({state:{currentUser:void 0,currentAircraft:void 0,currentNavigation:void 0,currentLocation:void 0,currentFlight:void 0,currentQueries:{}},getters:{pois(e){return e.currentNavigation&&e.currentNavigation.poi||[]}},mutations:{currentUser(e,{derived_key:t,iterations:r,password_scheme:a,salt:s,...i}={}){e.currentUser=0==Object.keys(i).length?void 0:i},currentAircraft(e,t){e.currentAircraft=t?J["a"].from(t):t},currentNavigation(e,t){e.currentNavigation=t?B["a"].from(t):t},currentFlight(e,t){e.currentFlight=t?I["a"].from(t):t},currentLocation(e,t){e.currentLocation=t?E["a"].from(t):t},currentQueries(e,t){e.currentQueries={...e.currentQueries,...t}},cleanStore(e){e.currentUser=void 0,e.currentAircraft=void 0,e.currentNavigation=void 0,e.currentFlight=void 0,e.currentLocation=void 0,e.currentQueries={}}},actions:{async saveToDB(e,t){let r=JSON.parse(JSON.stringify(t));r._id||(r._id=`${r.type}-${Date.now()}`);let{id:a}=await this._vm.$pouch.put(r);return await this._vm.$pouch.get(a,{include_docs:!0})},deleteFromDB(e,t){return this._vm.$pouch.remove(t)}}}),T=r("289d"),q=(r("5363"),r("d6e1")),G=r("fcd3"),Q=r("eae4");a["a"].use(T["a"],{defaultProgrammaticPromise:!0}),q["a"].plugin(G["a"]),a["a"].use(Q["a"],"navue"),a["a"].config.productionTip=!1,new a["a"]({router:M,store:W,render:e=>e(N)}).$mount("#app").$sw=C},"5c0b":function(e,t,r){"use strict";r("9c0c")},"62d7":function(e,t,r){e.exports={white:"#fff",whiteFade:"rgba(255,255,255,.5)",whiteInvert:"#0a0a0a",black:"#0a0a0a",blackFade:"rgba(10,10,10,.5)",blackInvert:"#fff",light:"#ecf0f1",lightFade:"rgba(236,240,241,.5)",lightInvert:"rgba(0,0,0,.7)",dark:"#363636",darkFade:"rgba(54,54,54,.5)",darkInvert:"#fff",primary:"#34495e",primaryFade:"rgba(52,73,94,.5)",primaryInvert:"#fff",primaryLight:"#f2f5f8",primaryDark:"#6185a8",link:"#1abc9c",linkFade:"rgba(26,188,156,.5)",linkInvert:"#fff",linkLight:"#edfdf9",linkDark:"#15987e",info:"#3e8ed0",infoFade:"rgba(62,142,208,.5)",infoInvert:"#fff",infoLight:"#eff5fb",infoDark:"#296fa8",success:"#2ecc71",successFade:"rgba(46,204,113,.5)",successInvert:"#fff",successLight:"#eefbf4",successDark:"#1d8147",warning:"#f1b70e",warningFade:"rgba(241,183,14,.5)",warningInvert:"rgba(0,0,0,.7)",warningLight:"#fef9ec",warningDark:"#8c6a08",danger:"#e74c3c",dangerFade:"rgba(231,76,60,.5)",dangerInvert:"#fff",dangerLight:"#fdeeed",dangerDark:"#c32818"}},7174:function(e,t,r){},7226:function(e,t,r){"use strict";var render=function(){var e=this,t=this,r=t.$createElement,a=t._self._c||r;return a("b-dropdown",t._b({scopedSlots:t._u([{key:"trigger",fn:function(){return[t._t("default",(function(){return[a("b-button",[a("b-tooltip",{attrs:{position:"is-bottom",label:t.selectedData?t.selectedData.registration:"Aircraft"}},[a("b-icon",{attrs:{icon:"airplane",type:t.selectedData?"is-success":""}})],1)],1)]}),{selected:t.selectedData})]},proxy:!0}],null,!0)},"b-dropdown",t.$attrs,!1),[t.selectedData?[t.$slots.header||t.$scopedSlots.header?a("b-dropdown-item",{attrs:{custom:""}},[t._t("header",null,{selected:t.selectedData})],2):t._e(),t.$slots.header||t.$scopedSlots.header?a("b-dropdown-item",{attrs:{separator:""}}):t._e(),t.edit?[a("b-dropdown-item",{on:{click:t.saveData}},[a("b-icon",{attrs:{icon:"cloud-upload-outline",type:"is-warning"}}),t._v(" Save ")],1),a("b-dropdown-item",{on:{click:t.exportData}},[a("b-icon",{attrs:{icon:"download-outline"}}),t._v(" Export ")],1),t.create?a("b-dropdown-item",{attrs:{disabled:!t.fromDB},on:{click:function(e){t.selectedData=t.cloneData(t.selectedData)}}},[a("b-icon",{attrs:{icon:"plus-circle-multiple-outline"}}),t._v(" Clone ")],1):t._e(),a("b-dropdown-item",{attrs:{disabled:!t.fromDB},on:{click:t.deleteData}},[a("b-icon",{attrs:{icon:"delete-outline",type:"is-danger"}}),t._v(" Delete ")],1)]:t._e(),a("b-dropdown-item",t._g({},t.persistent?{click:t.createData}:{click:t.discardData}),[a("b-icon",{attrs:{icon:"selection-off"}}),t._v(" Discard ")],1)]:[a("b-dropdown-item",{attrs:{custom:""}},[a("b-autocomplete",{attrs:{placeholder:"Choose an aircraft",data:t.availableData||[],field:t.searchedProperty,"open-on-focus":"","keep-first":"","clear-on-select":"",clearable:""},on:{select:function(t,r){r.stopPropagation(),e.selectedData=t}},scopedSlots:t._u([t.search?{key:"empty",fn:function(){return[a("i",[t._v(t._s(t.search))]),t._v(" not found ")]},proxy:!0}:{key:"empty",fn:function(){return[t._v(" No aircraft registered ")]},proxy:!0}],null,!0),model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),t.create?a("b-dropdown-item",{on:{click:t.createData}},[a("b-icon",{attrs:{icon:"plus-circle-outline"}}),t._v(" New Aircraft ")],1):t._e(),t.create?a("b-dropdown-item",[a("b-upload",{attrs:{accept:"application/json",expanded:""},on:{input:t.importData},model:{value:t.upload,callback:function(e){t.upload=e},expression:"upload"}},[a("b-icon",{attrs:{icon:"upload"}}),t._v(" Import ")],1)],1):t._e()],"Aircraft"!=t.$route.name?a("b-dropdown-item",{attrs:{"has-link":""}},[a("router-link",{attrs:{to:{name:"Aircraft"}}},[t._v(" Manage Aircrafts ")])],1):t._e()],2)},a=[],s=r("1db5"),i=r("b98f"),n={name:"AircraftManager",mixins:[s["a"]],data(){return{constructor:i["a"],storeKey:"currentAircraft",searchedProperty:"registration"}}},o=n,c=r("2877"),u=Object(c["a"])(o,render,a,!1,null,null,null);t["a"]=u.exports},"9c0c":function(e,t,r){},a14d:function(e,t,r){"use strict";r.d(t,"a",(function(){return Branch_Branch})),r.d(t,"b",(function(){return Journey_Journey}));var a=r("bd67"),s=r("3634"),i=r("d30b"),n=r("3a59"),o=r("4227"),c=r("d1e6"),u=r("d95a"),l=r("5568"),d=r("6369");class Branch_Branch extends a["a"]{constructor(e,t={},...r){e&&r.forEach((t,r,a)=>{a[r]=e.from(t)}),super({...Object(i["f"])(r),properties:t,member:e})}[Symbol.iterator](){return this.features[Symbol.iterator]()}first(){return this.features[0]}last(){return this.features[this.features.length-1]}push(...e){return this.features.push(...e.map(e=>this.member?this.member.from(e):e))}shift(){return this.features.shift()}insert(e,t){const r=isNaN(t)?this.features.length:t;return this.features.splice(r,0,e),e}remove(e){return this.features.splice(e,1),this.features.length}forEach(e){return this.features.forEach(e)}map(e){return this.features.map(e)}filter(e){return this.features.filter(e)}pairs(e){let t=[];return this.features.length&&this.features.reduce((r,a,s,i)=>(r&&t.push(e.call(this,r,a,s,i)),a)),t}get geom(){return this.map(({geometry:{coordinates:e}})=>e)}get bbox(){return this.geom.length>2?Object(l["a"])(Object(i["j"])(this.geom)):void 0}get length(){return new s["d"](Object(i["p"])(Object(d["a"])(Object(i["j"])(this.geom),{units:"meters"})))}toJSON(){let{member:e,...t}=super.toJSON();return t}toGeoJSON(e){switch(e){case"Feature":case"LineString":return Object(i["j"])(this.geom,this.properties,{bbox:this.bbox});case"MultiLineString":return Object(i["f"])(this.pairs((e,t,r)=>Object(i["j"])([e.geometry.coordinates,t.geometry.coordinates],e.properties,{id:r})),{bbox:this.bbox});case"Geodesics":return Object(i["f"])(this.pairs((e,t,r)=>Object(n["a"])(e.geometry.coordinates,t.geometry.coordinates,{npoints:10,properties:{distance:new s["d"](Object(i["p"])(Object(o["a"])(e.geometry.coordinates,t.geometry.coordinates,{units:"meters"})),"m",{unit:"NM"}).toString(),bearing:new s["b"](Object(i["p"])(Object(i["a"])(Object(c["a"])(e.geometry.coordinates,t.geometry.coordinates))),"Â°").toString(),id:r}})),{bbox:this.bbox});case"Midpoints":return Object(i["f"])(this.pairs((e,t)=>Object(u["a"])(e.geometry.coordinates,t.geometry.coordinates)),{bbox:this.bbox});case"FeatureCollection":return{...Object(i["f"])(this.features,{bbox:this.bbox}),properties:this.properties};default:return Object(i["f"])([...this.toGeoJSON("FeatureCollection").features,...this.toGeoJSON("Geodesics").features])}}static from({type:e,features:t=[],properties:r},a){if(arguments[0]instanceof this)return arguments[0];if(e===this.name||"FeatureCollection"===e)return new this(a,r,...t);throw`Invalid data : 'type' should be '${this.name}' or 'FeatureCollection' got '${e}'`}}class Journey_Journey extends a["a"]{constructor(e={},...t){super({properties:e,branches:t})}[Symbol.iterator](){return this.branches[Symbol.iterator]()}get name(){return this.properties.name}set name(e){return this.properties.name=e}last(){return this.branches[this.branches.length-1]}push(...e){return this.last().push(...e)}shift(){return this.last().shift()}forEach(e){return this.branches.forEach(e)}map(e){return this.branches.map(e)}filter(e){return this.branches.filter(e)}addBranch(e=[],t){return this.branches.push(new Branch_Branch(void 0,t,...e)),this}getBranch(e){return e instanceof Branch_Branch?e:Number.isInteger(e)?this.branches[e]:void 0}removeBranch(e){let t=this.branches.indexOf(this.getBranch(e));return this.branches.splice(t,1),this}get geom(){return this.map(e=>e.geom)}get bbox(){return Object(l["a"])(Object(i["k"])(this.geom))}get length(){return new s["d"](Object(i["p"])(Object(d["a"])(Object(i["k"])(this.geom),{units:"meters"})))}toGeoJSON(...e){if(e.length>1)return Object(i["f"])(e.flatMap(e=>{let t=this.toGeoJSON(e);return t.features?t.features:t}));switch(e[0]){case"Feature":case"LineString":return Object(i["f"])(this.branches.flatMap(e=>e.toGeoJSON("LineString"),{bbox:this.bbox}));case"MultiLineString":return Object(i["f"])(this.branches.flatMap(e=>e.toGeoJSON("MultiLineString").features,{bbox:this.bbox}));case"FeatureCollection":default:return Object(i["f"])(this.branches.flatMap(e=>e.toGeoJSON("FeatureCollection").features),{bbox:this.bbox})}}static from({type:e,branches:t=[],properties:r,...a}){if(arguments[0]instanceof this)return arguments[0];if(e===this.name){let e=new this(r);return t.forEach(({features:t,properties:r})=>{e.addBranch(t,r)}),Object.assign(e,a),e}throw`Invalid data : 'type' should be '${this.name}' got '${e}'`}}},b98f:function(e,t,r){"use strict";r.d(t,"a",(function(){return Aircraft}));var a=r("bd67"),s=r("3634"),i=r("0c9a");class Aircraft extends a["a"]{constructor({registration:e,manufacturer:t,model:r,paces:n=new a["b"],consumptions:o=new a["b"],balance:c=new a["b"]({date:void 0}),envelopes:u=new a["b"],checklists:l=new a["b"]}={}){n.keep(e=>e instanceof s["g"]?e:void 0),o.keep(e=>e instanceof s["c"]?e:void 0),c.keep(e=>e instanceof i["a"]?e:void 0),u.keep(e=>e instanceof a["b"]?e:void 0),l.keep(e=>e instanceof a["b"]?e:void 0),super({registration:e,manufacturer:t,model:r,paces:n,consumptions:o,balance:c,envelopes:u,checklists:l})}static from({_id:e,_rev:t,type:r,registration:n,manufacturer:o,model:c,paces:u,consumptions:l,balance:d,envelopes:h,checklists:p}={}){if(arguments[0]instanceof this)return arguments[0];if(r!=this.name)throw`Invalid data : 'type' should be '${this.name}' got '${r}'`;{u&&(u=a["b"].from(u,s["g"])),l&&(l=a["b"].from(l,s["c"])),d&&(d=a["b"].from(d,i["a"])),h&&(h=a["b"].from(h,a["b"],i["a"])),p&&(p=a["b"].from(p,a["b"]));let r=new this({registration:n,manufacturer:o,model:c,paces:u,consumptions:l,balance:d,envelopes:h,checklists:p});return e&&t&&Object.assign(r,{_id:e,_rev:t}),r}}}},bd67:function(e,t,r){"use strict";r.d(t,"a",(function(){return Model})),r.d(t,"b",(function(){return Store}));class Model{constructor({type:e,...t}={}){Object.assign(this,t)}toJSON(){return{...this,type:this.constructor.name}}clone(){return this.constructor.from(JSON.parse(JSON.stringify(this)))}static from({type:e,...t}={}){if(arguments[0]instanceof this)return arguments[0];if(e==this.name)return new this(t);throw`Invalid data : 'type' should be '${this.name}' got '${e}'`}}class Store{constructor(e={},...t){this.items=t,Object.assign(this,e)}[Symbol.iterator](){return this.items[Symbol.iterator]()}get length(){return this.items.length}valueOf(){return this.items}get properties(){let{items:e,...t}={...this};return t}get first(){return this.items[0]}get last(){return this.items[this.length-1]}add(e,t){return t?this.items.splice(t,0,e):this.items.push(e),this.length}remove(e,t){return void 0===t&&(t=this.items.indexOf(e)),t>=0&&1==this.items.splice(t,1).length}keep(e){let t=this.items.length;while(t--){let r=e.call(this.items,this.items[t]);void 0==r?this.items.splice(t,1):Object.is(r,this.items[t])||this.items.splice(t,1,r)}return this}toJSON(){return{...this.properties,items:this.items,type:this.constructor.name}}static from({type:e,items:t=[],...r},...a){if(e!=this.name)throw`Invalid data : 'type' should be '${this.name}' got '${e}'`;{let e=a.shift();return new this(r,...t.map(t=>e?e.from(t,...a):t))}}}},f9de:function(e,t,r){"use strict";r.d(t,"a",(function(){return Waypoint}));var a=r("bd67"),s=r("3634"),i=r("d30b"),n=r("38ad"),o=r("805f"),c=r("bd63"),u=r("b367"),l=r("3a59");class Waypoint extends a["a"]{constructor([e,t,r]=[],a={}){const n=[Object(i["p"])(e,6),Object(i["p"])(t,6)];void 0===r||a["altitude"]?a["altitude"]&&(a["altitude"]=s["a"].from(a["altitude"]),r=Object(i["p"])(Number(r))):a["altitude"]=new s["a"](r,"m",{reference:"WGS84"}),r&&n.push(Object(i["p"])(Number(r))),super(Object(i["l"])(n,a))}set longitude(e){this.geometry.coordinates[0]=Object(i["p"])(e,6)}set latitude(e){this.geometry.coordinates[1]=Object(i["p"])(e,6)}get altitude(){return this.geometry.coordinates[2]}set altitude(e){this.geometry.coordinates[2]=Object(i["p"])(e),this.properties.altitude=e}get lngLat(){return{lng:this.geometry.coordinates[0],lat:this.geometry.coordinates[1]}}set lngLat({lng:e,lat:t}){this.longitude=e,this.latitude=t}distanceTo(e){return new s["d"](Object(i["p"])(Object(n["a"])(this.geometry.coordinates,e.geometry.coordinates,{units:"meters"})))}bearingTo(e){return new s["b"](Object(o["a"])(this.geometry.coordinates,e.geometry.coordinates),"Â°")}greatCircleTo(e,t){let r=Object(u["a"])(Object(l["a"])(this.geometry.coordinates,e.geometry.coordinates,{npoints:8,properties:t}));return r.properties={...r.properties,distance:this.distanceTo(e),bearing:this.bearingTo(e)},r}destinationPoint(e,t,r){const a=Object(c["a"])(this.geometry.coordinates,new s["d"](e),new s["b"](t).to("Â°"),{units:"meters"}).geometry.coordinates;return this.geometry.coordinates[2]&&(a[2]=this.geometry.coordinates[2]),new this.constructor(a,r)}toGeoJSON(e){switch(e){case"Position":return this.geometry.coordinates;case"Point":return this.geometry;default:return{...this,type:"Feature"}}}static from({type:e,geometry:t,coordinates:r,properties:a={},...s}={}){if(arguments[0]instanceof this)return arguments[0];switch(e){case this.name:case"Feature":if(!t||"Point"!=t.type)throw`Invalid data : 'geometry.type' should be 'Point' got '${t&&t.type}'`;r=t.coordinates;break;case"Point":break;default:throw`Invalid data : 'type' should be 'Feature', 'Point' or '${this.name}' got '${e}'`}return new this(r,{...s,...a})}static fromEvent({lngLat:{lng:e,lat:t}}={}){return new this([e,t])}}}});
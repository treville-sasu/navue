(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-59f8f64c"],{1625:function(t,e,a){"use strict";a.r(e);var render=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",[0==t.notams.length?a("section",{staticClass:"hero is-primary is-hidden-mobile"},[t._m(0)]):t._e(),a("div",{staticClass:"notification"},[a("b-loading",{attrs:{"is-full-page":!1,active:0==t.azba.length&&!t.error}}),a("b-loading",{attrs:{"is-full-page":!1,active:t.error}},[a("b-notification",{attrs:{"has-icon":"",icon:"alert-circle-outline",closable:!1,"aria-close-label":"Close notification"}},[a("h4",{staticClass:"title"},[t._v("SIA Server Unavailable")]),a("p",{staticClass:"heading"},[t._v(" Check your connection or use SIA server directly ")]),a("a",{attrs:{href:"https://www.sia.aviation-civile.gouv.fr/",target:"_blank"}},[t._v("https://www.sia.aviation-civile.gouv.fr/")])])],1),a("b-field",{attrs:{grouped:"","group-multiline":""}},[a("b-field",{attrs:{label:"ICAO Code for Airports",expanded:""}},[a("b-icao",{attrs:{maxtags:"12"},model:{value:t.searchNotam.codes,callback:function(e){t.$set(t.searchNotam,"codes",e)},expression:"searchNotam.codes"}})],1),a("b-field",{attrs:{label:"Select a date and time"}},[a("b-datetimepicker",{attrs:{rounded:"",placeholder:"Click to select...",icon:"calendar-today","min-datetime":new Date,datepicker:{"nearby-month-days":!1}},model:{value:t.searchNotam.datetime,callback:function(e){t.$set(t.searchNotam,"datetime",e)},expression:"searchNotam.datetime"}},[a("template",{slot:"left"},[a("b-button",{staticClass:"button is-primary",attrs:{"icon-left":"clock",label:"Now"},on:{click:function(e){t.searchNotam.datetime=new Date}}})],1)],2)],1)],1),a("b-field",{attrs:{grouped:"","group-multiline":""}},[a("b-field",{attrs:{label:"Duration"}},[a("b-numberinput",{attrs:{step:1,min:0,"controls-position":"compact"},model:{value:t.searchNotam.duration,callback:function(e){t.$set(t.searchNotam,"duration",e)},expression:"searchNotam.duration"}})],1),a("b-field",{attrs:{label:"Radius or width"}},[a("b-numberinput",{attrs:{step:10,min:0,"controls-position":"compact"},model:{value:t.searchNotam.radius,callback:function(e){t.$set(t.searchNotam,"radius",e)},expression:"searchNotam.radius"}})],1),a("b-field",{attrs:{label:"Ceiling"}},[a("b-numberinput",{attrs:{step:10,min:0,"controls-position":"compact"},model:{value:t.searchNotam.ceiling,callback:function(e){t.$set(t.searchNotam,"ceiling",e)},expression:"searchNotam.ceiling"}})],1),a("b-field",{attrs:{label:"Flight Rules",position:"is-centered"}},[a("b-radio-button",{attrs:{"native-value":"VFR",type:"is-primary"},model:{value:t.searchNotam.flightrules,callback:function(e){t.$set(t.searchNotam,"flightrules",e)},expression:"searchNotam.flightrules"}},[t._v(" VFR ")]),a("b-radio-button",{attrs:{"native-value":"IFR/VFR",type:"is-primary"},model:{value:t.searchNotam.flightrules,callback:function(e){t.$set(t.searchNotam,"flightrules",e)},expression:"searchNotam.flightrules"}},[t._v(" IFR/VFR ")]),a("b-radio-button",{attrs:{"native-value":"IFR",type:"is-primary"},model:{value:t.searchNotam.flightrules,callback:function(e){t.$set(t.searchNotam,"flightrules",e)},expression:"searchNotam.flightrules"}},[t._v(" IFR ")])],1),a("b-field",{attrs:{label:"Complementary",position:"is-centered",expanded:""}},[a("b-checkbox-button",{attrs:{type:"is-primary","native-value":"gps"},model:{value:t.searchNotam.complementary,callback:function(e){t.$set(t.searchNotam,"complementary",e)},expression:"searchNotam.complementary"}},[t._v(" GPS ")]),a("b-checkbox-button",{attrs:{type:"is-primary","native-value":"misc"},model:{value:t.searchNotam.complementary,callback:function(e){t.$set(t.searchNotam,"complementary",e)},expression:"searchNotam.complementary"}},[t._v(" Misc ")])],1)],1),a("Timer",{ref:"searchTimer",staticClass:"mt-5",staticStyle:{height:"0.35em"},attrs:{duration:2e3,countdown:"",type:"is-primary",size:"is-small"},on:{timesup:function(e){return t.getNotams()}}})],1),t._l(t.notams,(function(e,s){return a("b-notification",{key:s,attrs:{"aria-close-label":"Close notification"},on:{close:function(e){return t.$delete(t.notams,s)}}},[a("h4",[t._v(" "+t._s(s)+" ")]),t._l(e,(function(t){return a("NotamMessage",{key:t.id,attrs:{message:t.raw}})}))],2)})),a("div",{staticClass:"columns is-multiline"},[t._l(t.azba,(function(e,s){return a("div",{key:"azba"+s,staticClass:"column is-one-quarter"},[a("ChartCartridge",t._b({attrs:{name:t._f("asDay")(e.start),tags:{danger:"RTBA",warning:t.$options.filters.asTime(e.start),success:t.$options.filters.asTime(e.end)},card:""},on:{click:function(e){t.openChartUrl=e}}},"ChartCartridge",e,!1),[a("figure",{staticClass:"image"},[a("pdf",{staticStyle:{height:"100%"},attrs:{src:e.url,page:1}})],1)])],1)})),a("PDFModal",{attrs:{active:!!t.openChartUrl},model:{value:t.openChartUrl,callback:function(e){t.openChartUrl=e},expression:"openChartUrl"}})],2)],2)},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"hero-body"},[a("div",{staticClass:"container"},[a("h1",{staticClass:"title"},[t._v("Notices to Airmen")]),a("h2",{staticClass:"subtitle"},[t._v("Get NOTAMs & AZBA activity")])])])}],r=a("4410"),NotamMessagevue_type_template_id_57594184_scoped_true_render=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-collapse",{attrs:{open:!1,position:"is-top"},scopedSlots:t._u([{key:"trigger",fn:function(e){return a("div",{},[a("b-icon",{attrs:{icon:e.open?"chevron-up":"chevron-down"}}),a("span",{staticClass:"has-text-weight-bold"},[t._v(t._s(t.notam.id)+" ")]),a("span",{staticClass:"is-italic"},[t._v(" "+t._s(t._f("firstLine")(t.notam.E))+" ")])],1)}}])},[a("pre",[t._v("    "+t._s(t.message)+"\n  ")])])},i=[],o={name:"NotamMessage",props:{message:String},computed:{notam(){return{id:this.message.split("\n")[0].trim(),...Object.fromEntries(Array.from(this.message.matchAll(/([QABCDEFG])\) (.+?)(?=(?: |\n)+[QABCDEFG]\) |$)/gs)).map(t=>[t[1],t[2].trim()]))}}},filters:{firstLine(t){return t.split("\n")[0]}}},n=o,l=(a("c966"),a("2877")),c=Object(l["a"])(n,NotamMessagevue_type_template_id_57594184_scoped_true_render,i,!1,null,"57594184",null),m=c.exports,u=a("d648"),h=a("4a4f"),d=a("84ac"),p=a("4b89"),f=a("858e"),g={name:"Notam",components:{BIcao:r["a"],NotamMessage:m,ChartCartridge:u["a"],PDFModal:h["a"],Timer:d["a"],Pdf:f["a"]},mixins:[p["a"]],data(){return{error:!1,searchNotam:{codes:[],datetime:new Date,duration:12,radius:10,ceiling:30,flightrules:"VFR",complementary:["gps","misc"]},azba:[],openChartUrl:null,notams:[]}},async mounted(){this.azba=await this.getAZBA()},watch:{searchNotam:{deep:!0,handler(){this.$refs.searchTimer.flyback(),this.$refs.searchTimer.running||this.$refs.searchTimer.start(),0==this.searchNotam.codes.length&&this.$refs.searchTimer.reset()}}},methods:{getNotams(){const t=new Date(Math.max(this.searchNotam.datetime,new Date));this.$refs.searchTimer.hold(async()=>{this.notams=[],this.notams=await this.getAirportNOTAMs({...this.searchNotam,datetime:t})})},async getAZBA(){try{return clearTimeout(this.error),this.error=!1,await this.getAZBAfiles()}catch(t){console.error(t),this.error=setTimeout(this.getAZBA,3e3)}}},filters:{asTime(t){return t.toLocaleString("fr-fr",{timeZone:"UTC",timeZoneName:"short",hour12:!1,hour:"2-digit",minute:"2-digit"})},asDay(t){return t.toLocaleString("fr-fr",{timeZone:"UTC",weekday:"long",day:"numeric",month:"long"})}}},b=g,v=Object(l["a"])(b,render,s,!1,null,null,null);e["default"]=v.exports},"4b89":function(t,e,a){"use strict";e["a"]={data(){return{AZBASourceUrl:"https://www.sia.aviation-civile.gouv.fr/schedules",VACSourceUrl:"https://www.sia.aviation-civile.gouv.fr/",NOTAMSourceUrl:"https://notamweb.aviation-civile.gouv.fr/Script/IHM/Bul_Aerodrome.php"}},methods:{async fetchSIA(t,e={}){const a=await fetch(t,e);if(a.ok){const t=await a.text();return(new DOMParser).parseFromString(t,"text/html")}throw{code:a.status,message:a.statusText}},async getAZBAfiles(){const t=await this.fetchSIA(this.AZBASourceUrl),e=Array.from(t.getElementsByTagName("iframe"));return e.map(t=>{const[e,a,s,r,i,o,n,l]=t.src.match(/.*(\d{4})-(\d{2})-(\d{2})_(\d{2})(\d{2})-(\d{2})(\d{2}).pdf+/i),c=new Date(Date.UTC(a,s-1,r,i,o)),m=new Date(Date.UTC(a,s-1,r,n,l));return{url:e,start:c,end:m}})},async getVACbaseUrl(){const t=await this.fetchSIA(this.VACSourceUrl),e=t.querySelector("a[href*=Atlas-VAC]").href,a=new URL(e).searchParams.get("f");return new URL(a.replace("home.htm","PDF_AIPparSSection/VAC/AD/"),this.VACSourceUrl)},VACurl(t,e=this.baseURL){return new URL(`AD-2.${t}.pdf`,e)},async getAirportNOTAMs(t){const e=new URLSearchParams(this.formatAeroParams(t)).toString(),a=await this.fetchSIA(this.NOTAMSourceUrl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e}),s=Array.from(a.querySelectorAll("pre")).map(t=>this.decodeMessage(t.innerText));return this.groupByAttribute(s,"A",t=>t)},formatAeroParams(t){return{bResultat:!0,bImpression:"",ModeAffichage:"COMPLET",AERO_Langue:"FR",AERO_Date_DATE:t.datetime.toLocaleString("ja-jp",{timeZone:"UTC",hour12:!1,year:"numeric",month:"2-digit",day:"2-digit"}),AERO_Date_HEURE:t.datetime.toLocaleString("en-us",{timeZone:"UTC",hour12:!1,hour:"2-digit",minute:"2-digit"}),AERO_Duree:t.durations||12,AERO_Rayon:t.radius||10,AERO_Plafond:t.ceiling||30,AERO_CM_REGLE:["IFR/VFR","IFR","VFR"].indexOf(t.flightrules)+1,AERO_CM_GPS:t.complementary.includes("gps")?1:2,AERO_CM_INFO_COMP:t.complementary.includes("misc")?1:2,...this.buildCodesParam(t.codes,"AERO_Tab_Aero")}},buildCodesParam(t,e){let a=new Array(12).fill("");a.splice(0,t.length,...t);const s=a.map((t,a)=>[`${e}[${a}]`,t.id||""]);return Object.fromEntries(s)},decodeMessage(t){return{id:t.split("\n")[0].trim(),raw:t,...Object.fromEntries(Array.from(t.matchAll(/([QABCDEFG])\) (.+?)(?=(?: |\n)+[QABCDEFG]\) |$)/gs)).map(t=>[t[1],t[2].trim()]))}},groupByAttribute(t,e,a){return t.reduce((t,s)=>(s&&(t[s[e]]=t[s[e]]||[]).push(a.call(null,s)),t),{})}}}},"84ac":function(t,e,a){"use strict";var render=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.running||t.indeterminate?a("b-progress",t._b({attrs:{value:t.indeterminate?void 0:t.value,max:t.duration}},"b-progress",t.$attrs,!1)):t._e()},s=[],r={name:"Timer",props:{duration:Number,precision:{type:Number,default:10},countdown:{type:Boolean,default:!1}},data(){return{elapsed:0,timer:void 0,indeterminate:!1}},computed:{running(){return!!this.timer},value(){return this.countdown?this.duration-this.elapsed:this.elapsed}},methods:{start(){this.timer||(this.timer=setInterval(this.countup,this.precision,this.precision),this.$emit("start",this.elapsed,this.duration))},stop(){clearInterval(this.timer),this.timer=void 0,this.$emit("stop",this.elapsed,this.duration)},reset(){this.stop(),this.flyback()},flyback(){this.$emit("reset",this.elapsed,this.duration),this.elapsed=0},async hold(t){this.indeterminate=!0,await t.apply(),this.indeterminate=!1},countup(t){this.elapsed>=this.duration?(this.stop(),this.$emit("timesup",this.elapsed,this.duration)):this.elapsed+=t}}},i=r,o=a("2877"),n=Object(o["a"])(i,render,s,!1,null,null,null);e["a"]=n.exports},c966:function(t,e,a){"use strict";var s=a("d9d1"),r=a.n(s);r.a},d9d1:function(t,e,a){}}]);
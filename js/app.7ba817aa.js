(function(e){function webpackJsonpCallback(t){for(var n,i,s=t[0],o=t[1],u=t[2],l=0,d=[];l<s.length;l++)i=s[l],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);c&&c(t);while(d.length)d.shift()();return r.push.apply(r,u||[]),checkDeferredModules()}function checkDeferredModules(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,s=1;s<n.length;s++){var o=n[s];0!==a[o]&&(i=!1)}i&&(r.splice(t--,1),e=__webpack_require__(__webpack_require__.s=n[0]))}return e}var t={},n={app:0},a={app:0},r=[];function jsonpScriptSrc(e){return __webpack_require__.p+"js/"+({}[e]||e)+"."+{"chunk-143fdd99":"16a80ef2","chunk-3b9a4204":"082f82b6","chunk-ed85a372":"91a250c2","chunk-2d0e26e3":"cbf3dec1","chunk-2d22d746":"b9f41b7e","chunk-3e32b5c3":"217aa387","chunk-27572792":"a08194ed","chunk-59f8f64c":"3b0394e6","chunk-8fe7d73a":"83a5ab2e","chunk-6888504e":"e714f827","chunk-70fb28ef":"e3acfc46","chunk-2d21ab15":"ce01e5aa","chunk-2d221f18":"1da91f48","chunk-711914f4":"4de7f3ad"}[e]+".js"}function __webpack_require__(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,__webpack_require__),a.l=!0,a.exports}__webpack_require__.e=function requireEnsure(e){var t=[],r={"chunk-143fdd99":1,"chunk-3b9a4204":1,"chunk-ed85a372":1,"chunk-3e32b5c3":1,"chunk-59f8f64c":1,"chunk-8fe7d73a":1};n[e]?t.push(n[e]):0!==n[e]&&r[e]&&t.push(n[e]=new Promise((function(t,a){for(var r="css/"+({}[e]||e)+"."+{"chunk-143fdd99":"afaee72a","chunk-3b9a4204":"b6010b0e","chunk-ed85a372":"48d2b289","chunk-2d0e26e3":"31d6cfe0","chunk-2d22d746":"31d6cfe0","chunk-3e32b5c3":"95957f58","chunk-27572792":"31d6cfe0","chunk-59f8f64c":"42a4b553","chunk-8fe7d73a":"7b5a1f72","chunk-6888504e":"31d6cfe0","chunk-70fb28ef":"31d6cfe0","chunk-2d21ab15":"31d6cfe0","chunk-2d221f18":"31d6cfe0","chunk-711914f4":"31d6cfe0"}[e]+".css",i=__webpack_require__.p+r,s=document.getElementsByTagName("link"),o=0;o<s.length;o++){var c=s[o],u=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(u===r||u===i))return t()}var l=document.getElementsByTagName("style");for(o=0;o<l.length;o++){c=l[o],u=c.getAttribute("data-href");if(u===r||u===i)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var r=t&&t.target&&t.target.src||i,s=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");s.code="CSS_CHUNK_LOAD_FAILED",s.request=r,delete n[e],d.parentNode.removeChild(d),a(s)},d.href=i;var h=document.getElementsByTagName("head")[0];h.appendChild(d)})).then((function(){n[e]=0})));var i=a[e];if(0!==i)if(i)t.push(i[2]);else{var s=new Promise((function(t,n){i=a[e]=[t,n]}));t.push(i[2]=s);var o,c=document.createElement("script");c.charset="utf-8",c.timeout=120,__webpack_require__.nc&&c.setAttribute("nonce",__webpack_require__.nc),c.src=jsonpScriptSrc(e);var u=new Error;o=function(t){c.onerror=c.onload=null,clearTimeout(l);var n=a[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+r+": "+i+")",u.name="ChunkLoadError",u.type=r,u.request=i,n[1](u)}a[e]=void 0}};var l=setTimeout((function(){o({type:"timeout",target:c})}),12e4);c.onerror=c.onload=o,document.head.appendChild(c)}return Promise.all(t)},__webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,n){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},__webpack_require__.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(__webpack_require__.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)__webpack_require__.d(n,a,function(t){return e[t]}.bind(null,a));return n},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e["default"]}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="/",__webpack_require__.oe=function(e){throw console.error(e),e};var i=window["webpackJsonp"]=window["webpackJsonp"]||[],s=i.push.bind(i);i.push=webpackJsonpCallback,i=i.slice();for(var o=0;o<i.length;o++)webpackJsonpCallback(i[o]);var c=s;r.push([0,"chunk-vendors"]),checkDeferredModules()})({0:function(e,t,n){e.exports=n("56d7")},"039a":function(e,t,n){"use strict";var a=n("7174"),r=n.n(a);r.a},"05f6":function(e,t,n){},"08df":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return s}));const a={data(){return{envelopesDataset:{showLines:!0,showLine:!0,fill:"start",borderWidth:2,pointRadius:5,pointHoverRadius:5,tension:0},cgDataset:{borderWidth:2,pointRadius:5,pointHoverRadius:5}}}},r={methods:{readTextFileAsync(e){return new Promise((t,n)=>{let a=new FileReader;a.onload=()=>{t(a.result)},a.onerror=n,a.readAsText(e)})},downloadJSON(e,t){let n=new Blob([JSON.stringify(e,void 0,2)],{type:"application/json",name:t});const a=document.createElement("a");a.href=URL.createObjectURL(n),a.download=t,a.click()},async uploadJSON(e){let t;return t=JSON.parse(await this.readTextFileAsync(e)),t}}},i={methods:{openWarning(e,t,n){this.$buefy.snackbar.open({message:e,position:"is-bottom",type:"is-danger",duration:5e3,actionText:t,onAction:n})}}},s={data(){return{wakeLock:null}},mixins:[i],mounted(){this.requestWakeLock(),document.addEventListener("visibilitychange",this.requestWakeLock)},beforeDestroy(){document.removeEventListener("visibilitychange",this.requestWakeLock),this.wakeLock&&this.wakeLock.release()},methods:{async requestWakeLock(){try{if(!("wakeLock"in navigator)||"visible"!==document.visibilityState)throw"WakeLock unavaliable";this.wakeLock=await navigator.wakeLock.request("screen")}catch(e){this.openWarning(e)}}}}},1:function(e,t){},"1caf":function(e,t,n){"use strict";n.d(t,"a",(function(){return Navigation}));var a=n("bd67"),r=n("f9de");class Navigation extends a["a"]{constructor({name:e,notes:t}={},...n){n=new a["b"]({},...n).keep(e=>e.keep(e=>e instanceof r["b"]?e:void 0)),super({name:e,notes:t,routes:n})}addRoute(...e){return this.routes.add(new a["b"]({},...e)),this.routes.last}removeRoute(e){return this.routes.remove(e)}clearRoute(e){if(e=this.getRoute(e),e&&0==e.length)return this.removeRoute(e),!0}addWaypoint({insertBefore:e,...t}={},n){return n=this.getRoute(n),n.add(r["b"].from({...t,type:"Waypoint"}),e)}removeWaypoint(e,t){return t=this.getRoute(t),Number.isInteger(e)?t.remove(void 0,e):t.remove(e)}getNextWaypoint(e){const t=this.waypoints.indexOf(e);return this.waypoints[t+1]}getRoute(e){return e instanceof a["b"]?e:isFinite(e)?this.routes.items[e]:this.last}getRouteId(e){return e instanceof a["b"]?this.routes.indexOf(e):Number.isInteger(e)?e:this.routes.length-1}get waypoints(){return this.routes.items.map(e=>e.items).flat()}toBounds(){return this.waypoints.reduce((e,t,n)=>0==n?[[t.latitude,t.longitude],[t.latitude,t.longitude]]:[[Math.min(t.latitude,e[0][0]),Math.min(t.longitude,e[0][1])],[Math.max(t.latitude,e[1][0]),Math.max(t.longitude,e[1][1])]],void 0)}static from({type:e,routes:t,_id:n,_rev:i,...s}={}){if(arguments[0]instanceof this)return arguments[0];if(e!=this.name)throw`Invalid data : 'type' should be '${this.name}' got '${e}'`;{t&&(t=a["b"].from(t,a["b"],r["b"]));let e=new this(s,...t);return n&&i&&Object.assign(e,{_id:n,_rev:i}),e}}}},"1db5":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("08df");const r={mixins:[a["b"],a["c"]],data(){return{search:"",upload:[]}},computed:{dataType(){return this.constructor.name},fromDB(){return this.selectedData&&this.selectedData._id&&this.selectedData._rev}},pouch:{availableData(){let e={type:this.dataType};return e[this.searchedProperty]={$regex:RegExp(this.search,"i")},{database:"navue",selector:e}}},methods:{saveData(){this.$store.dispatch("saveToDB",this.selectedData).then(e=>{this.selectedData=e,this.openWarning("Saved")}).catch(e=>{console.error(e),this.openWarning(e)})},deleteData(){this.$store.dispatch("deleteFromDB",this.selectedData).then(()=>{this.selectedData=null,this.openWarning("Deleted")}).catch(e=>{console.error(e),this.openWarning(e)})},importData(e){this.uploadJSON(e).then(e=>{this.selectedData=this.cloneData(e),this.openWarning("Imported")}).catch(e=>{console.error(e),this.openWarning(e)})},exportData(){this.selectedData&&this.downloadJSON(this.selectedData,this.selectedData[this.searchedProperty]+".json")},cloneData(e){let t=e.clone();return delete t._id,delete t._rev,t.name&&(t.name+="-1"),t.registration&&(t.registration+="(cloned)"),t}}}},"2caa":function(e,t,n){"use strict";var a=n("05f6"),r=n.n(a);r.a},3634:function(e,t,n){"use strict";n.d(t,"d",(function(){return Distance})),n.d(t,"a",(function(){return Altitude})),n.d(t,"e",(function(){return Speed})),n.d(t,"c",(function(){return Consumption})),n.d(t,"f",(function(){return Weight})),n.d(t,"b",(function(){return Azimuth}));var a=n("bd67");class Quantity extends a["a"]{constructor(e,t,{type:n,_precision:a,...r}={}){super(r),t?this.unit=t:this._unit=void 0,e||0===e?this.value=e:this._value=void 0,a&&(this.precision=a)}get value(){return this.constructor.significantValue(this._to(this._value),this._precision)}set value(e){if(isNaN(e))throw e+" is not a number";this._value=this._from(e),this.precision=this.constructor.getSignificativeDigits(e)}get unit(){return this._unit||this.constructor.baseUnit}set unit(e){if(!this.constructor.units[e])throw`'${e}' is not an available unit`;this._unit=e}get factor(){return this.constructor.units[this.unit]}get precision(){return this._precision}set precision(e){this._precision=Math.max(1,Math.min(21,parseInt(e)))}_from(e,t=this.unit){return Number(e)/this._factor(t)}_to(e,t=this.unit){return Number(e)*this._factor(t)}_factor(e){if(this.constructor.units[e])return this.constructor.units[e];throw`'${e}' is not an available unit`}to(e){return this._to(this.value,e)}as(e,t){return Object.assign(this.constructor.from(this),{_unit:e,_precision:t})}valueOf(){return this._value}toString(){return`${isNaN(this.value)?"-":this.value.toLocaleString(void 0,{minimumSignificantDigits:this.precision,maximumSignificantDigits:this.precision})} ${this.unit}`}toJSON(){let{_value:e,_unit:t,_precision:n,...a}=this;return{...a,value:this.value,unit:this.unit,type:this.constructor.name}}static getSignificativeDigits(e){let t=Math.abs(e);if(0===t)return 0;let n=Math.floor(Math.log10(t))+1;return n>0?t/=10**n:n<0&&(t*=10**-n),t=Math.round(1e16*t)/1e16,String(t).length-2}static significantValue(e,t=1){if(0===e)return 0;const n=Math.pow(10,t-Math.floor(Math.log(e<0?-e:e)/Math.LN10)-1);return Math.round(e*n)/n}static get units(){throw"list of available units should be set on constructor."}static get baseUnit(){return Object.keys(this.units)[Object.values(this.units).indexOf(1)]}static from({type:e,value:t,unit:n,...a}={}){if(!e||this.name==e)return new this(t,n,a)}}class Distance extends Quantity{static get units(){return{m:1,Km:.001,ft:3.28084,NM:539957e-9,mi:621371e-9,yd:1.09361}}}class Altitude extends Distance{constructor(e,t,{reference:n,...a}={}){if("FL"==t)n="QNE";else if(t&&!n)throw`property 'reference' should be given, got '${n}'`;super(e,t,{...a,reference:n})}get value(){return"FL"==this.unit?this.constructor.significantValue(this._to(this._value),2):this._to(this._value)}set value(e){super.value=e}toString(){return"FL"==this.unit?"FL"+String(this.value).padStart(3,"0"):this.value&&this.reference?`${super.toString()} ${this.reference}`:void 0}static get references(){return["MSL","AGL","QNH","QNE","QFE","WGS84"]}static get units(){return{m:1,ft:3.28084,FL:.0328084}}}class Speed extends Quantity{static get units(){return{"m/s":1,"km/h":3.6,"ft/min":196.85,kt:1.94384,mph:2.23694}}}class Volume extends Quantity{static get units(){return{m3:1,L:1e3,"gal US":264.172,"gal Imp":219.969}}}class Consumption extends Volume{static get references(){return["h","1000ft","u"]}toString(e){return`${super.toString(e)}/${this.reference}`}}class Weight extends Quantity{static get units(){return{kg:1,lb:2.20462,t:.001}}}class Angle extends Quantity{static get units(){return{rad:1,"°":180/Math.PI,gon:200/Math.PI,rev:.5/Math.PI,"₥":3200/Math.PI}}}class Azimuth extends Angle{get value(){return this._to((this._value+2*Math.PI)%(2*Math.PI))}set value(e){super.value=e}}},"56d7":function(e,t,n){"use strict";n.r(t);var a=n("2b0e"),render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("Navbar"),n("router-view")],1)},r=[],Navbarvue_type_template_id_6658b8a2_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-navbar",{staticClass:"is-radiusless",attrs:{"fixed-top":""}},[n("template",{slot:"brand"},[n("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/"}}},[n("img",{attrs:{src:"img/icons/android-chrome-192x192.png",alt:"Navue, a navigation tool for general aviation."}})])],1),n("template",{slot:"start"},[n("b-navbar-dropdown",{attrs:{label:"Briefing",collapsible:"",hoverable:""}},[n("b-navbar-item",{attrs:{tag:"router-link",to:{name:"Route"}}},[e._v("Trace routes")]),n("b-navbar-item",{attrs:{tag:"router-link",to:{name:"Approach"}}},[e._v("Approach Charts")]),n("b-navbar-item",{attrs:{tag:"router-link",to:{name:"Weather"}}},[e._v("Weather")]),n("b-navbar-item",{attrs:{tag:"router-link",to:"notam"}},[e._v("NOTAM, AZBA")]),n("b-navbar-item",{attrs:{tag:"router-link",to:{name:"Balance"}}},[e._v("Weight and Balance")])],1),n("b-navbar-dropdown",{attrs:{label:"Flying",hoverable:"",collapsible:""}},[n("b-navbar-item",{attrs:{tag:"router-link",to:"checklists"}},[e._v("Checklists")]),n("b-navbar-item",{attrs:{tag:"router-link",to:"navlog"}},[e._v("Navigation Log")]),n("b-navbar-item",{attrs:{tag:"router-link",to:{name:"MovingMap"}}},[e._v("Moving Map")]),n("hr",{staticClass:"navbar-divider"})],1)],1),n("template",{slot:"end"},[n("b-navbar-item",[n("AircraftManager",{scopedSlots:e._u([{key:"header",fn:function(){return[n("router-link",{attrs:{to:{name:"Aircraft"}}},[n("a",[e._v("Manage Aircrafts")])])]},proxy:!0}])})],1),n("b-navbar-dropdown",{attrs:{hoverable:"",collapsible:"",right:""}},[n("template",{slot:"label"},[n("b-icon",{attrs:{icon:"account"}})],1),n("b-navbar-item",{staticStyle:{"min-width":"30vw"},attrs:{tag:"div"}},[n("Login")],1)],2)],1)],2)},i=[],s=n("9283"),Loginvue_type_template_id_2a2fe218_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("b-loading",{attrs:{"is-full-page":!1,active:!!e.error}},[n("b-notification",{attrs:{"has-icon":"",icon:"alert-circle-outline",closable:!1,"aria-close-label":"Close notification"}},[n("h4",{staticClass:"title"},[e._v("Navue User Server Unavailable")]),n("p",{staticClass:"heading"},[e._v(" Check your connection ")])])],1),e.currentUser?n("div",[n("nav",{staticClass:"level is-mobile"},[n("div",{staticClass:"level-item has-text-centered"},[n("b-icon",{attrs:{icon:e.syncIcon}})],1),n("div",{staticClass:"level-item has-text-centered"},[n("h5",{staticClass:"title is-5"},[e._v(e._s(e.currentUser.name))])])]),n("nav",{staticClass:"level"},[n("div",{staticClass:"level-item has-text-centered"},[n("div",[n("p",{staticClass:"heading"},[e._v("Aircrafts")]),n("p",{staticClass:"title"},[e._v(e._s(e.userStats.Aircraft||0))])])]),n("div",{staticClass:"level-item has-text-centered"},[n("div",[n("p",{staticClass:"heading"},[e._v("Navigations")]),n("p",{staticClass:"title"},[e._v(e._s(e.userStats.Navigation||0))])])]),n("div",{staticClass:"level-item has-text-centered"},[n("div",[n("p",{staticClass:"heading"},[e._v("Flight hours")]),n("p",{staticClass:"title"},[e._v(e._s(e.userStats.flightduration||0))])])]),n("div",{staticClass:"level-item has-text-centered"},[n("div",[n("p",{staticClass:"heading"},[e._v("Storage Quota")]),n("p",{staticClass:"title"},[e._v(e._s(e._f("percent")(e.userStats.quota||0)))])])])]),n("nav",{staticClass:"level"},[n("div",{staticClass:"level-item has-text-centered"},[n("b-button",{attrs:{type:"is-primary","icon-left":"account-arrow-right-outline"},on:{click:e.logoutUser}},[e._v("Sign out")])],1),n("div",{staticClass:"level-item has-text-centered"},[n("b-button",{attrs:{type:"is-primary is-light","icon-left":"account-edit-outline"},on:{click:function(t){e.openDetails=!0}}},[e._v("Edit")])],1)]),e.currentUser?n("b-modal",{attrs:{"has-modal-card":"","trap-focus":"","aria-role":"dialog","aria-modal":""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("UserEdit",{on:{close:t.close,"update-user":e.checkSession},model:{value:e.currentUser,callback:function(t){e.currentUser=t},expression:"currentUser"}})]}}],null,!1,388751030),model:{value:e.openDetails,callback:function(t){e.openDetails=t},expression:"openDetails"}}):e._e()],1):n("fieldset",[n("b-field",{attrs:{label:"Email"}},[n("b-input",{attrs:{type:"email",icon:"email",placeholder:"pilote@navue.io",required:""},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),n("b-field",{attrs:{label:"Password"}},[n("b-input",{attrs:{type:"password",icon:"lock",placeholder:"*******",required:"","password-reveal":""},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),n("b-field",{attrs:{"is-grouped":""}},[n("b-button",{staticClass:"is-primary",attrs:{"icon-left":"account-arrow-left-outline",expanded:""},on:{click:function(t){return e.loginUser(e.username,e.password)}}},[e._v("Sign in")]),n("b-button",{staticClass:"is-primary is-light",attrs:{"icon-left":"account-plus-outline"},on:{click:function(t){return e.newUser(e.username,e.password)}}},[e._v("Create Account")]),e.gotLocalData?n("b-button",{staticClass:"is-danger is-light",attrs:{"icon-left":"database-remove"},on:{click:e.cleanLocal}},[e._v("Clear device")]):e._e()],1)],1)],1)},o=[],UserEditvue_type_template_id_3084a520_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"modal-card",staticStyle:{width:"max-content"}},[n("header",{staticClass:"modal-card-head"},[n("p",{staticClass:"modal-card-title"},[e._v(e._s(e.value.name))]),n("button",{staticClass:"delete",attrs:{type:"button"},on:{click:function(t){return e.$emit("close")}}})]),n("fieldset",{staticClass:"modal-card-body"},[n("b-taglist",e._l(e.value.roles,(function(t){return n("b-tag",{key:t,attrs:{type:"is-primary",size:"is-medium"}},[e._v(e._s(t))])})),1),n("b-field",{attrs:{label:"Licences"}},[n("b-taginput",{attrs:{ellipsis:"",icon:"label",placeholder:"Add a Licence","aria-close-label":"Delete this tag"},model:{value:e.value.licences,callback:function(t){e.$set(e.value,"licences",t)},expression:"value.licences"}})],1),n("b-field",{attrs:{label:"Organization"}},[n("b-input",{attrs:{type:"text",icon:"domain"},model:{value:e.value.organization,callback:function(t){e.$set(e.value,"organization",t)},expression:"value.organization"}})],1),n("div",{staticClass:"divider is-danger"},[e._v("Danger Zone")]),n("b-field",{attrs:{label:"New Password",type:"is-warning"}},[n("b-input",{attrs:{type:"password","password-reveal":"",autocomplete:"new-password",icon:"account-key"},model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}}),n("p",{staticClass:"control"},[n("b-button",{attrs:{type:"is-warning is-light","icon-left":"lock-reset"},on:{click:function(t){return e.updatePassword(e.value.name,e.newPassword)}}},[e._v("Change Password")])],1)],1)],1),n("footer",{staticClass:"modal-card-foot"},[n("b-button",{attrs:{type:"is-primary","icon-left":"account-edit-outline",expanded:""},on:{click:function(t){return e.updateUser(e.value.name,e.metadata)}}},[e._v("Save")]),n("b-button",{attrs:{type:"is-danger","icon-left":"account-remove"},on:{click:function(t){return e.deleteUser(e.value.name)}}},[e._v("Delete Account")])],1)])},c=[];const u={data(){return{syncHandle:null,remoteDbUrl:new URL("https://db.treville.fr:8443")}},computed:{remoteDB(){return this.$pouch.getDB(this.remoteDbUrl)}},methods:{getCurrentUser(){return this.remoteDB.getSession().then(e=>new Promise((t,n)=>{e.userCtx.name?t(e.userCtx.name):n(new Error("No session available."))})).then(e=>this.remoteDB.getUser(e))},userDBname(e){return"userdb-"+Array.from(e).map(e=>e.charCodeAt(0)<128?e.charCodeAt(0).toString(16):encodeURIComponent(e).replace(/%/g,"").toLowerCase()).join("")},getUserStats(e){return e.query({map:(e,t)=>{t(e.type)},reduce:"_count"},{group:!0}).then(e=>e.rows.reduce((e,t)=>(e[t.key]=t.value,e),{})).catch(console.error)},stopSync(){if(this.syncHandle)return this.syncHandle.cancel()},confirmAction(e){return this.$buefy.dialog.confirm({type:"is-danger",hasIcon:!0,...e})},openToast(e){this.$buefy.toast.open({duration:2e3,position:"is-top",type:"is-danger",...e})}}};var l={name:"UserEdit",mixins:[u],data(){return{newPassword:null,confirm:{deleteUser:{title:"Deleting account",message:"Are you sure you want to <b>delete</b> your account? This action cannot be undone.",confirmText:"Delete Account"},updatePassword:{title:"Change Password",message:"Are you sure you want to <b>change</b> current password.",confirmText:"Change password"}}}},props:["value"],computed:{metadata(){return{licences:this.value.licences,organization:this.value.organization}}},methods:{deleteUser(e){return this.confirmAction(this.confirm.deleteUser).then(()=>this.remoteDB.deleteUser(e)).then(()=>{this.$emit("update-user"),this.$emit("close")}).catch(this.openToast)},updateUser(e,t){return this.remoteDB.putUser(e,{metadata:t}).then(()=>{this.$emit("update-user"),this.$emit("close")}).catch(this.openToast)},updatePassword(e,t){return this.confirmAction(this.confirm.updatePassword).then(()=>this.remoteDB.changePassword(e,t)).then(()=>{this.$emit("close")}).finally(()=>{this.newPassword=null}).catch(this.openToast)}}},d=l,h=n("2877"),p=Object(h["a"])(d,UserEditvue_type_template_id_3084a520_render,c,!1,null,null,null),m=p.exports,f={name:"Login",components:{UserEdit:m},mixins:[u],data(){return{openDetails:!1,username:null,password:null,userStats:{},syncIcon:"cloud-off-outline",serverPresent:void 0,error:!1}},async mounted(){this.serverPresent=await this.checkServer("navue")},computed:{currentUser:{get(){return this.$store.state.currentUser},set(e){this.$store.commit("currentUser",e)}},gotLocalData(){return this.userStats.constructor===Object&&Object.keys(this.userStats).length>0}},created(){this.setCurrentUser().then(this.startSync).catch(e=>{console.info(e.message)}).finally(this.setUserStats)},methods:{async checkServer(e){try{return clearTimeout(this.error),this.error=!1,await this.remoteDB.info()}catch(t){this.error=setTimeout(this.checkServer,3e3,e)}},newUser(e,t){return this.remoteDB.signUp(e,t).then(this.loginUser(e,t)).catch(this.openToast)},loginUser(e,t){return this.remoteDB.logIn(e,t).catch(this.openToast).then(this.setCurrentUser).then(this.startSync).finally(()=>{this.username=this.password=null})},logoutUser(){return this.remoteDB.logOut().then(this.stopSync).catch(this.openToast).finally(this.cleanLocal)},setCurrentUser(){return this.getCurrentUser().then(e=>(this.currentUser=e,this.$pouch.getDB(new URL(this.userDBname(e.name),this.remoteDbUrl))))},setUserStats(){return this.getUserStats(this.$pouch).then(e=>this.userStats={...e}).finally(()=>{navigator.storage.estimate().then(e=>{this.userStats.quota=e.usage/e.quota})})},checkSession(){return this.setCurrentUser().catch(this.logoutUser)},startSync(e){this.syncHandle&&this.stopSync(),this.syncHandle=this.$pouch.sync(e).on("active",()=>this.syncIcon="cloud-sync-outline fade").on("active",()=>console.info("Syncing.")).on("change",()=>this.syncIcon="cloud-sync-outline fade").on("change",this.setUserStats).on("paused",()=>this.syncIcon="cloud-check-outline").on("complete",()=>this.syncIcon="cloud-off-outline").on("error",this.openToast).on("error",()=>this.syncIcon="weather-cloudy-alert").on("denied",this.openToast).on("denied",()=>this.syncIcon="weather-cloudy-alert"),Promise.resolve(this.syncHandle)},cleanLocal(){return this.$pouch.destroy().then(()=>{this.userStats={},this.currentUser=null}).then(()=>this.$pouch.getDB("trace").destroy()).then(console.info("Browser cleaned."))}},filters:{percent(e){return Math.ceil(100*e)+"%"}}},v=f,b=(n("039a"),Object(h["a"])(v,Loginvue_type_template_id_2a2fe218_render,o,!1,null,null,null)),g=b.exports,_={name:"Navbar",components:{AircraftManager:s["a"],Login:g},computed:{currentAircraft(){return this.$store.state.currentAircraft}}},y=_,w=Object(h["a"])(y,Navbarvue_type_template_id_6658b8a2_render,i,!1,null,null,null),k=w.exports,S={components:{Navbar:k}},D=S,x=(n("5c0b"),Object(h["a"])(D,render,r,!1,null,null,null)),C=x.exports,U=n("acfa"),$=n("2c4e");if("serviceWorker"in navigator){const e=new U["a"]("/service-worker.js");e.addEventListener("installed",e=>{e.isUpdate?$["a"].open({type:"is-warning",message:"Loading new version of naVue.",actionText:null,indefinite:!1,duration:1e3}):$["a"].open({type:"is-warning",message:"naVue is now installed on your device.",actionText:null,indefinite:!1,duration:1e3})}),e.addEventListener("waiting",()=>{$["a"].open({type:"is-warning",indefinite:!0,message:"A new version of naVue is available.",actionText:"Use it now",onAction:()=>{e.messageSW({type:"SKIP_WAITING"})}})}),e.addEventListener("controlling",()=>{window.location.reload()}),e.addEventListener("activated",()=>{$["a"].open({type:"is-warning",message:"Welcome to the new version of naVue.",actionText:null,indefinite:!1,duration:1e3})}),e.register()}var A=n("8c4f");a["a"].use(A["a"]);const L=[{path:"/",name:"Home",component:()=>n.e("chunk-711914f4").then(n.bind(null,"bb51"))},{path:"/aircraft/:id?",name:"Aircraft",component:()=>Promise.all([n.e("chunk-70fb28ef"),n.e("chunk-2d221f18")]).then(n.bind(null,"cd01"))},{path:"/moving-map/:id?",name:"MovingMap",component:()=>Promise.all([n.e("chunk-143fdd99"),n.e("chunk-3b9a4204")]).then(n.bind(null,"3935"))},{path:"/checklists",name:"Checklists",component:()=>n.e("chunk-2d0e26e3").then(n.bind(null,"7f53"))},{path:"/navlog",name:"NavLog",component:()=>n.e("chunk-6888504e").then(n.bind(null,"29d1"))},{path:"/route/:id?",name:"Route",component:()=>Promise.all([n.e("chunk-143fdd99"),n.e("chunk-ed85a372")]).then(n.bind(null,"b59c"))},{path:"/weather",name:"Weather",component:()=>Promise.all([n.e("chunk-3e32b5c3"),n.e("chunk-8fe7d73a")]).then(n.bind(null,"6a05"))},{path:"/notam",name:"Notam",component:()=>Promise.all([n.e("chunk-3e32b5c3"),n.e("chunk-59f8f64c")]).then(n.bind(null,"1625"))},{path:"/approach",name:"Approach",component:()=>Promise.all([n.e("chunk-3e32b5c3"),n.e("chunk-27572792")]).then(n.bind(null,"5831"))},{path:"/balance/:id?",name:"Balance",component:()=>Promise.all([n.e("chunk-70fb28ef"),n.e("chunk-2d21ab15")]).then(n.bind(null,"bd30"))},{path:"/about",name:"About",component:()=>n.e("chunk-2d22d746").then(n.bind(null,"f820"))}],P=new A["a"]({mode:"history",routes:L,linkActiveClass:"is-active",scrollBehavior(e){if(e.hash)return{selector:e.hash}}});var N=P,O=n("2f62"),M=n("1caf"),T=n("b98f");a["a"].use(O["a"]);var B=new O["a"].Store({state:{currentUser:null,currentAircraft:null,currentNavigation:null},mutations:{currentUser:(e,t)=>{if(t){let{derived_key:n,iterations:a,password_scheme:r,salt:i,...s}=t;e.currentUser=s}else e.currentUser=null},currentAircraft(e,t){e.currentAircraft=t?T["a"].from(t):t},currentNavigation(e,t){e.currentNavigation=t?M["a"].from(t):t}},actions:{saveToDB(e,t){let n=JSON.parse(JSON.stringify(t));return n._id||(n._id=`${n.type}-${Date.now()}`),this._vm.$pouch.put(n).then(e=>(t._id=e.id,t._rev=e.rev,t))},deleteFromDB(e,t){return this._vm.$pouch.remove(t)}}}),q=n("289d"),I=(n("5363"),n("d6e1")),W=n("fcd3"),j=n("eae4");a["a"].use(q["a"],{defaultProgrammaticPromise:!0}),I["a"].plugin(W["a"]),a["a"].use(j["a"],"navue"),a["a"].config.productionTip=!1,new a["a"]({router:N,store:B,render:e=>e(C)}).$mount("#app")},"5c0b":function(e,t,n){"use strict";var a=n("9c0c"),r=n.n(a);r.a},7174:function(e,t,n){},9283:function(e,t,n){"use strict";var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-dropdown",e._b({attrs:{triggers:e.selectedData?["click"]:[]},scopedSlots:e._u([e.selectedData?{key:"trigger",fn:function(){return[e._t("default",[n("b-button",{attrs:{type:"is-primary","icon-right":"chevron-down"}},[e._v(" "+e._s(e.selectedData.registration)+" ")])],{selected:e.selectedData})]},proxy:!0}:{key:"trigger",fn:function(){return[n("b-autocomplete",{attrs:{placeholder:"Choose an aircraft",data:e.availableData||[],field:e.searchedProperty,"open-on-focus":"","keep-first":"","clear-on-select":"",clearable:""},on:{select:function(t){e.selectedData=t}},scopedSlots:e._u([e.edit?{key:"header",fn:function(){return[n("a",{on:{click:function(t){e.selectedData=new e.constructor({registration:e.search})}}},[n("span",[e._v(" Create "+e._s(e.search))])])]},proxy:!0}:null,e.edit?{key:"footer",fn:function(){return[n("b-field",{staticClass:"file is-primary"},[n("b-upload",{staticClass:"file-label",attrs:{accept:"application/json"},on:{input:e.importData},model:{value:e.upload,callback:function(t){e.upload=t},expression:"upload"}},[n("span",{staticClass:"file-cta"},[n("b-icon",{attrs:{icon:"upload"}}),n("span",[e._v("Import from file")])],1)])],1)]},proxy:!0}:null,e.edit?null:{key:"empty",fn:function(){return[n("span",[e._v(' "'),n("i",[e._v(e._s(e.search))]),e._v('" not found')])]},proxy:!0}],null,!0),model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]},proxy:!0}],null,!0)},"b-dropdown",e.$attrs,!1),[e.selectedData?[e.$slots.header?n("b-dropdown-item",{attrs:{custom:""}},[e._t("header",null,{selected:e.selectedData})],2):e._e(),e.edit?n("b-dropdown-item",{on:{click:e.saveData}},[n("b-icon",{attrs:{icon:"cloud-upload-outline",type:"is-warning"}}),e._v(" Save ")],1):e._e(),n("b-dropdown-item",{on:{click:function(t){e.selectedData=void 0}}},[n("b-icon",{attrs:{icon:"selection-off"}}),e._v(" Discard ")],1),e.edit?n("b-dropdown-item",{attrs:{disabled:!e.fromDB},on:{click:function(t){e.selectedData=e.cloneData(e.selectedData)}}},[n("b-icon",{attrs:{icon:"plus-circle-multiple-outline"}}),e._v(" Clone ")],1):e._e(),e.edit?n("b-dropdown-item",{on:{click:e.exportData}},[n("b-icon",{attrs:{icon:"download-outline"}}),e._v(" Download ")],1):e._e(),e.edit?n("b-dropdown-item",{attrs:{disabled:!e.fromDB},on:{click:e.deleteData}},[n("b-icon",{attrs:{icon:"delete-outline",type:"is-danger"}}),e._v(" Delete ")],1):e._e()]:e._e()],2)},a=[],r=n("1db5"),i=n("b98f"),s={name:"AircraftManager",mixins:[r["a"]],props:{edit:Boolean},data(){return{constructor:i["a"],searchedProperty:"registration"}},computed:{selectedData:{get(){return this.$store.state.currentAircraft},set(e){this.$store.commit("currentAircraft",e)}}}},o=s,c=(n("2caa"),n("2877")),u=Object(c["a"])(o,render,a,!1,null,"028195d2",null);t["a"]=u.exports},"9c0c":function(e,t,n){},b98f:function(e,t,n){"use strict";n.d(t,"a",(function(){return Aircraft})),n.d(t,"b",(function(){return Moment}));var a=n("bd67"),r=n("3634");class Aircraft extends a["a"]{constructor({registration:e,manufacturer:t,model:n,paces:i=new a["b"],consumptions:s=new a["b"],balance:o=new a["b"]({date:void 0}),envelopes:c=new a["b"],checklists:u=new a["b"]}={}){i.keep(e=>e instanceof r["e"]?e:void 0),s.keep(e=>e instanceof r["c"]?e:void 0),o.keep(e=>e instanceof r["f"]?e:void 0),c.keep(e=>e instanceof a["b"]?e:void 0),u.keep(e=>e instanceof a["b"]?e:void 0),super({registration:e,manufacturer:t,model:n,paces:i,consumptions:s,balance:o,envelopes:c,checklists:u})}static from({_id:e,_rev:t,type:n,registration:i,manufacturer:s,model:o,paces:c,consumptions:u,balance:l,envelopes:d,checklists:h}={}){if(arguments[0]instanceof this)return arguments[0];if(n!=this.name)throw`Invalid data : 'type' should be '${this.name}' got '${n}'`;{c&&(c=a["b"].from(c,r["e"])),u&&(u=a["b"].from(u,r["c"])),l&&(l=a["b"].from(l,r["f"])),d&&(d=a["b"].from(d,a["b"],Moment)),h&&(h=a["b"].from(h,a["b"]));let n=new this({registration:i,manufacturer:s,model:o,paces:c,consumptions:u,balance:l,envelopes:d,checklists:h});return e&&t&&Object.assign(n,{_id:e,_rev:t}),n}}}class Moment extends a["a"]{constructor(e,t,n){e||(e=new r["f"]),t||(t=new r["d"]),super({mass:e,lever:t,...n})}get value(){return this.mass.value*this.lever.value}get _value(){return this.mass*this.lever}get unit(){return`${this.mass.unit}.${this.lever.unit}`}valueOf(){return this._value}toJSON(){return{...this,value:this.value,unit:this.unit,type:this.constructor.name}}toCoords(){return{x:this.lever.value,y:this.mass.value}}static from({type:e,mass:t,lever:n}={}){if(arguments[0]instanceof this)return arguments[0];if(e==this.name)return t&&(t=r["f"].from(t)),n&&(n=r["d"].from(n)),new this(t,n);throw`Invalid data : 'type' should be '${this.name}' got '${e}'`}}},bd67:function(e,t,n){"use strict";n.d(t,"a",(function(){return Model})),n.d(t,"b",(function(){return Store}));class Model{constructor({type:e,...t}={}){Object.assign(this,t)}toJSON(){return{...this,type:this.constructor.name}}clone(){return this.constructor.from(JSON.parse(JSON.stringify(this)))}static from({type:e,...t}={}){if(arguments[0]instanceof this)return arguments[0];if(e==this.name)return new this(t);throw`Invalid data : 'type' should be '${this.name}' got '${e}'`}}class Store{constructor(e={},...t){this.items=t,Object.assign(this,e)}[Symbol.iterator](){return this.items[Symbol.iterator]()}get length(){return this.items.length}valueOf(){return this.items}get properties(){let{items:e,...t}={...this};return t}get first(){return this.items[0]}get last(){return this.items[this.length-1]}add(e,t){return t?this.items.splice(t,0,e):this.items.push(e),this.length}remove(e,t){return void 0===t&&(t=this.items.indexOf(e)),t>=0&&1==this.items.splice(t,1).length}keep(e){let t=this.items.length;while(t--){let n=e.call(this.items,this.items[t]);void 0==n?this.items.splice(t,1):Object.is(n,this.items[t])||this.items.splice(t,1,n)}return this}toJSON(){return{...this.properties,items:this.items,type:this.constructor.name}}static from({type:e,items:t=[],...n},...a){if(e!=this.name)throw`Invalid data : 'type' should be '${this.name}' got '${e}'`;{let e=a.shift();return new this(n,...t.map(t=>e?e.from(t,...a):t))}}}},f9de:function(e,t,n){"use strict";n.d(t,"b",(function(){return Waypoint})),n.d(t,"a",(function(){return Location}));var a=n("bd67"),r=n("3634"),i=n("d425");class Waypoint extends a["a"]{constructor(e,t,n,a={}){!n||n instanceof r["a"]||(n=new r["a"](n)),super({latitude:e,longitude:t,altitude:n,...a})}set latlng({lat:e,lng:t}={}){this.latitude=e,this.longitude=t}get latlng(){return{lat:this.latitude,lng:this.longitude}}get point(){return new i["a"](this.latitude,this.longitude)}distanceTo(e){return new r["d"](this.point.rhumbDistanceTo(e.point),"m")}bearingTo(e){return new r["b"](this.point.rhumbBearingTo(e.point),"°",{_precision:3})}destinationPoint(e,t){let n=this.point.rhumbDestinationPoint(e,t);return new this.constructor(n.lat,n.lng)}toGeoJSON(){const{latitude:e,longitude:t,...n}=this;return{type:"Feature",properties:n,geometry:this.point.toGeoJSON()}}static from({type:e,latitude:t,longitude:n,altitude:a,latlng:i,...s}){if(arguments[0]instanceof this)return arguments[0];if(e!=this.name)throw`Invalid data : 'type' should be '${this.name}' got '${e}'`;return a&&(a=r["a"].from(a)),i&&(t=t||i.lat,n=n||i.lng),new this(t,n,a,s)}}class Location extends Waypoint{constructor(e,t,n,{accuracy:a,verticalSpeed:r,speed:i,heading:s,timestamp:o,...c}={}){super(e,t,n,{accuracy:a,verticalSpeed:r,speed:i,heading:s,timestamp:o,...c})}_delayFrom(e){return this.timestamp-e.timestamp}_climbFrom(e){return this.altitude-e.altitude}_speedFrom(e){try{if(0==this._delayFrom(e))throw"Teleportation is not yet a possibility";return new r["e"](this.distanceTo(e)/this._delayFrom(e)*1e3)}catch{return}}_verticalSpeedFrom(e){try{if(0==this._delayFrom(e))throw"Teleportation is not yet a possibility";return new r["e"](this._climbFrom(e)/this._delayFrom(e)*1e3)}catch{return}}movementFrom(e){return{speed:this._speedFrom(e),verticalSpeed:this._verticalSpeedFrom(e),heading:e.bearingTo(this)}}toBounds(e=this.accuracy){const t=180*e/40075017,n=t/Math.cos(Math.PI/180*this.latitude);return[[this.latitude-t,this.longitude-n],[this.latitude+t,this.longitude+n]]}positionInSeconds(e,t=this.heading){if(this.speed&&t)return this.destinationPoint(this.speed*e,t.value);throw"cannot calculate futur position, speed & heading should be provided"}static from({accuracy:e,verticalSpeed:t,speed:n,heading:a,timestamp:i,...s}={}){return t&&(t=r["e"].from(t)),n&&(n=r["e"].from(n)),a&&(a=r["b"].from(a)),super.from({...s,accuracy:e,verticalSpeed:t,speed:n,heading:a,timestamp:i})}static fromGeolocationPosition({coords:{latitude:e,longitude:t,altitude:n,accuracy:a,altitudeAccuracy:i,heading:s,speed:o},timestamp:c}){return n&&(n=new r["a"](n,"m",{reference:"WGS84",accuracy:i})),o&&(o=new r["e"](o,"m/s")),s&&(s=new r["b"](s,"°")),this.from({type:"Location",latitude:e,longitude:t,accuracy:a,altitude:n,speed:o,heading:s,timestamp:c})}static fromLocate({latitude:e,longitude:t,accuracy:n,altitude:a,altitudeAccuracy:i,speed:s,heading:o,timestamp:c}){return a&&(a=new r["a"](a,"m",{reference:"WGS84",accuracy:i})),s&&(s=new r["e"](s,"m/s")),o&&(o=new r["b"](o,"°")),this.from({type:"Location",latitude:e,longitude:t,accuracy:n,altitude:a,speed:s,heading:o,timestamp:c})}}}});
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-27572792"],{"4b89":function(t,e,r){"use strict";e["a"]={data(){return{AZBASourceUrl:"https://www.sia.aviation-civile.gouv.fr/schedules",VACSourceUrl:"https://www.sia.aviation-civile.gouv.fr/",NOTAMSourceUrl:"https://notamweb.aviation-civile.gouv.fr/Script/IHM/Bul_Aerodrome.php"}},methods:{async fetchSIA(t,e={}){const r=await fetch(t,e);if(r.ok){const t=await r.text();return(new DOMParser).parseFromString(t,"text/html")}throw{code:r.status,message:r.statusText}},async getAZBAfiles(){const t=await this.fetchSIA(this.AZBASourceUrl),e=Array.from(t.getElementsByTagName("iframe"));return e.map(t=>{const[e,r,a,i,s,o,n,l]=t.src.match(/.*(\d{4})-(\d{2})-(\d{2})_(\d{2})(\d{2})-(\d{2})(\d{2}).pdf+/i),c=new Date(Date.UTC(r,a-1,i,s,o)),u=new Date(Date.UTC(r,a-1,i,n,l));return{url:e,start:c,end:u}})},async getVACbaseUrl(){const t=await this.fetchSIA(this.VACSourceUrl),e=t.querySelector("a[href*=Atlas-VAC]").href,r=new URL(e).searchParams.get("f");return new URL(r.replace("home.htm","PDF_AIPparSSection/VAC/AD/"),this.VACSourceUrl)},VACurl(t,e=this.baseURL){return new URL(`AD-2.${t}.pdf`,e)},async getAirportNOTAMs(t){const e=new URLSearchParams(this.formatAeroParams(t)).toString(),r=await this.fetchSIA(this.NOTAMSourceUrl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e}),a=Array.from(r.querySelectorAll("pre")).map(t=>this.decodeMessage(t.innerText));return this.groupByAttribute(a,"A",t=>t)},formatAeroParams(t){return{bResultat:!0,bImpression:"",ModeAffichage:"COMPLET",AERO_Langue:"FR",AERO_Date_DATE:t.datetime.toLocaleString("ja-jp",{timeZone:"UTC",hour12:!1,year:"numeric",month:"2-digit",day:"2-digit"}),AERO_Date_HEURE:t.datetime.toLocaleString("en-us",{timeZone:"UTC",hour12:!1,hour:"2-digit",minute:"2-digit"}),AERO_Duree:t.durations||12,AERO_Rayon:t.radius||10,AERO_Plafond:t.ceiling||30,AERO_CM_REGLE:["IFR/VFR","IFR","VFR"].indexOf(t.flightrules)+1,AERO_CM_GPS:t.complementary.includes("gps")?1:2,AERO_CM_INFO_COMP:t.complementary.includes("misc")?1:2,...this.buildCodesParam(t.codes,"AERO_Tab_Aero")}},buildCodesParam(t,e){let r=new Array(12).fill("");r.splice(0,t.length,...t);const a=r.map((t,r)=>[`${e}[${r}]`,t.id||""]);return Object.fromEntries(a)},decodeMessage(t){return{id:t.split("\n")[0].trim(),raw:t,...Object.fromEntries(Array.from(t.matchAll(/([QABCDEFG])\) (.+?)(?=(?: |\n)+[QABCDEFG]\) |$)/gs)).map(t=>[t[1],t[2].trim()]))}},groupByAttribute(t,e,r){return t.reduce((t,a)=>(a&&(t[a[e]]=t[a[e]]||[]).push(r.call(null,a)),t),{})}}}},5831:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",[0==t.codes.length?r("section",{staticClass:"hero is-primary is-hidden-mobile"},[t._m(0)]):t._e(),r("div",{staticClass:"notification"},[r("b-loading",{attrs:{"is-full-page":!1,active:null===t.baseURL&&!t.error}}),r("b-loading",{attrs:{"is-full-page":!1,active:t.error}},[r("b-notification",{attrs:{"has-icon":"",icon:"alert-circle-outline",closable:!1,"aria-close-label":"Close notification"}},[r("h4",{staticClass:"title"},[t._v("SIA Server Unavailable")]),r("p",{staticClass:"heading"},[t._v(" Check your connection or use SIA server directly ")]),r("a",{attrs:{href:"https://www.sia.aviation-civile.gouv.fr/",target:"_blank"}},[t._v("https://www.sia.aviation-civile.gouv.fr/")])])],1),r("b-field",{attrs:{label:"ICAO Code for Airports",expanded:""}},[r("b-icao",{model:{value:t.codes,callback:function(e){t.codes=e},expression:"codes"}})],1)],1),r("section",{staticClass:"section"},[r("div",{staticClass:"columns is-multiline"},[t._l(t.codes,(function(e,a){return r("div",{key:a,staticClass:"column is-one-quarter"},[r("ChartCartridge",t._b({attrs:{url:t.VACurl(e.id,t.baseURL),tags:{info:"Airport"},card:""},on:{click:function(e){t.openChartUrl=e}}},"ChartCartridge",e,!1),[r("figure",{staticClass:"image"},[r("pdf",{staticStyle:{height:"100%"},attrs:{src:t.VACurl(e.id,t.baseURL).toString(),page:1}})],1)])],1)})),r("PDFModal",{attrs:{active:!!t.openChartUrl},model:{value:t.openChartUrl,callback:function(e){t.openChartUrl=e},expression:"openChartUrl"}})],2)])])},i=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"hero-body"},[r("div",{staticClass:"container"},[r("h1",{staticClass:"title"},[t._v("Approach Charts")]),r("h2",{staticClass:"subtitle"},[t._v(" Get charts for VFR arrival on your airfields. ")])])])}],s=r("8a3a"),o=r("d648"),n=r("4a4f"),l=r("858e"),c=r("4b89"),u={name:"ApproachChart",components:{BIcao:s["a"],ChartCartridge:o["a"],PDFModal:n["a"],Pdf:l["a"]},mixins:[c["a"]],data(){return{error:!1,codes:[],baseURL:null,openChartUrl:null}},async mounted(){this.baseURL=await this.getCycleUrl()},methods:{async getCycleUrl(){try{return clearTimeout(this.error),this.error=!1,await this.getVACbaseUrl()}catch(t){console.error(t),this.error=setTimeout(this.getCycleUrl,3e3)}}}},d=u,h=r("2877"),m=Object(h["a"])(d,a,i,!1,null,null,null);e["default"]=m.exports}}]);
(function(e){function webpackJsonpCallback(t){for(var n,i,s=t[0],o=t[1],u=t[2],l=0,d=[];l<s.length;l++)i=s[l],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&d.push(r[i][0]),r[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);c&&c(t);while(d.length)d.shift()();return a.push.apply(a,u||[]),checkDeferredModules()}function checkDeferredModules(){for(var e,t=0;t<a.length;t++){for(var n=a[t],i=!0,s=1;s<n.length;s++){var o=n[s];0!==r[o]&&(i=!1)}i&&(a.splice(t--,1),e=__webpack_require__(__webpack_require__.s=n[0]))}return e}var t={},n={app:0},r={app:0},a=[];function jsonpScriptSrc(e){return __webpack_require__.p+"js/"+({}[e]||e)+"."+{"chunk-2d0c8dd2":"73754191","chunk-2d22d746":"60cbb83d","chunk-2f5398a4":"f668e7b3","chunk-2d221f18":"004c75d2","chunk-3e2c2ddc":"c7dbfabe","chunk-0e671e40":"fbbe1dc4","chunk-9bb762f6":"fd14993b","chunk-300dc543":"6118db24","chunk-ed85a372":"9641af83","chunk-5ac5a83e":"8ed8649a"}[e]+".js"}function __webpack_require__(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,__webpack_require__),r.l=!0,r.exports}__webpack_require__.e=function requireEnsure(e){var t=[],a={"chunk-3e2c2ddc":1,"chunk-0e671e40":1,"chunk-9bb762f6":1,"chunk-300dc543":1,"chunk-ed85a372":1};n[e]?t.push(n[e]):0!==n[e]&&a[e]&&t.push(n[e]=new Promise((function(t,r){for(var a="css/"+({}[e]||e)+"."+{"chunk-2d0c8dd2":"31d6cfe0","chunk-2d22d746":"31d6cfe0","chunk-2f5398a4":"31d6cfe0","chunk-2d221f18":"31d6cfe0","chunk-3e2c2ddc":"5ca4488b","chunk-0e671e40":"a2c7d7c1","chunk-9bb762f6":"20149018","chunk-300dc543":"b9820e4f","chunk-ed85a372":"48d2b289","chunk-5ac5a83e":"31d6cfe0"}[e]+".css",i=__webpack_require__.p+a,s=document.getElementsByTagName("link"),o=0;o<s.length;o++){var c=s[o],u=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(u===a||u===i))return t()}var l=document.getElementsByTagName("style");for(o=0;o<l.length;o++){c=l[o],u=c.getAttribute("data-href");if(u===a||u===i)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var a=t&&t.target&&t.target.src||i,s=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");s.code="CSS_CHUNK_LOAD_FAILED",s.request=a,delete n[e],d.parentNode.removeChild(d),r(s)},d.href=i;var h=document.getElementsByTagName("head")[0];h.appendChild(d)})).then((function(){n[e]=0})));var i=r[e];if(0!==i)if(i)t.push(i[2]);else{var s=new Promise((function(t,n){i=r[e]=[t,n]}));t.push(i[2]=s);var o,c=document.createElement("script");c.charset="utf-8",c.timeout=120,__webpack_require__.nc&&c.setAttribute("nonce",__webpack_require__.nc),c.src=jsonpScriptSrc(e);var u=new Error;o=function(t){c.onerror=c.onload=null,clearTimeout(l);var n=r[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+a+": "+i+")",u.name="ChunkLoadError",u.type=a,u.request=i,n[1](u)}r[e]=void 0}};var l=setTimeout((function(){o({type:"timeout",target:c})}),12e4);c.onerror=c.onload=o,document.head.appendChild(c)}return Promise.all(t)},__webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,n){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},__webpack_require__.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(__webpack_require__.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)__webpack_require__.d(n,r,function(t){return e[t]}.bind(null,r));return n},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e["default"]}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="/",__webpack_require__.oe=function(e){throw console.error(e),e};var i=window["webpackJsonp"]=window["webpackJsonp"]||[],s=i.push.bind(i);i.push=webpackJsonpCallback,i=i.slice();for(var o=0;o<i.length;o++)webpackJsonpCallback(i[o]);var c=s;a.push([0,"chunk-vendors"]),checkDeferredModules()})({0:function(e,t,n){e.exports=n("56d7")},"00b4":function(e,t,n){"use strict";n.d(t,"a",(function(){return Flight}));var r=n("bd67"),a=n("f9de");class Flight extends r["a"]{constructor({name:e,notes:t,checked:n=[],markedTimes:a=[]}={},...i){i=new r["b"]({},...i),super({name:e,notes:t,locations:i,checked:n,markedTimes:a})}addLocation(e){return delete e._id,delete e._rev,this.locations.add(a["a"].from(e)),this}toBounds(){return this.locations.reduce((e,t,n)=>0==n?[[t.latitude,t.longitude],[t.latitude,t.longitude]]:[[Math.min(t.latitude,e[0][0]),Math.min(t.longitude,e[0][1])],[Math.max(t.latitude,e[1][0]),Math.max(t.longitude,e[1][1])]],void 0)}static from({type:e,locations:t,_id:n,_rev:i,...s}={}){if(arguments[0]instanceof this)return arguments[0];if(e!=this.name)throw`Invalid data : 'type' should be '${this.name}' got '${e}'`;{t&&(t=r["b"].from(t,a["a"]));let e=new this(s,...t);return n&&i&&Object.assign(e,{_id:n,_rev:i}),e}}}},"039a":function(e,t,n){"use strict";var r=n("7174"),a=n.n(r);a.a},"08df":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return s}));const r={data(){return{envelopesDataset:{showLines:!0,showLine:!0,fill:"start",borderWidth:2,pointRadius:5,pointHoverRadius:5,tension:0},cgDataset:{borderWidth:2,pointRadius:5,pointHoverRadius:5}}}},a={methods:{readTextFileAsync(e){return new Promise((t,n)=>{let r=new FileReader;r.onload=()=>{t(r.result)},r.onerror=n,r.readAsText(e)})},downloadJSON(e,t){let n=new Blob([JSON.stringify(e,void 0,2)],{type:"application/json",name:t});const r=document.createElement("a");r.href=URL.createObjectURL(n),r.download=t,r.click()},async uploadJSON(e){let t;return t=JSON.parse(await this.readTextFileAsync(e)),t}}},i={methods:{openWarning(e,t,n){this.$buefy.snackbar.open({message:e,position:"is-bottom",type:"is-danger",duration:5e3,actionText:t,onAction:n})}}},s={data(){return{wakeLock:null}},mixins:[i],mounted(){this.requestWakeLock(),document.addEventListener("visibilitychange",this.requestWakeLock)},beforeDestroy(){document.removeEventListener("visibilitychange",this.requestWakeLock),this.wakeLock&&this.wakeLock.release()},methods:{async requestWakeLock(){try{if(!("wakeLock"in navigator)||"visible"!==document.visibilityState)throw"WakeLock unavaliable";this.wakeLock=await navigator.wakeLock.request("screen")}catch(e){this.openWarning(e)}}}}},1:function(e,t){},"1caf":function(e,t,n){"use strict";n.d(t,"a",(function(){return Navigation}));var r=n("bd67"),a=n("f9de");class Navigation extends r["a"]{constructor({name:e,notes:t}={},...n){n=new r["b"]({},...n).keep(e=>e.keep(e=>e instanceof a["b"]?e:void 0)),super({name:e,notes:t,routes:n})}addRoute(...e){return this.routes.add(new r["b"]({},...e)),this.routes.last}removeRoute(e){return this.routes.remove(e)}clearRoute(e){if(e=this.getRoute(e),e&&0==e.length)return this.removeRoute(e),!0}addWaypoint({insertBefore:e,...t}={},n){return n=this.getRoute(n),n.add(a["b"].from({...t,type:"Waypoint"}),e)}removeWaypoint(e,t){return t=this.getRoute(t),Number.isInteger(e)?t.remove(void 0,e):t.remove(e)}getNextWaypoint(e){const t=this.waypoints.indexOf(e);return this.waypoints[t+1]}getRoute(e){return e instanceof r["b"]?e:isFinite(e)?this.routes.items[e]:this.last}getRouteId(e){return e instanceof r["b"]?this.routes.indexOf(e):Number.isInteger(e)?e:this.routes.length-1}get waypoints(){return this.routes.items.map(e=>e.items).flat()}toBounds(){return this.waypoints.reduce((e,t,n)=>0==n?[[t.latitude,t.longitude],[t.latitude,t.longitude]]:[[Math.min(t.latitude,e[0][0]),Math.min(t.longitude,e[0][1])],[Math.max(t.latitude,e[1][0]),Math.max(t.longitude,e[1][1])]],void 0)}static from({type:e,routes:t,_id:n,_rev:i,...s}={}){if(arguments[0]instanceof this)return arguments[0];if(e!=this.name)throw`Invalid data : 'type' should be '${this.name}' got '${e}'`;{t&&(t=r["b"].from(t,r["b"],a["b"]));let e=new this(s,...t);return n&&i&&Object.assign(e,{_id:n,_rev:i}),e}}}},"1db5":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("08df");const a={mixins:[r["b"],r["c"]],props:{create:Boolean,edit:Boolean,persistent:Boolean},data(){return{search:"",upload:[]}},mounted(){this.persistent&&this.createData()},computed:{dataType(){return this.constructor.name},fromDB(){return this.selectedData&&this.selectedData._id&&this.selectedData._rev},selectedData:{get(){return this.$store.state[this.storeKey]},set(e){try{this.$store.commit(this.storeKey,e)}catch(t){this.$buefy.dialog.alert({title:"Cannot load item",message:"Selected record is corrupted. It will be purged from database. Do you want to download it localy before ?",type:"is-danger",hasIcon:!0,trapFocus:!0,icon:"cloud-download-outline",confirmText:"Download & Delete",onConfirm:()=>{this.downloadJSON(e,"navue-corrupted-item.json")},canCancel:!0,cancelText:"Just delete it"}),this.$store.dispatch("deleteFromDB",e)}}},selectedName(){return this.selectedData?this.selectedData[this.searchedProperty]:void 0}},pouch:{availableData(){let e={type:this.dataType};return e[this.searchedProperty]={$regex:RegExp(this.search,"i")},{database:"navue",selector:e}}},methods:{createData(e){this.selectedData=new this.constructor(e)},async saveData(){try{let e=await this.$store.dispatch("saveToDB",this.selectedData);this.selectedData=e,this.openWarning(`"${this.selectedName}" saved`)}catch(e){this.dispatchError(e)}},async deleteData(){try{await this.$store.dispatch("deleteFromDB",this.selectedData),this.selectedData=null,this.openWarning(`"${this.selectedName}" deleted`)}catch(e){this.dispatchError(e)}},async importData(e){try{let t=await this.uploadJSON(e);this.selectedData=this.cloneData(t),this.openWarning(`"${this.selectedName}" imported`)}catch(t){this.dispatchError(t)}},exportData(){this.selectedData&&this.downloadJSON(this.selectedData,this.selectedName+".json")},cloneData(e){let t=e.clone();return delete t._id,delete t._rev,t.name&&(t.name+="-1"),t.registration&&(t.registration+="(cloned)"),t},dispatchError(e){console.error(e),this.openWarning(e)}}}},3634:function(e,t,n){"use strict";n.d(t,"d",(function(){return Distance})),n.d(t,"a",(function(){return Altitude})),n.d(t,"f",(function(){return Speed})),n.d(t,"c",(function(){return Consumption})),n.d(t,"g",(function(){return Weight})),n.d(t,"b",(function(){return Azimuth})),n.d(t,"e",(function(){return Moment}));var r=n("bd67");class Quantity extends r["a"]{constructor(e,t,{type:n,_precision:r,...a}={}){super(a),t?this.unit=t:this._unit=void 0,e||0===e?this.value=e:this._value=void 0,r&&(this.precision=r)}get value(){return this.constructor.significantValue(this._to(this._value),this._precision)}set value(e){if(isNaN(e))throw e+" is not a number";this._value=this._from(e),this.precision=this.constructor.getSignificativeDigits(e)}get unit(){return this._unit||this.constructor.baseUnit}set unit(e){if(!this.constructor.units[e])throw`'${e}' is not an available unit`;this._unit=e}get factor(){return this.constructor.units[this.unit]}get precision(){return this._precision}set precision(e){this._precision=Math.max(1,Math.min(21,parseInt(e)))}_from(e,t=this.unit){return Number(e)/this._factor(t)}_to(e,t=this.unit){return Number(e)*this._factor(t)}_factor(e){if(this.constructor.units[e])return this.constructor.units[e];throw`'${e}' is not an available unit`}to(e){return this._to(this.value,e)}as(e,t){return Object.assign(this.constructor.from(this),{_unit:e,_precision:t})}valueOf(){return this._value}toString(){return`${isNaN(this.value)?"-":this.value.toLocaleString(void 0,{minimumSignificantDigits:this.precision,maximumSignificantDigits:this.precision})} ${this.unit}`}toJSON(){let{_value:e,_unit:t,_precision:n,...r}=this;return{...r,value:this.value,unit:this.unit,type:this.constructor.name}}static getSignificativeDigits(e){let t=Math.abs(e);if(0===t)return 0;let n=Math.floor(Math.log10(t))+1;return n>0?t/=10**n:n<0&&(t*=10**-n),t=Math.round(1e16*t)/1e16,String(t).length-2}static significantValue(e,t=1){if(0===e)return 0;const n=Math.pow(10,t-Math.floor(Math.log(e<0?-e:e)/Math.LN10)-1);return Math.round(e*n)/n}static get units(){throw"list of available units should be set on constructor."}static get baseUnit(){return Object.keys(this.units)[Object.values(this.units).indexOf(1)]}static from({type:e,value:t,unit:n,...r}={}){if(!e||this.name==e)return new this(t,n,r)}}class Distance extends Quantity{static get units(){return{m:1,Km:.001,ft:3.28084,NM:539957e-9,mi:621371e-9,yd:1.09361}}}class Altitude extends Distance{constructor(e,t,{reference:n,...r}={}){if("FL"==t)n="QNE";else if(t&&!n)throw`property 'reference' should be given, got '${n}'`;super(e,t,{...r,reference:n})}get value(){return"FL"==this.unit?this.constructor.significantValue(this._to(this._value),2):this._to(this._value)}set value(e){super.value=e}toString(){return"FL"==this.unit?"FL"+String(this.value).padStart(3,"0"):this.value&&this.reference?`${super.toString()} ${this.reference}`:void 0}static get references(){return["MSL","AGL","QNH","QNE","QFE","WGS84"]}static get units(){return{m:1,ft:3.28084,FL:.0328084}}}class Speed extends Quantity{static get units(){return{"m/s":1,"km/h":3.6,"ft/min":196.85,kt:1.94384,mph:2.23694}}}class Volume extends Quantity{static get units(){return{m3:1,L:1e3,"gal US":264.172,"gal Imp":219.969}}}class Consumption extends Volume{static get references(){return["h","1000ft","u"]}toString(e){return`${super.toString(e)}/${this.reference}`}}class Weight extends Quantity{static get units(){return{kg:1,lb:2.20462,t:.001,"L-avgas":.7,"L-JetA1":.8}}}class Angle extends Quantity{static get units(){return{rad:1,"°":180/Math.PI,gon:200/Math.PI,rev:.5/Math.PI,"₥":3200/Math.PI}}}class Azimuth extends Angle{get value(){return this._to((this._value+2*Math.PI)%(2*Math.PI))}set value(e){super.value=e}}class Moment extends r["a"]{constructor(e,t,n={}){e||(e=new Weight),t||(t=new Distance),super({mass:e,lever:t,...n})}get value(){return this.mass.value*this.lever.value}get _value(){return this.mass*this.lever}valueOf(){return this._value}toJSON(){return{...this,type:this.constructor.name}}toCoords(){return{x:this.lever.value,y:this.mass.value}}static from({type:e,mass:t,lever:n,...r}={}){if(arguments[0]instanceof this)return arguments[0];if(e==this.name)return t&&(t=Weight.from(t)),n&&(n=Distance.from(n)),new this(t,n,r);throw`Invalid data : 'type' should be '${this.name}' got '${e}'`}}},"56d7":function(e,t,n){"use strict";n.r(t);var r=n("2b0e"),render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("Navbar"),n("router-view")],1)},a=[],Navbarvue_type_template_id_7e6ce05e_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-navbar",{staticClass:"is-radiusless",attrs:{"fixed-top":""}},[n("template",{slot:"brand"},[n("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/"}}},[n("img",{attrs:{src:"img/icons/android-chrome-192x192.png",alt:"Navue, a navigation tool for general aviation."}})])],1),n("template",{slot:"start"},[n("b-navbar-item",{attrs:{tag:"router-link",to:{name:"Route"}}},[e._v("Briefing")]),n("b-navbar-item",{attrs:{tag:"router-link",to:{name:"MovingMap"}}},[e._v("Fly")]),n("b-navbar-item",{attrs:{tag:"router-link",to:{name:"Replay"},disabled:""}},[e._v("Debriefing")]),n("b-navbar-item",{attrs:{tag:"router-link",to:{name:"Radar"}}},[e._v("Monitor")])],1),n("template",{slot:"end"},[n("b-navbar-item",[n("AircraftManager",{attrs:{triggers:["click","hover"]},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.selected;return[n("b-button",{attrs:{type:"is-primary","icon-right":"chevron-down"}},[e._v(" "+e._s(r?r.registration:"Select an aircraft")+" ")])]}}])})],1),n("b-navbar-dropdown",{attrs:{hoverable:"",collapsible:"",right:""}},[n("template",{slot:"label"},[n("b-icon",{attrs:{icon:"account"}})],1),n("b-navbar-item",{staticStyle:{"min-width":"30vw"},attrs:{tag:"div"}},[n("Login")],1)],2)],1)],2)},i=[],s=n("9283"),Loginvue_type_template_id_2a2fe218_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("b-loading",{attrs:{"is-full-page":!1,active:!!e.error}},[n("b-notification",{attrs:{"has-icon":"",icon:"alert-circle-outline",closable:!1,"aria-close-label":"Close notification"}},[n("h4",{staticClass:"title"},[e._v("Navue User Server Unavailable")]),n("p",{staticClass:"heading"},[e._v(" Check your connection ")])])],1),e.currentUser?n("div",[n("nav",{staticClass:"level is-mobile"},[n("div",{staticClass:"level-item has-text-centered"},[n("b-icon",{attrs:{icon:e.syncIcon}})],1),n("div",{staticClass:"level-item has-text-centered"},[n("h5",{staticClass:"title is-5"},[e._v(e._s(e.currentUser.name))])])]),n("nav",{staticClass:"level"},[n("div",{staticClass:"level-item has-text-centered"},[n("div",[n("p",{staticClass:"heading"},[e._v("Aircrafts")]),n("p",{staticClass:"title"},[e._v(e._s(e.userStats.Aircraft||0))])])]),n("div",{staticClass:"level-item has-text-centered"},[n("div",[n("p",{staticClass:"heading"},[e._v("Navigations")]),n("p",{staticClass:"title"},[e._v(e._s(e.userStats.Navigation||0))])])]),n("div",{staticClass:"level-item has-text-centered"},[n("div",[n("p",{staticClass:"heading"},[e._v("Flight hours")]),n("p",{staticClass:"title"},[e._v(e._s(e.userStats.flightduration||0))])])]),n("div",{staticClass:"level-item has-text-centered"},[n("div",[n("p",{staticClass:"heading"},[e._v("Storage Quota")]),n("p",{staticClass:"title"},[e._v(e._s(e._f("percent")(e.userStats.quota||0)))])])])]),n("nav",{staticClass:"level"},[n("div",{staticClass:"level-item has-text-centered"},[n("b-button",{attrs:{type:"is-primary","icon-left":"account-arrow-right-outline"},on:{click:e.logoutUser}},[e._v("Sign out")])],1),n("div",{staticClass:"level-item has-text-centered"},[n("b-button",{attrs:{type:"is-primary is-light","icon-left":"account-edit-outline"},on:{click:function(t){e.openDetails=!0}}},[e._v("Edit")])],1)]),e.currentUser?n("b-modal",{attrs:{"has-modal-card":"","trap-focus":"","aria-role":"dialog","aria-modal":""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("UserEdit",{on:{close:t.close,"update-user":e.checkSession},model:{value:e.currentUser,callback:function(t){e.currentUser=t},expression:"currentUser"}})]}}],null,!1,388751030),model:{value:e.openDetails,callback:function(t){e.openDetails=t},expression:"openDetails"}}):e._e()],1):n("fieldset",[n("b-field",{attrs:{label:"Email"}},[n("b-input",{attrs:{type:"email",icon:"email",placeholder:"pilote@navue.io",required:""},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),n("b-field",{attrs:{label:"Password"}},[n("b-input",{attrs:{type:"password",icon:"lock",placeholder:"*******",required:"","password-reveal":""},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),n("b-field",{attrs:{"is-grouped":""}},[n("b-button",{staticClass:"is-primary",attrs:{"icon-left":"account-arrow-left-outline",expanded:""},on:{click:function(t){return e.loginUser(e.username,e.password)}}},[e._v("Sign in")]),n("b-button",{staticClass:"is-primary is-light",attrs:{"icon-left":"account-plus-outline"},on:{click:function(t){return e.newUser(e.username,e.password)}}},[e._v("Create Account")]),e.gotLocalData?n("b-button",{staticClass:"is-danger is-light",attrs:{"icon-left":"database-remove"},on:{click:e.cleanLocal}},[e._v("Clear device")]):e._e()],1)],1)],1)},o=[],UserEditvue_type_template_id_3084a520_render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"modal-card",staticStyle:{width:"max-content"}},[n("header",{staticClass:"modal-card-head"},[n("p",{staticClass:"modal-card-title"},[e._v(e._s(e.value.name))]),n("button",{staticClass:"delete",attrs:{type:"button"},on:{click:function(t){return e.$emit("close")}}})]),n("fieldset",{staticClass:"modal-card-body"},[n("b-taglist",e._l(e.value.roles,(function(t){return n("b-tag",{key:t,attrs:{type:"is-primary",size:"is-medium"}},[e._v(e._s(t))])})),1),n("b-field",{attrs:{label:"Licences"}},[n("b-taginput",{attrs:{ellipsis:"",icon:"label",placeholder:"Add a Licence","aria-close-label":"Delete this tag"},model:{value:e.value.licences,callback:function(t){e.$set(e.value,"licences",t)},expression:"value.licences"}})],1),n("b-field",{attrs:{label:"Organization"}},[n("b-input",{attrs:{type:"text",icon:"domain"},model:{value:e.value.organization,callback:function(t){e.$set(e.value,"organization",t)},expression:"value.organization"}})],1),n("div",{staticClass:"divider is-danger"},[e._v("Danger Zone")]),n("b-field",{attrs:{label:"New Password",type:"is-warning"}},[n("b-input",{attrs:{type:"password","password-reveal":"",autocomplete:"new-password",icon:"account-key"},model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}}),n("p",{staticClass:"control"},[n("b-button",{attrs:{type:"is-warning is-light","icon-left":"lock-reset"},on:{click:function(t){return e.updatePassword(e.value.name,e.newPassword)}}},[e._v("Change Password")])],1)],1)],1),n("footer",{staticClass:"modal-card-foot"},[n("b-button",{attrs:{type:"is-primary","icon-left":"account-edit-outline",expanded:""},on:{click:function(t){return e.updateUser(e.value.name,e.metadata)}}},[e._v("Save")]),n("b-button",{attrs:{type:"is-danger","icon-left":"account-remove"},on:{click:function(t){return e.deleteUser(e.value.name)}}},[e._v("Delete Account")])],1)])},c=[];const u={data(){return{syncHandle:null,remoteDbUrl:new URL("https://db.treville.fr:8443")}},computed:{remoteDB(){return this.$pouch.getDB(this.remoteDbUrl)}},methods:{getCurrentUser(){return this.remoteDB.getSession().then(e=>new Promise((t,n)=>{e.userCtx.name?t(e.userCtx.name):n(new Error("No session available."))})).then(e=>this.remoteDB.getUser(e))},userDBname(e){return"userdb-"+Array.from(e).map(e=>e.charCodeAt(0)<128?e.charCodeAt(0).toString(16):encodeURIComponent(e).replace(/%/g,"").toLowerCase()).join("")},getUserStats(e){return e.query({map:(e,t)=>{t(e.type)},reduce:"_count"},{group:!0}).then(e=>e.rows.reduce((e,t)=>(e[t.key]=t.value,e),{})).catch(console.error)},stopSync(){if(this.syncHandle)return this.syncHandle.cancel()},confirmAction(e){return this.$buefy.dialog.confirm({type:"is-danger",hasIcon:!0,...e})},openToast(e){this.$buefy.toast.open({duration:2e3,position:"is-top",type:"is-danger",...e})}}};var l={name:"UserEdit",mixins:[u],data(){return{newPassword:null,confirm:{deleteUser:{title:"Deleting account",message:"Are you sure you want to <b>delete</b> your account? This action cannot be undone.",confirmText:"Delete Account"},updatePassword:{title:"Change Password",message:"Are you sure you want to <b>change</b> current password.",confirmText:"Change password"}}}},props:["value"],computed:{metadata(){return{licences:this.value.licences,organization:this.value.organization}}},methods:{deleteUser(e){return this.confirmAction(this.confirm.deleteUser).then(()=>this.remoteDB.deleteUser(e)).then(()=>{this.$emit("update-user"),this.$emit("close")}).catch(this.openToast)},updateUser(e,t){return this.remoteDB.putUser(e,{metadata:t}).then(()=>{this.$emit("update-user"),this.$emit("close")}).catch(this.openToast)},updatePassword(e,t){return this.confirmAction(this.confirm.updatePassword).then(()=>this.remoteDB.changePassword(e,t)).then(()=>{this.$emit("close")}).finally(()=>{this.newPassword=null}).catch(this.openToast)}}},d=l,h=n("2877"),p=Object(h["a"])(d,UserEditvue_type_template_id_3084a520_render,c,!1,null,null,null),m=p.exports,f={name:"Login",components:{UserEdit:m},mixins:[u],data(){return{openDetails:!1,username:null,password:null,userStats:{},syncIcon:"cloud-off-outline",serverPresent:void 0,error:!1}},async mounted(){this.serverPresent=await this.checkServer("navue")},computed:{currentUser:{get(){return this.$store.state.currentUser},set(e){this.$store.commit("currentUser",e)}},gotLocalData(){return this.userStats.constructor===Object&&Object.keys(this.userStats).length>0}},created(){this.setCurrentUser().then(this.startSync).catch(e=>{console.info(e.message)}).finally(this.setUserStats)},methods:{async checkServer(e){try{return clearTimeout(this.error),this.error=!1,await this.remoteDB.info()}catch(t){this.error=setTimeout(this.checkServer,3e3,e)}},newUser(e,t){return this.remoteDB.signUp(e,t).then(this.loginUser(e,t)).catch(this.openToast)},loginUser(e,t){return this.remoteDB.logIn(e,t).catch(this.openToast).then(this.setCurrentUser).then(this.startSync).finally(()=>{this.username=this.password=null})},logoutUser(){return this.remoteDB.logOut().then(this.stopSync).catch(this.openToast).finally(this.cleanLocal)},setCurrentUser(){return this.getCurrentUser().then(e=>(this.currentUser=e,this.$pouch.getDB(new URL(this.userDBname(e.name),this.remoteDbUrl))))},setUserStats(){return this.getUserStats(this.$pouch).then(e=>this.userStats={...e}).finally(()=>{navigator.storage.estimate().then(e=>{this.userStats.quota=e.usage/e.quota})})},checkSession(){return this.setCurrentUser().catch(this.logoutUser)},startSync(e){this.syncHandle&&this.stopSync(),this.syncHandle=this.$pouch.sync(e).on("active",()=>this.syncIcon="cloud-sync-outline fade").on("active",()=>console.info("Syncing.")).on("change",()=>this.syncIcon="cloud-sync-outline fade").on("change",this.setUserStats).on("paused",()=>this.syncIcon="cloud-check-outline").on("complete",()=>this.syncIcon="cloud-off-outline").on("error",this.openToast).on("error",()=>this.syncIcon="weather-cloudy-alert").on("denied",this.openToast).on("denied",()=>this.syncIcon="weather-cloudy-alert"),Promise.resolve(this.syncHandle)},cleanLocal(){return this.$pouch.destroy().then(()=>{this.userStats={},this.currentUser=null}).then(()=>this.$pouch.getDB("trace").destroy()).then(console.info("Browser cleaned."))}},filters:{percent(e){return Math.ceil(100*e)+"%"}}},v=f,b=(n("039a"),Object(h["a"])(v,Loginvue_type_template_id_2a2fe218_render,o,!1,null,null,null)),g=b.exports,_={name:"Navbar",components:{AircraftManager:s["a"],Login:g},computed:{currentAircraft(){return this.$store.state.currentAircraft}}},y=_,w=Object(h["a"])(y,Navbarvue_type_template_id_7e6ce05e_render,i,!1,null,null,null),k=w.exports,S={components:{Navbar:k}},D=S,x=(n("5c0b"),Object(h["a"])(D,render,a,!1,null,null,null)),C=x.exports,$=n("acfa"),U=n("2c4e");if("serviceWorker"in navigator){const e=new $["a"]("/service-worker.js");e.addEventListener("installed",e=>{e.isUpdate?U["a"].open({type:"is-warning",message:"Loading new version of naVue.",actionText:null,indefinite:!1,duration:1e3}):U["a"].open({type:"is-warning",message:"naVue is now installed on your device.",actionText:null,indefinite:!1,duration:1e3})}),e.addEventListener("waiting",()=>{U["a"].open({type:"is-warning",indefinite:!0,message:"A new version of naVue is available.",actionText:"Use it now",onAction:()=>{e.messageSW({type:"SKIP_WAITING"})}})}),e.addEventListener("controlling",()=>{window.location.reload()}),e.addEventListener("activated",()=>{U["a"].open({type:"is-warning",message:"Welcome to the new version of naVue.",actionText:null,indefinite:!1,duration:1e3})}),e.register()}var L=n("8c4f");r["a"].use(L["a"]);const N=[{path:"/",name:"Home",component:()=>n.e("chunk-5ac5a83e").then(n.bind(null,"bb51"))},{path:"/aircraft/:id?",name:"Aircraft",component:()=>Promise.all([n.e("chunk-2f5398a4"),n.e("chunk-2d221f18")]).then(n.bind(null,"cd01"))},{path:"/route/:id?",name:"Route",component:()=>Promise.all([n.e("chunk-3e2c2ddc"),n.e("chunk-2f5398a4"),n.e("chunk-9bb762f6"),n.e("chunk-ed85a372")]).then(n.bind(null,"b59c"))},{path:"/moving-map/:id?",name:"MovingMap",component:()=>Promise.all([n.e("chunk-3e2c2ddc"),n.e("chunk-2f5398a4"),n.e("chunk-9bb762f6"),n.e("chunk-300dc543")]).then(n.bind(null,"3935"))},{path:"/replay",name:"Replay",component:()=>n.e("chunk-2d0c8dd2").then(n.bind(null,"5760"))},{path:"/radar/:id?",name:"Radar",component:()=>n.e("chunk-2d0c8dd2").then(n.bind(null,"5760"))},{path:"/local",name:"Local",props:e=>({codes:e.query.poi.split(",")}),component:()=>Promise.all([n.e("chunk-3e2c2ddc"),n.e("chunk-0e671e40")]).then(n.bind(null,"ef22"))},{path:"/about",name:"About",component:()=>n.e("chunk-2d22d746").then(n.bind(null,"f820"))}],A=new L["a"]({mode:"history",routes:N,linkActiveClass:"is-active",scrollBehavior(e){if(e.hash)return{selector:e.hash}}});var O=A,P=n("2f62"),M=n("1caf"),T=n("b98f"),q=n("f9de"),B=n("00b4");r["a"].use(P["a"]);var E=new P["a"].Store({state:{currentUser:null,currentAircraft:null,currentNavigation:null,currentLocation:null,currentFlight:null},mutations:{currentUser:(e,t)=>{if(t){let{derived_key:n,iterations:r,password_scheme:a,salt:i,...s}=t;e.currentUser=s}else e.currentUser=null},currentAircraft(e,t){e.currentAircraft=t?T["a"].from(t):t},currentNavigation(e,t){e.currentNavigation=t?M["a"].from(t):t},currentFlight(e,t){e.currentFlight=t?B["a"].from(t):t},currentLocation(e,t){e.currentLocation=t?q["a"].from(t):t}},actions:{saveToDB(e,t){let n=JSON.parse(JSON.stringify(t));return n._id||(n._id=`${n.type}-${Date.now()}`),this._vm.$pouch.put(n).then(e=>(t._id=e.id,t._rev=e.rev,t))},deleteFromDB(e,t){return this._vm.$pouch.remove(t)}}}),I=n("289d"),j=(n("5363"),n("d6e1")),F=n("fcd3"),W=n("eae4");r["a"].use(I["a"],{defaultProgrammaticPromise:!0}),j["a"].plugin(F["a"]),r["a"].use(W["a"],"navue"),r["a"].config.productionTip=!1,new r["a"]({router:O,store:E,render:e=>e(C)}).$mount("#app")},"5c0b":function(e,t,n){"use strict";var r=n("9c0c"),a=n.n(r);a.a},7174:function(e,t,n){},9283:function(e,t,n){"use strict";var render=function(){var e=this,t=this,n=t.$createElement,r=t._self._c||n;return r("b-dropdown",t._b({scopedSlots:t._u([{key:"trigger",fn:function(){return[t._t("default",[r("b-button",[r("b-tooltip",{attrs:{position:"is-bottom",label:t.selectedData?t.selectedData.registration:"Aircraft"}},[r("b-icon",{attrs:{icon:"airplane",type:t.selectedData?"is-success":""}})],1)],1)],{selected:t.selectedData})]},proxy:!0}],null,!0)},"b-dropdown",t.$attrs,!1),[t.selectedData?[t.$slots.header||t.$scopedSlots.header?r("b-dropdown-item",{attrs:{custom:""}},[t._t("header",null,{selected:t.selectedData})],2):t._e(),t.$slots.header||t.$scopedSlots.header?r("b-dropdown-item",{attrs:{separator:""}}):t._e(),t.edit?[r("b-dropdown-item",{on:{click:t.saveData}},[r("b-icon",{attrs:{icon:"cloud-upload-outline",type:"is-warning"}}),t._v(" Save ")],1),r("b-dropdown-item",{on:{click:t.exportData}},[r("b-icon",{attrs:{icon:"download-outline"}}),t._v(" Export ")],1),t.create?r("b-dropdown-item",{attrs:{disabled:!t.fromDB},on:{click:function(e){t.selectedData=t.cloneData(t.selectedData)}}},[r("b-icon",{attrs:{icon:"plus-circle-multiple-outline"}}),t._v(" Clone ")],1):t._e(),r("b-dropdown-item",{attrs:{disabled:!t.fromDB},on:{click:t.deleteData}},[r("b-icon",{attrs:{icon:"delete-outline",type:"is-danger"}}),t._v(" Delete ")],1)]:t._e(),r("b-dropdown-item",{on:{click:function(e){t.selectedData=void 0}}},[r("b-icon",{attrs:{icon:"selection-off"}}),t._v(" Discard ")],1)]:[r("b-dropdown-item",{attrs:{custom:""}},[r("b-autocomplete",{attrs:{placeholder:"Choose an aircraft",data:t.availableData||[],field:t.searchedProperty,"open-on-focus":"","keep-first":"","clear-on-select":"",clearable:""},on:{select:function(t,n){n.stopPropagation(),e.selectedData=t}},scopedSlots:t._u([{key:"empty",fn:function(){return[r("i",[t._v(t._s(t.search))]),t._v(" not found ")]},proxy:!0}]),model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),t.create?r("b-dropdown-item",{on:{click:t.createData}},[r("b-icon",{attrs:{icon:"plus-circle-outline"}}),t._v(" New Aircraft ")],1):t._e(),t.create?r("b-dropdown-item",[r("b-upload",{attrs:{accept:"application/json",expanded:""},on:{input:t.importData},model:{value:t.upload,callback:function(e){t.upload=e},expression:"upload"}},[r("b-icon",{attrs:{icon:"upload"}}),t._v(" Import ")],1)],1):t._e()],"Aircraft"!=t.$route.name?r("b-dropdown-item",{attrs:{"has-link":""}},[r("router-link",{attrs:{to:{name:"Aircraft"}}},[t._v(" Manage Aircrafts ")])],1):t._e()],2)},r=[],a=n("1db5"),i=n("b98f"),s={name:"AircraftManager",mixins:[a["a"]],data(){return{constructor:i["a"],storeKey:"currentAircraft",searchedProperty:"registration"}}},o=s,c=n("2877"),u=Object(c["a"])(o,render,r,!1,null,null,null);t["a"]=u.exports},"9c0c":function(e,t,n){},b98f:function(e,t,n){"use strict";n.d(t,"a",(function(){return Aircraft}));var r=n("bd67"),a=n("3634");class Aircraft extends r["a"]{constructor({registration:e,manufacturer:t,model:n,paces:i=new r["b"],consumptions:s=new r["b"],balance:o=new r["b"]({date:void 0}),envelopes:c=new r["b"],checklists:u=new r["b"]}={}){i.keep(e=>e instanceof a["f"]?e:void 0),s.keep(e=>e instanceof a["c"]?e:void 0),o.keep(e=>e instanceof a["e"]?e:void 0),c.keep(e=>e instanceof r["b"]?e:void 0),u.keep(e=>e instanceof r["b"]?e:void 0),super({registration:e,manufacturer:t,model:n,paces:i,consumptions:s,balance:o,envelopes:c,checklists:u})}static from({_id:e,_rev:t,type:n,registration:i,manufacturer:s,model:o,paces:c,consumptions:u,balance:l,envelopes:d,checklists:h}={}){if(arguments[0]instanceof this)return arguments[0];if(n!=this.name)throw`Invalid data : 'type' should be '${this.name}' got '${n}'`;{c&&(c=r["b"].from(c,a["f"])),u&&(u=r["b"].from(u,a["c"])),l&&(l=r["b"].from(l,a["e"])),d&&(d=r["b"].from(d,r["b"],a["e"])),h&&(h=r["b"].from(h,r["b"]));let n=new this({registration:i,manufacturer:s,model:o,paces:c,consumptions:u,balance:l,envelopes:d,checklists:h});return e&&t&&Object.assign(n,{_id:e,_rev:t}),n}}}},bd67:function(e,t,n){"use strict";n.d(t,"a",(function(){return Model})),n.d(t,"b",(function(){return Store}));class Model{constructor({type:e,...t}={}){Object.assign(this,t)}toJSON(){return{...this,type:this.constructor.name}}clone(){return this.constructor.from(JSON.parse(JSON.stringify(this)))}static from({type:e,...t}={}){if(arguments[0]instanceof this)return arguments[0];if(e==this.name)return new this(t);throw`Invalid data : 'type' should be '${this.name}' got '${e}'`}}class Store{constructor(e={},...t){this.items=t,Object.assign(this,e)}[Symbol.iterator](){return this.items[Symbol.iterator]()}get length(){return this.items.length}valueOf(){return this.items}get properties(){let{items:e,...t}={...this};return t}get first(){return this.items[0]}get last(){return this.items[this.length-1]}add(e,t){return t?this.items.splice(t,0,e):this.items.push(e),this.length}remove(e,t){return void 0===t&&(t=this.items.indexOf(e)),t>=0&&1==this.items.splice(t,1).length}keep(e){let t=this.items.length;while(t--){let n=e.call(this.items,this.items[t]);void 0==n?this.items.splice(t,1):Object.is(n,this.items[t])||this.items.splice(t,1,n)}return this}toJSON(){return{...this.properties,items:this.items,type:this.constructor.name}}static from({type:e,items:t=[],...n},...r){if(e!=this.name)throw`Invalid data : 'type' should be '${this.name}' got '${e}'`;{let e=r.shift();return new this(n,...t.map(t=>e?e.from(t,...r):t))}}}},f9de:function(e,t,n){"use strict";n.d(t,"b",(function(){return Waypoint})),n.d(t,"a",(function(){return Location}));var r=n("bd67"),a=n("3634"),i=n("d425");class Waypoint extends r["a"]{constructor(e,t,n,r={}){!n||n instanceof a["a"]||(n=new a["a"](n)),super({latitude:e,longitude:t,altitude:n,...r})}set latlng({lat:e,lng:t}={}){this.latitude=e,this.longitude=t}get latlng(){return{lat:this.latitude,lng:this.longitude}}get point(){return new i["a"](this.latitude,this.longitude)}distanceTo(e){return new a["d"](this.point.rhumbDistanceTo(e.point),"m")}bearingTo(e){return new a["b"](this.point.rhumbBearingTo(e.point),"°",{_precision:3})}destinationPoint(e,t){let n=this.point.rhumbDestinationPoint(e,t);return new this.constructor(n.lat,n.lng)}toGeoJSON(){const{latitude:e,longitude:t,...n}=this;return{type:"Feature",properties:n,geometry:this.point.toGeoJSON()}}static from({type:e,latitude:t,longitude:n,altitude:r,latlng:i,...s}){if(arguments[0]instanceof this)return arguments[0];if(e!=this.name)throw`Invalid data : 'type' should be '${this.name}' got '${e}'`;return r&&(r=a["a"].from(r)),i&&(t=t||i.lat,n=n||i.lng),new this(t,n,r,s)}}class Location extends Waypoint{constructor(e,t,n,{accuracy:r,verticalSpeed:a,speed:i,heading:s,timestamp:o,...c}={}){super(e,t,n,{accuracy:r,verticalSpeed:a,speed:i,heading:s,timestamp:o,...c})}_delayFrom(e){return this.timestamp-e.timestamp}_climbFrom(e){return this.altitude-e.altitude}_speedFrom(e){try{if(0==this._delayFrom(e))throw"Teleportation is not yet a possibility";return new a["f"](this.distanceTo(e)/this._delayFrom(e)*1e3)}catch{return}}_verticalSpeedFrom(e){try{if(0==this._delayFrom(e))throw"Teleportation is not yet a possibility";return new a["f"](this._climbFrom(e)/this._delayFrom(e)*1e3)}catch{return}}movementFrom(e){return{speed:this._speedFrom(e),verticalSpeed:this._verticalSpeedFrom(e),heading:e.bearingTo(this)}}toBounds(e=this.accuracy){const t=180*e/40075017,n=t/Math.cos(Math.PI/180*this.latitude);return[[this.latitude-t,this.longitude-n],[this.latitude+t,this.longitude+n]]}positionInSeconds(e,t=this.heading){if(this.speed&&t)return this.destinationPoint(this.speed*e,t.value);throw"cannot calculate futur position, speed & heading should be provided"}static from({accuracy:e,speed:t,heading:n,timestamp:r,...i}={}){return arguments[0]instanceof this?arguments[0]:(e&&(e=new a["d"](e,"m")),t&&(t=a["f"].from(t)),n&&(n=a["b"].from(n)),super.from({...i,accuracy:e,speed:t,heading:n,timestamp:r}))}static fromGeolocationPosition(e){let t,n,r,i;return e.coords.altitude&&(t=new a["a"](e.coords.altitude,"m",{reference:"WGS84",accuracy:e.coords.altitudeAccuracy})),e.coords.accuracy&&(i=new a["d"](e.coords.accuracy,"m")),e.coords.speed&&(n=new a["f"](e.coords.speed,"m/s")),e.coords.heading&&(r=new a["b"](e.coords.heading,"°")),this.from({type:"Location",latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:i,altitude:t,speed:n,heading:r,timestamp:e.timestamp})}static fromLocate({latitude:e,longitude:t,accuracy:n,altitude:r,altitudeAccuracy:i,speed:s,heading:o,timestamp:c}){return r&&(r=new a["a"](r,"m",{reference:"WGS84",accuracy:i})),n&&(n=new a["d"](n,"m")),s&&(s=new a["f"](s,"m/s")),o&&(o=new a["b"](o,"°")),this.from({type:"Location",latitude:e,longitude:t,accuracy:n,altitude:r,speed:s,heading:o,timestamp:c})}}}});
(function(e){function webpackJsonpCallback(t){for(var a,n,s=t[0],o=t[1],u=t[2],l=0,d=[];l<s.length;l++)n=s[l],Object.prototype.hasOwnProperty.call(r,n)&&r[n]&&d.push(r[n][0]),r[n]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a]);c&&c(t);while(d.length)d.shift()();return i.push.apply(i,u||[]),checkDeferredModules()}function checkDeferredModules(){for(var e,t=0;t<i.length;t++){for(var a=i[t],n=!0,s=1;s<a.length;s++){var o=a[s];0!==r[o]&&(n=!1)}n&&(i.splice(t--,1),e=__webpack_require__(__webpack_require__.s=a[0]))}return e}var t={},a={app:0},r={app:0},i=[];function jsonpScriptSrc(e){return __webpack_require__.p+"js/"+({}[e]||e)+"."+{"chunk-0fc0d246":"069e8789","chunk-2d0c8dd2":"59afee2c","chunk-2f5398a4":"e2e43611","chunk-2d221f18":"d56fab61","chunk-43e3b279":"f77bd5e1","chunk-66ac656c":"7a74c14b","chunk-05ee3090":"40d6abec","chunk-6a3eae22":"6fa35bf7","chunk-a3fa1d48":"2f26498a","chunk-698fb2b4":"28965ea9"}[e]+".js"}function __webpack_require__(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,__webpack_require__),r.l=!0,r.exports}__webpack_require__.e=function requireEnsure(e){var t=[],i={"chunk-43e3b279":1,"chunk-66ac656c":1,"chunk-05ee3090":1,"chunk-6a3eae22":1,"chunk-a3fa1d48":1};a[e]?t.push(a[e]):0!==a[e]&&i[e]&&t.push(a[e]=new Promise((function(t,r){for(var i="css/"+({}[e]||e)+"."+{"chunk-0fc0d246":"31d6cfe0","chunk-2d0c8dd2":"31d6cfe0","chunk-2f5398a4":"31d6cfe0","chunk-2d221f18":"31d6cfe0","chunk-43e3b279":"e5fee7d8","chunk-66ac656c":"fbf42266","chunk-05ee3090":"445a7757","chunk-6a3eae22":"48d2b289","chunk-a3fa1d48":"0aac923c","chunk-698fb2b4":"31d6cfe0"}[e]+".css",n=__webpack_require__.p+i,s=document.getElementsByTagName("link"),o=0;o<s.length;o++){var c=s[o],u=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(u===i||u===n))return t()}var l=document.getElementsByTagName("style");for(o=0;o<l.length;o++){c=l[o],u=c.getAttribute("data-href");if(u===i||u===n)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var i=t&&t.target&&t.target.src||n,s=new Error("Loading CSS chunk "+e+" failed.\n("+i+")");s.code="CSS_CHUNK_LOAD_FAILED",s.request=i,delete a[e],d.parentNode.removeChild(d),r(s)},d.href=n;var h=document.getElementsByTagName("head")[0];h.appendChild(d)})).then((function(){a[e]=0})));var n=r[e];if(0!==n)if(n)t.push(n[2]);else{var s=new Promise((function(t,a){n=r[e]=[t,a]}));t.push(n[2]=s);var o,c=document.createElement("script");c.charset="utf-8",c.timeout=120,__webpack_require__.nc&&c.setAttribute("nonce",__webpack_require__.nc),c.src=jsonpScriptSrc(e);var u=new Error;o=function(t){c.onerror=c.onload=null,clearTimeout(l);var a=r[e];if(0!==a){if(a){var i=t&&("load"===t.type?"missing":t.type),n=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+i+": "+n+")",u.name="ChunkLoadError",u.type=i,u.request=n,a[1](u)}r[e]=void 0}};var l=setTimeout((function(){o({type:"timeout",target:c})}),12e4);c.onerror=c.onload=o,document.head.appendChild(c)}return Promise.all(t)},__webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,a){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},__webpack_require__.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(__webpack_require__.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)__webpack_require__.d(a,r,function(t){return e[t]}.bind(null,r));return a},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e["default"]}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="/",__webpack_require__.oe=function(e){throw console.error(e),e};var n=window["webpackJsonp"]=window["webpackJsonp"]||[],s=n.push.bind(n);n.push=webpackJsonpCallback,n=n.slice();for(var o=0;o<n.length;o++)webpackJsonpCallback(n[o]);var c=s;i.push([0,"chunk-vendors"]),checkDeferredModules()})({0:function(e,t,a){e.exports=a("56d7")},"00b4":function(e,t,a){"use strict";a.d(t,"a",(function(){return Flight}));var r=a("bd67"),i=a("f9de");class Flight extends r["a"]{constructor({name:e,notes:t,checked:a=[],milestones:r=[]}={},...n){n.every(e=>e instanceof i["a"])?n=[n]:n.every(e=>e instanceof Array&&e.every(e=>e instanceof Array))&&(n=n.flat()),super({name:e,notes:t,locations:n,checked:a,milestones:r})}addLocation(e){return this.locations[this.locations.length-1].push(i["a"].from(e)),this}addTrace(...e){return e.every(e=>e instanceof Array)&&(e=e.flat()),0==this.locations[0].length?this.locations[0]=e:this.locations.push(e),this}get geom(){return this.locations.map(e=>e.map(({latitude:e,longitude:t,altitude:a})=>[e,t,Number(a)]))}toGeoJSON(e="Feature"){const{locations:t,...a}=this;switch(e){case"Feature":return{type:e,properties:{...a},geometry:this.toGeoJSON("MultiLineString")};case"MultiLineString":return{type:e,coordinates:this.geom};case"MultiPoint":return{type:e,coordinates:this.geom.flat()};default:throw"not a valid GeoJSON object"}}toBounds(){return this.locations.flat().reduce((e,{latitude:t,longitude:a},r)=>0==r?[[t,a],[t,a]]:[[Math.min(t,e[0][0]),Math.min(a,e[0][1])],[Math.max(t,e[1][0]),Math.max(a,e[1][1])]],void 0)}static from({type:e,locations:t,_id:a,_rev:r,...n}={}){if(arguments[0]instanceof this)return arguments[0];if(e!=this.name)throw`Invalid data : 'type' should be '${this.name}' got '${e}'`;{t&&(t=t.map(e=>e.map(e=>i["a"].from(e))));let e=new this(n,...t);return a&&r&&Object.assign(e,{_id:a,_rev:r}),e}}}},"039a":function(e,t,a){"use strict";var r=a("7174"),i=a.n(r);i.a},"08df":function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return n})),a.d(t,"d",(function(){return s}));const r={data(){return{envelopesDataset:{showLines:!0,showLine:!0,fill:"start",borderWidth:2,pointRadius:5,pointHoverRadius:5,tension:0},cgDataset:{borderWidth:2,pointRadius:5,pointHoverRadius:5}}}},i={methods:{readTextFileAsync(e){return new Promise((t,a)=>{let r=new FileReader;r.onload=()=>{t(r.result)},r.onerror=a,r.readAsText(e)})},downloadJSON(e,t){let a=new Blob([JSON.stringify(e,void 0,2)],{type:"application/json",name:t});const r=document.createElement("a");r.href=URL.createObjectURL(a),r.download=t,r.click()},async uploadJSON(e){let t;return t=JSON.parse(await this.readTextFileAsync(e)),t}}},n={methods:{openWarning(e){return this.$buefy.snackbar.open({position:"is-bottom",type:"is-danger",duration:5e3,queue:!1,...e})},confirmAction(e){return this.$buefy.dialog.confirm({type:"is-danger",hasIcon:!0,...e})}}},s={data(){return{wakeLock:null}},mixins:[n],mounted(){"wakeLock"in navigator&&(this.requestWakeLock(),document.addEventListener("visibilitychange",this.requestWakeLock))},beforeDestroy(){"wakeLock"in navigator&&(document.removeEventListener("visibilitychange",this.requestWakeLock),this.wakeLock&&this.wakeLock.release())},methods:{async requestWakeLock(){"visible"===document.visibilityState&&(this.wakeLock=await navigator.wakeLock.request("screen"))}}}},"0c9a":function(e,t,a){"use strict";a.d(t,"a",(function(){return Moment}));var r=a("bd67"),i=a("3634");class Moment extends r["a"]{constructor(e,t,a={}){super({mass:new i["i"](e),lever:new i["d"](t),...a})}get value(){return this.mass.value*this.lever.value}get _value(){return this.mass*this.lever}valueOf(){return this._value}get unit(){return`${this.mass.unit}.${this.lever.unit}`}toJSON(){return{...this,type:this.constructor.name}}static from({type:e,mass:t,lever:a,...r}={}){if(arguments[0]instanceof this)return arguments[0];if(e==this.name)return t&&(t=i["i"].from(t)),a&&(a=i["d"].from(a)),new this(t,a,r);throw`Invalid data : 'type' should be '${this.name}' got '${e}'`}static linearCoG(...e){let t=e.flat().reduce((e,{mass:t,lever:a})=>(e.mass=e.mass.add(t,{precision:t.precision}),e.lever=e.lever.add(new i["d"](a).prod(t),{precision:a.precision}),e),new Moment(0,0));return t.lever=t.lever.prod(1/t.mass),t}}},1:function(e,t){},"1caf":function(e,t,a){"use strict";a.d(t,"a",(function(){return Navigation}));var r=a("bd67"),i=a("f9de");class Navigation extends r["a"]{constructor({name:e,notes:t,assets:a={}}={},...n){n=new r["b"]({},...n).keep(e=>e.keep(e=>e instanceof i["b"]?e:void 0)),super({name:e,notes:t,assets:a,routes:n})}get waypoints(){return this.routes.items.map(e=>e.items).flat()}get poi(){return this.waypoints.map(e=>e.name).filter(e=>/^[A-Z]{4}$/.test(e))}addRoute(...e){return this.routes.add(new r["b"]({},...e)),this.routes.last}removeRoute(e){return this.routes.remove(e)}clearRoute(e){if(e=this.getRoute(e),e&&0==e.length)return this.removeRoute(e),!0}addWaypoint({insertBefore:e,...t}={},a){return a=this.getRoute(a),a.add(i["b"].from({...t,type:"Waypoint"}),e)}removeWaypoint(e,t){return t=this.getRoute(t),Number.isInteger(e)?t.remove(void 0,e):t.remove(e)}getNextWaypoint(e){const t=this.waypoints.indexOf(e);return this.waypoints[t+1]}getRoute(e){return e instanceof r["b"]?e:isFinite(e)?this.routes.items[e]:this.last}getRouteId(e){return e instanceof r["b"]?this.routes.indexOf(e):Number.isInteger(e)?e:this.routes.length-1}toBounds(){return this.waypoints.reduce((e,{latitude:t,longitude:a},r)=>0==r?[[t,a],[t,a]]:[[Math.min(t,e[0][0]),Math.min(a,e[0][1])],[Math.max(t,e[1][0]),Math.max(a,e[1][1])]],void 0)}static from({type:e,routes:t,_id:a,_rev:n,...s}={}){if(arguments[0]instanceof this)return arguments[0];if(e!=this.name)throw`Invalid data : 'type' should be '${this.name}' got '${e}'`;{t&&(t=r["b"].from(t,r["b"],i["b"]));let e=new this(s,...t);return a&&n&&Object.assign(e,{_id:a,_rev:n}),e}}}},"1db5":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("08df");const i={mixins:[r["b"],r["c"]],props:{create:Boolean,edit:Boolean,persistent:Boolean,exist:Boolean},data(){return{search:"",upload:[]}},mounted(){!this.persistent&&!this.exist||this.selectedData||this.createData()},computed:{dataType(){return this.constructor.name},fromDB(){return this.selectedData&&this.selectedData._id&&this.selectedData._rev},selectedData:{get(){return this.$store.state[this.storeKey]},set(e){try{this.$store.commit(this.storeKey,e)}catch(t){0,this.$buefy.dialog.alert({title:"Cannot load item",message:"Selected record is corrupted. It will be purged from database. Do you want to download it localy before ?",type:"is-danger",hasIcon:!0,trapFocus:!0,icon:"cloud-download-outline",confirmText:"Download & Delete",onConfirm:()=>{this.downloadJSON(e,"navue-corrupted-item.json")},canCancel:!0,cancelText:"Just delete it"}),this.$store.dispatch("deleteFromDB",e)}}},selectedName(){return this.selectedData?this.selectedData[this.searchedProperty]:void 0}},pouch:{availableData(){let e={type:this.dataType};return e[this.searchedProperty]={$regex:RegExp(this.search,"i")},{database:"navue",selector:e}}},methods:{createData(e){this.selectedData=new this.constructor(e)},async saveData(){try{this.selectedData=await this.$store.dispatch("saveToDB",this.selectedData),this.openWarning({message:`"${this.selectedName}" saved`})}catch(e){this.dispatchError(e)}},discardData(){this.selectedData=void 0},async deleteData(){try{await this.$store.dispatch("deleteFromDB",this.selectedData),this.selectedData=null,this.openWarning({message:`"${this.selectedName}" deleted`})}catch(e){this.dispatchError(e)}},async importData(e){try{let t=await this.uploadJSON(e);this.selectedData=this.cloneData(t),this.openWarning({message:`"${this.selectedName}" imported`})}catch(t){this.dispatchError(t)}},exportData(){this.selectedData&&this.downloadJSON(this.selectedData,this.selectedName+".json")},cloneData(e){let t=e.clone();return delete t._id,delete t._rev,t.name&&(t.name+="-1"),t.registration&&(t.registration+="(cloned)"),t},dispatchError(e){console.error(e),this.openWarning(e)}}}},3634:function(e,t,a){"use strict";a.d(t,"d",(function(){return Distance})),a.d(t,"a",(function(){return Altitude})),a.d(t,"g",(function(){return Speed})),a.d(t,"c",(function(){return Consumption})),a.d(t,"i",(function(){return Weight})),a.d(t,"b",(function(){return Azimuth})),a.d(t,"f",(function(){return Pressure})),a.d(t,"h",(function(){return Temperature})),a.d(t,"e",(function(){return Frequency}));var r=a("bd67");class Quantity extends r["a"]{constructor(e,t,{type:a,unit:r,precision:i,...n}={}){if(arguments[0]instanceof Quantity)return arguments[0];super(n),t?this.unit=t:this._unit=void 0,e||0===e?this.value=e:(this._value=void 0,this.precision=void 0),i&&(this.precision=i),r&&(this.unit=r)}get value(){return this.constructor.significantValue(this._to(this._value),this.precision)}set value(e){let t=Number(e);if(Number.isNaN(t))throw`\`${e}\` could not be coerced to a number`;this._value=this._from(t),this.precision=this.constructor.significantFigures(e)}get unit(){return this._unit||this.constructor.baseUnit}set unit(e){if(!this.constructor.units[e])throw`'${e}' is not an available unit`;this._unit=e}get factor(){return this.constructor.units[this.unit]}_from(e,t=this.unit){return Number(e)/this._factor(t)}_to(e,t=this.unit){return Number(e)*this._factor(t)}_factor(e){if(this.constructor.units[e])return this.constructor.units[e];throw`'${e}' is not an available unit`}to(e){return this._to(this.value,e)}as(e,t){return Object.assign(this.constructor.from(this),{unit:e,precision:t})}add(e,t){if("number"==typeof e||e instanceof this.constructor)return new this.constructor(this+e,void 0,{precision:Math.min(this.precision,e.precision),unit:this._unit,...t});throw"operands should be of the same type"}prod(e,t){return new this.constructor(this*e,void 0,{precision:Math.min(this.precision,e.precision||this.constructor.significantFigures(e)),unit:this._unit,...t})}valueOf(){return this._value}toString(){let e=Math.max(1,Math.min(this.precision||0,21));return`${isNaN(this.value)?"-":this.value.toLocaleString(void 0,{minimumSignificantDigits:e,maximumSignificantDigits:e})} ${this.unit}`}toJSON(){let{_value:e,_unit:t,...a}=this;return{...a,value:this.value,unit:this.unit,type:this.constructor.name}}static significantFigures(e){let t;if(0===e)return 0;if("number"===typeof e)t=Math.abs(e).toExponential();else{if("string"!==typeof e||Number.isNaN(Number(e)))return;t=e.replace(/^\+|-/,"").replace(/^0+/,"")}t=t.replace(".","");const a=t.lastIndexOf("e");return a>0?a:t.length}static significantValue(e,t=1){if(0===e)return 0;const a=Math.pow(10,t-Math.floor(Math.log(e<0?-e:e)/Math.LN10)-1);return Math.round(e*a)/a}static get units(){throw"list of available units should be set on constructor."}static get baseUnit(){return Object.keys(this.units)[Object.values(this.units).indexOf(1)]}static from({type:e,value:t,unit:a,...r}={}){if(!e||this.name==e)return new this(t,a,r)}}class Distance extends Quantity{static get units(){return{m:1,Km:.001,ft:3.28084,NM:539957e-9,mi:621371e-9,yd:1.09361}}}class Altitude extends Distance{constructor(e,t,{reference:a,...r}={}){if("FL"==t)a="QNE";else if(t&&!a)throw`property 'reference' should be given, got '${a}'`;super(e,t,{...r,reference:a})}get value(){return"FL"==this.unit?this.constructor.significantValue(this._to(this._value),2):this._to(this._value)}set value(e){super.value=e}toString(){return"FL"==this.unit?"FL"+String(this.value).padStart(3,"0"):this.value&&this.reference?`${super.toString()} ${this.reference}`:void 0}static get references(){return["MSL","AGL","QNH","QNE","QFE","WGS84"]}static get units(){return{m:1,ft:3.28084,FL:.0328084}}}class Speed extends Quantity{static get units(){return{"m/s":1,"km/h":3.6,"ft/min":196.85,kt:1.94384,mph:2.23694}}}class Volume extends Quantity{static get units(){return{m3:1,L:1e3,"gal US":264.172,"gal Imp":219.969}}}class Consumption extends Volume{static get references(){return["h","1000ft","u"]}toString(e){return`${super.toString(e)}/${this.reference}`}}class Weight extends Quantity{static get units(){return{kg:1,lb:2.20462,t:.001,"L-avgas":1/.721,"L-JetA1":1.25}}}class Angle extends Quantity{static get units(){return{rad:1,"°":180/Math.PI,gon:200/Math.PI,rev:.5/Math.PI,"₥":3200/Math.PI}}}class Azimuth extends Angle{get value(){return this._to((this._value+2*Math.PI)%(2*Math.PI))}set value(e){super.value=e}}class Pressure extends Quantity{static get units(){return{Pa:1,hPa:.01,Psi:1/6894.76,atm:1/101325,bar:1e-5,inHg:1/3386.389}}}class Temperature extends Quantity{static get units(){return{"°C":[1,0],K:[1,273.15],"°F":[9/5.32]}}_from(e,t=this.unit){return Number(e)/this._factor(t)[0]+this._factor(t)[1]}_to(e,t=this.unit){return(Number(e)-this._factor(t)[1])*this._factor(t)[0]}}class Frequency extends Quantity{static get units(){return{Hz:1,KHz:.001,MHz:1e-5,GHz:1e-8}}}},"56d7":function(e,t,a){"use strict";a.r(t);var r=a("2b0e"),render=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("Navbar",{staticClass:" is-hidden-printer"}),a("router-view")],1)},i=[],Navbarvue_type_template_id_36f1f0f5_render=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-navbar",{staticClass:"is-radiusless",attrs:{"fixed-top":""}},[a("template",{slot:"brand"},[a("b-navbar-item",{attrs:{tag:"router-link",to:{path:"/"}}},[a("img",{attrs:{src:"img/icons/android-chrome-192x192.png",alt:"Navue, a navigation tool for general aviation."}}),a("b-tag",{attrs:{type:"is-danger"}},[e._v("beta")])],1)],1),a("template",{slot:"start"},[a("b-navbar-item",{attrs:{tag:"router-link",to:{name:"Briefing"}}},[e._v("Briefing")]),a("b-navbar-item",{attrs:{tag:"router-link",to:{name:"Fly"}}},[e._v("Fly")]),a("b-navbar-item",{attrs:{tag:"router-link",to:{name:"Debriefing"},disabled:""}},[e._v("Debriefing")]),a("b-navbar-item",{attrs:{tag:"router-link",to:{name:"Monitor"}}},[e._v("Monitor")])],1),a("template",{slot:"end"},[a("b-navbar-item",[a("AircraftManager",{attrs:{triggers:["click","hover"]},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.selected;return[a("b-button",{attrs:{type:"is-primary","icon-right":"chevron-down"}},[e._v(" "+e._s(r?r.registration:"Select an aircraft")+" ")])]}}])})],1),a("b-navbar-dropdown",{attrs:{hoverable:"",collapsible:"",right:""}},[a("template",{slot:"label"},[a("b-icon",{attrs:{icon:"account"}})],1),a("b-navbar-item",{staticStyle:{"min-width":"30vw"},attrs:{tag:"div"}},[a("Login")],1)],2)],1)],2)},n=[],s=a("7226"),Loginvue_type_template_id_bffc7274_render=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("nav",{staticClass:"level"},[a("div",{staticClass:"level-item has-text-centered"},[a("div",[a("p",{staticClass:"heading"},[e._v("Aircrafts")]),a("p",{staticClass:"title"},[e._v(e._s(e.userStats.Aircraft||0))])])]),a("div",{staticClass:"level-item has-text-centered"},[a("div",[a("p",{staticClass:"heading"},[e._v("Navigations")]),a("p",{staticClass:"title"},[e._v(e._s(e.userStats.Navigation||0))])])]),a("div",{staticClass:"level-item has-text-centered"},[a("div",[a("p",{staticClass:"heading"},[e._v("Flights")]),a("p",{staticClass:"title"},[e._v(e._s(e.userStats.Flight||0))])])]),a("div",{staticClass:"level-item has-text-centered"},[a("div",[a("p",{staticClass:"heading"},[e._v("Storage")]),a("p",{staticClass:"title"},[e._v(e._s(e._f("percent")(e.userStats.storage||0)))])])])]),a("b-loading",{attrs:{"is-full-page":!1,active:!!e.error}}),e.currentUser?a("div",[a("nav",{staticClass:"level is-mobile"},[a("div",{staticClass:"level-item has-text-centered"},[a("b-icon",{attrs:{icon:e.syncIcons[e.syncStatus]}})],1),a("div",{staticClass:"level-item has-text-centered"},[a("h5",{staticClass:"title is-5"},[e._v(e._s(e.currentUser.name))])])]),a("nav",{staticClass:"level"},[a("div",{staticClass:"level-item has-text-centered"},[a("b-button",{attrs:{type:"is-primary","icon-left":"account-arrow-right-outline"},on:{click:e.logoutUser}},[e._v("Sign out")])],1),a("div",{staticClass:"level-item has-text-centered"},[a("b-button",{attrs:{type:"is-primary is-light","icon-left":"account-edit-outline"},on:{click:e.openDetails}},[e._v("Edit")])],1)])]):a("fieldset",[a("b-field",{attrs:{label:"Email",horizontal:""}},[a("b-input",{attrs:{type:"email",icon:"email",placeholder:"pilote@navue.io",required:""},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),a("b-field",{attrs:{label:"Password",horizontal:""}},[a("b-input",{attrs:{type:"password",icon:"lock",placeholder:"*******",required:"","password-reveal":""},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),a("b-field",{attrs:{"is-grouped":""}},[a("b-button",{staticClass:"is-primary",attrs:{"icon-left":"account-arrow-left-outline",expanded:""},on:{click:function(t){return e.loginUser(e.username,e.password)}}},[e._v("Sign in")]),a("b-button",{staticClass:"is-primary is-light",attrs:{"icon-left":"account-plus-outline"},on:{click:function(t){return e.createUser(e.username,e.password)}}},[e._v("Create Account")]),e.gotLocalData?a("b-button",{staticClass:"is-danger is-light",attrs:{"icon-left":"database-remove"},on:{click:e.cleanLocal}},[e._v("Clear device")]):e._e()],1)],1)],1)},o=[],UserDetailsvue_type_template_id_2fe7fb40_render=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"modal-card"},[a("header",{staticClass:"modal-card-head"},[a("p",{staticClass:"modal-card-title"},[e._v(e._s(e.value.name))]),a("button",{staticClass:"delete",attrs:{type:"button"},on:{click:function(t){return e.$emit("close")}}})]),a("fieldset",{staticClass:"modal-card-body"},[a("b-taglist",e._l(e.value.roles,(function(t){return a("b-tag",{key:t,attrs:{type:"is-primary",size:"is-medium"}},[e._v(e._s(t))])})),1),a("b-field",{attrs:{label:"Licences"}},[a("b-taginput",{attrs:{ellipsis:"",icon:"label",placeholder:"Add a Licence","aria-close-label":"Delete this tag"},model:{value:e.value.licences,callback:function(t){e.$set(e.value,"licences",t)},expression:"value.licences"}})],1),a("b-field",{attrs:{label:"Organization"}},[a("b-input",{attrs:{type:"text",icon:"domain"},model:{value:e.value.organization,callback:function(t){e.$set(e.value,"organization",t)},expression:"value.organization"}})],1),a("b-button",{attrs:{type:"is-primary","icon-left":"account-edit-outline",expanded:""},on:{click:function(t){return e.updateMetadata(e.metadata)}}},[e._v("Save")]),a("div",{staticClass:"divider is-danger"},[e._v("Danger Zone")]),a("b-field",{attrs:{type:"is-warning"}},[a("b-input",{attrs:{type:"password","password-reveal":"",expanded:"",autocomplete:"new-password",icon:"account-key"},model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}}),a("p",{staticClass:"control"},[a("b-button",{attrs:{type:"is-warning is-light","icon-left":"lock-reset"},on:{click:function(t){return e.confirmAndupdatePassword(e.newPassword)}}},[e._v("Change Password")])],1)],1),a("b-button",{attrs:{expanded:"",type:"is-danger","icon-left":"account-remove"},on:{click:function(t){return e.confirmAnddeleteUser()}}},[e._v("Delete Account")])],1),a("footer",{staticClass:"modal-card-foot"},[e._v(" Member since "+e._s(e._f("asDate")(e.value.created_at))+" ")])])},c=[];const u={data(){return{syncHandle:null,remoteDbUrl:new URL("https://db.treville.fr:8443")}},async created(){let e,t,a,r={_id:"_design/user",views:{"count-items":{map:function({type:e}){emit(e)}.toString(),reduce:"_count"},stats:{map:function({type:e,length:t,duration:a}){switch(e){case"Navigation":emit("NavigationDistance",t||0);break;case"Flight":emit("FlightTime",a||0);break;default:emit(e)}}.toString(),reduce:"_sum"}}};try{({_rev:e,views:t}=await this.$pouch.get(r._id))}catch{a=!0}finally{(a||JSON.stringify(t)!=JSON.stringify(r.views))&&await this.$pouch.put({_rev:e,...r})}},computed:{currentUser:{get(){return this.$store.state.currentUser},set(e){this.$store.commit("currentUser",e)}},remoteDB(){return this.$pouch.getDB(this.remoteDbUrl)}},methods:{async setCurrentUser(){try{const{userCtx:{name:e}}=await this.remoteDB.getSession();if(e)return this.currentUser=await this.remoteDB.getUser(e),this.$pouch.getDB(new URL(this.userDBname(this.currentUser.name),this.remoteDbUrl));new Error("No session available.")}catch(e){console.error(e)}},userDBname(e){return"userdb-"+Array.from(e).map(e=>e.charCodeAt(0)<128?e.charCodeAt(0).toString(16):encodeURIComponent(e).replace(/%/g,"").toLowerCase()).join("")},getUserStats(e){return Promise.allSettled([e.query("user/count-items",{group:!0}).then(({rows:e})=>e.reduce((e,t)=>(e[t.key]=t.value,e),{})),navigator.storage.estimate().then(({usage:e,quota:t})=>({storage:e/t}))]).then(e=>e.reduce((e,{status:t,value:a})=>("fulfilled"==t&&(e={...e,...a}),e),{})).catch(console.error)},startSync(e,t){this.stopSync(),this.syncHandle=this.$pouch.sync(e,{}),t&&this.syncHandle.on("active",e=>t("active",e)).on("change",e=>t("change",e)).on("paused",e=>t("paused",e)).on("complete",e=>t("complete",e)).on("error",e=>t("error",e)).on("denied",e=>t("denied",e))},stopSync(){if(this.syncHandle)return this.syncHandle.cancel()},async cleanLocal(){await this.$pouch.viewCleanup();try{await this.$pouch.destroy()}finally{this.$store.commit("cleanStore")}}}};var l=a("08df"),d={name:"UserDetails",mixins:[u,l["c"]],data(){return{newPassword:null,confirm:{deleteUser:{title:"Deleting account",message:"Are you sure you want to <b>delete</b> your account? This action cannot be undone.",confirmText:"Delete Account"},updatePassword:{type:"is-warning",title:"Change Password",message:"Are you sure you want to <b>change</b> current password.",confirmText:"Change password"}}}},props:["value"],computed:{metadata(){const{_id:e,_rev:t,type:a,name:r,roles:i,...n}=this.value;return n}},methods:{async confirmAnddeleteUser(){const{result:e}=await this.confirmAction(this.confirm.deleteUser);if(e)try{await this.remoteDB.deleteUser(this.value.name),this.$emit("update-user"),this.$emit("close"),this.openWarning({message:"Account deleted."})}catch(t){this.openWarning(t)}},async updateMetadata(e){try{await this.remoteDB.putUser(this.value.name,{metadata:e}),this.$emit("update-user"),this.$emit("close"),this.openWarning({message:"Account saved."})}catch(t){this.openWarning(t)}},async confirmAndupdatePassword(e){const{result:t}=await this.confirmAction(this.confirm.updatePassword);if(t)try{await this.remoteDB.changePassword(this.value.name,e),this.$emit("close"),this.openWarning({message:"Password changed."})}catch(a){this.openWarning(a)}finally{this.newPassword=null}}},filters:{asDate(e){return new Date(e).toLocaleString(void 0,{year:"numeric",month:"long",day:"numeric"})}}},h=d,p=a("2877"),m=Object(p["a"])(h,UserDetailsvue_type_template_id_2fe7fb40_render,c,!1,null,null,null),f=m.exports,g={name:"Login",mixins:[u,l["c"]],data(){return{statsFeed:void 0,username:null,password:null,userStats:{},importData:{title:"Import data",type:"is-warning",message:"Some data are present in this device. Would you like to import them into your account ?",confirmText:"Yes",cancelText:"No"},syncStatus:"complete",syncIcons:{active:"cloud-sync-outline fade",change:"cloud-sync-outline fade",paused:"cloud-check-outline",complete:"cloud-off-outline",error:"weather-cloudy-alert",denied:"weather-cloudy-alert"},serverPresent:void 0,error:!1}},async mounted(){this.serverPresent=await this.checkServer("navue")},async created(){await this.setupUser()},beforeDestroy(){this.statsFeed&&this.statsFeed.cancel()},computed:{gotLocalData(){return this.userStats.constructor===Object&&Object.keys(this.userStats).length>1}},methods:{async checkServer(e){try{return clearTimeout(this.error),this.error=!1,await this.remoteDB.info()}catch(t){this.error=setTimeout(this.checkServer,3e3,e)}},async createUser(e,t){try{await this.remoteDB.signUp(e,t,{metadata:{created_at:new Date}}),this.openWarning({message:"Welcome on navue !",duration:5e3}),await this.loginUser(e,t)}catch(a){this.openWarning(a)}},async setupUser(){try{this.setUserStats(),this.setStatsFeed();const e=await this.setCurrentUser();if(e)return await this.startSync(e,this.syncHandler),!0}catch(e){console.error(e)}},async loginUser(e,t){this.stopSync();try{if(await this.remoteDB.logIn(e,t),this.gotLocalData){const{result:e}=await this.confirmAction(this.importData);e||this.cleanLocal()}await this.setupUser(),this.openWarning({message:"You're in !",duration:1e3}),this.username=this.password=null}catch(a){this.openWarning(a)}},async logoutUser(){this.stopSync();try{await this.remoteDB.logOut(),this.currentUser=void 0,this.openWarning({message:"You're out !",duration:1e3})}catch(e){this.openWarning(e)}finally{this.cleanLocal()}},setStatsFeed(){this.statsFeed=this.$pouch.getDB().on("destroyed",e=>{e&&(this.$pouch.getDB(),this.statsFeed&&this.statsFeed.cancel(),this.setUserStats(),this.statsFeed=this.setStatsFeed())}).changes({since:"now",live:!0,view:"user/count-items",filter:"_view"}).on("change",this.setUserStats)},async setUserStats(){this.userStats=await this.getUserStats(this.$pouch)},async checkSession(){try{return await this.setCurrentUser()}catch{this.logoutUser()}},syncHandler(e,t){this.syncStatus=e,e in["error","denied"]&&this.openWarning(t)},openDetails(){this.modal=this.$buefy.modal.open({parent:this,component:f,props:{value:this.currentUser},events:{"update-user":this.checkSession},hasModalCard:!1,trapFocus:!0,"append-to-body":!0})}},filters:{percent(e){return Math.ceil(100*e)+"%"}}},v=g,b=(a("039a"),Object(p["a"])(v,Loginvue_type_template_id_bffc7274_render,o,!1,null,null,null)),y=b.exports,_={name:"Navbar",components:{AircraftManager:s["a"],Login:y},computed:{currentAircraft(){return this.$store.state.currentAircraft}}},w=_,k=Object(p["a"])(w,Navbarvue_type_template_id_36f1f0f5_render,n,!1,null,null,null),S=k.exports,D={components:{Navbar:S}},x=D,N=(a("5c0b"),Object(p["a"])(x,render,i,!1,null,null,null)),$=N.exports,C=a("acfa"),L=a("2c4e");const A=new C["a"]("/service-worker.js");var O=A;if("serviceWorker"in navigator){const e={type:"is-warning",actionText:null,indefinite:!1,duration:1e3};A.addEventListener("installed",t=>{t.isUpdate?L["a"].open({...e,message:"Loading new version of naVue."}):L["a"].open({...e,message:"naVue is now installed on your device."})}),A.addEventListener("waiting",()=>{L["a"].open({...e,indefinite:!0,message:"A new version of naVue is available.",actionText:"Use it now",onAction:()=>{A.messageSW({type:"SKIP_WAITING"})}})}),A.addEventListener("controlling",()=>{window.location.reload()}),A.addEventListener("activated",()=>{L["a"].open({...e,message:"Welcome to the new version of naVue."})}),A.register()}var P=a("8c4f");r["a"].use(P["a"]);const F=[{path:"/",name:"Home",component:()=>a.e("chunk-0fc0d246").then(a.bind(null,"bb51"))},{path:"/aircraft",name:"Aircraft",component:()=>Promise.all([a.e("chunk-2f5398a4"),a.e("chunk-2d221f18")]).then(a.bind(null,"cd01"))},{path:"/brief",name:"Briefing",component:()=>Promise.all([a.e("chunk-43e3b279"),a.e("chunk-2f5398a4"),a.e("chunk-66ac656c"),a.e("chunk-6a3eae22")]).then(a.bind(null,"a0f4"))},{path:"/fly",name:"Fly",component:()=>Promise.all([a.e("chunk-43e3b279"),a.e("chunk-2f5398a4"),a.e("chunk-66ac656c"),a.e("chunk-05ee3090")]).then(a.bind(null,"ef23"))},{path:"/debrief",name:"Debriefing",component:()=>a.e("chunk-2d0c8dd2").then(a.bind(null,"5760"))},{path:"/monitor",name:"Monitor",component:()=>a.e("chunk-2d0c8dd2").then(a.bind(null,"5760"))},{path:"/local",name:"Local",component:()=>Promise.all([a.e("chunk-43e3b279"),a.e("chunk-a3fa1d48")]).then(a.bind(null,"ef22"))},{path:"/about",name:"About",component:()=>a.e("chunk-698fb2b4").then(a.bind(null,"f820"))}],M=new P["a"]({mode:"history",routes:F,linkActiveClass:"is-active"});var U=M,W=a("2f62"),B=a("1caf"),j=a("b98f"),T=a("f9de"),q=a("00b4");r["a"].use(W["a"]);var E=new W["a"].Store({state:{currentUser:void 0,currentAircraft:void 0,currentNavigation:void 0,currentLocation:void 0,currentFlight:void 0,currentQueries:{}},getters:{pois(e){return e.currentNavigation&&e.currentNavigation.poi||[]}},mutations:{currentUser(e,{derived_key:t,iterations:a,password_scheme:r,salt:i,...n}={}){e.currentUser=0==Object.keys(n).length?void 0:n},currentAircraft(e,t){e.currentAircraft=t?j["a"].from(t):t},currentNavigation(e,t){e.currentNavigation=t?B["a"].from(t):t},currentFlight(e,t){e.currentFlight=t?q["a"].from(t):t},currentLocation(e,t){e.currentLocation=t?T["a"].from(t):t},currentQueries(e,t){e.currentQueries={...e.currentQueries,...t}},cleanStore(e){e.currentUser=void 0,e.currentAircraft=void 0,e.currentNavigation=void 0,e.currentFlight=void 0,e.currentLocation=void 0,e.currentQueries={}}},actions:{async saveToDB(e,t){let a=JSON.parse(JSON.stringify(t));a._id||(a._id=`${a.type}-${Date.now()}`);let{id:r}=await this._vm.$pouch.put(a);return await this._vm.$pouch.get(r,{include_docs:!0})},deleteFromDB(e,t){return this._vm.$pouch.remove(t)}}}),I=a("289d"),J=(a("5363"),a("d6e1")),R=a("fcd3"),Q=a("eae4");r["a"].use(I["a"],{defaultProgrammaticPromise:!0}),J["a"].plugin(R["a"]),r["a"].use(Q["a"],"navue"),r["a"].config.productionTip=!1,new r["a"]({router:U,store:E,render:e=>e($)}).$mount("#app").$sw=O},"5c0b":function(e,t,a){"use strict";var r=a("9c0c"),i=a.n(r);i.a},7174:function(e,t,a){},7226:function(e,t,a){"use strict";var render=function(){var e=this,t=this,a=t.$createElement,r=t._self._c||a;return r("b-dropdown",t._b({scopedSlots:t._u([{key:"trigger",fn:function(){return[t._t("default",[r("b-button",[r("b-tooltip",{attrs:{position:"is-bottom",label:t.selectedData?t.selectedData.registration:"Aircraft"}},[r("b-icon",{attrs:{icon:"airplane",type:t.selectedData?"is-success":""}})],1)],1)],{selected:t.selectedData})]},proxy:!0}],null,!0)},"b-dropdown",t.$attrs,!1),[t.selectedData?[t.$slots.header||t.$scopedSlots.header?r("b-dropdown-item",{attrs:{custom:""}},[t._t("header",null,{selected:t.selectedData})],2):t._e(),t.$slots.header||t.$scopedSlots.header?r("b-dropdown-item",{attrs:{separator:""}}):t._e(),t.edit?[r("b-dropdown-item",{on:{click:t.saveData}},[r("b-icon",{attrs:{icon:"cloud-upload-outline",type:"is-warning"}}),t._v(" Save ")],1),r("b-dropdown-item",{on:{click:t.exportData}},[r("b-icon",{attrs:{icon:"download-outline"}}),t._v(" Export ")],1),t.create?r("b-dropdown-item",{attrs:{disabled:!t.fromDB},on:{click:function(e){t.selectedData=t.cloneData(t.selectedData)}}},[r("b-icon",{attrs:{icon:"plus-circle-multiple-outline"}}),t._v(" Clone ")],1):t._e(),r("b-dropdown-item",{attrs:{disabled:!t.fromDB},on:{click:t.deleteData}},[r("b-icon",{attrs:{icon:"delete-outline",type:"is-danger"}}),t._v(" Delete ")],1)]:t._e(),r("b-dropdown-item",t._g({},t.persistent?{click:t.createData}:{click:t.discardData}),[r("b-icon",{attrs:{icon:"selection-off"}}),t._v(" Discard ")],1)]:[r("b-dropdown-item",{attrs:{custom:""}},[r("b-autocomplete",{attrs:{placeholder:"Choose an aircraft",data:t.availableData||[],field:t.searchedProperty,"open-on-focus":"","keep-first":"","clear-on-select":"",clearable:""},on:{select:function(t,a){a.stopPropagation(),e.selectedData=t}},scopedSlots:t._u([t.search?{key:"empty",fn:function(){return[r("i",[t._v(t._s(t.search))]),t._v(" not found ")]},proxy:!0}:{key:"empty",fn:function(){return[t._v(" No aircraft registered ")]},proxy:!0}],null,!0),model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),t.create?r("b-dropdown-item",{on:{click:t.createData}},[r("b-icon",{attrs:{icon:"plus-circle-outline"}}),t._v(" New Aircraft ")],1):t._e(),t.create?r("b-dropdown-item",[r("b-upload",{attrs:{accept:"application/json",expanded:""},on:{input:t.importData},model:{value:t.upload,callback:function(e){t.upload=e},expression:"upload"}},[r("b-icon",{attrs:{icon:"upload"}}),t._v(" Import ")],1)],1):t._e()],"Aircraft"!=t.$route.name?r("b-dropdown-item",{attrs:{"has-link":""}},[r("router-link",{attrs:{to:{name:"Aircraft"}}},[t._v(" Manage Aircrafts ")])],1):t._e()],2)},r=[],i=a("1db5"),n=a("b98f"),s={name:"AircraftManager",mixins:[i["a"]],data(){return{constructor:n["a"],storeKey:"currentAircraft",searchedProperty:"registration"}}},o=s,c=a("2877"),u=Object(c["a"])(o,render,r,!1,null,null,null);t["a"]=u.exports},"9c0c":function(e,t,a){},b98f:function(e,t,a){"use strict";a.d(t,"a",(function(){return Aircraft}));var r=a("bd67"),i=a("3634"),n=a("0c9a");class Aircraft extends r["a"]{constructor({registration:e,manufacturer:t,model:a,paces:s=new r["b"],consumptions:o=new r["b"],balance:c=new r["b"]({date:void 0}),envelopes:u=new r["b"],checklists:l=new r["b"]}={}){s.keep(e=>e instanceof i["g"]?e:void 0),o.keep(e=>e instanceof i["c"]?e:void 0),c.keep(e=>e instanceof n["a"]?e:void 0),u.keep(e=>e instanceof r["b"]?e:void 0),l.keep(e=>e instanceof r["b"]?e:void 0),super({registration:e,manufacturer:t,model:a,paces:s,consumptions:o,balance:c,envelopes:u,checklists:l})}static from({_id:e,_rev:t,type:a,registration:s,manufacturer:o,model:c,paces:u,consumptions:l,balance:d,envelopes:h,checklists:p}={}){if(arguments[0]instanceof this)return arguments[0];if(a!=this.name)throw`Invalid data : 'type' should be '${this.name}' got '${a}'`;{u&&(u=r["b"].from(u,i["g"])),l&&(l=r["b"].from(l,i["c"])),d&&(d=r["b"].from(d,n["a"])),h&&(h=r["b"].from(h,r["b"],n["a"])),p&&(p=r["b"].from(p,r["b"]));let a=new this({registration:s,manufacturer:o,model:c,paces:u,consumptions:l,balance:d,envelopes:h,checklists:p});return e&&t&&Object.assign(a,{_id:e,_rev:t}),a}}}},bd67:function(e,t,a){"use strict";a.d(t,"a",(function(){return Model})),a.d(t,"b",(function(){return Store}));class Model{constructor({type:e,...t}={}){Object.assign(this,t)}toJSON(){return{...this,type:this.constructor.name}}clone(){return this.constructor.from(JSON.parse(JSON.stringify(this)))}static from({type:e,...t}={}){if(arguments[0]instanceof this)return arguments[0];if(e==this.name)return new this(t);throw`Invalid data : 'type' should be '${this.name}' got '${e}'`}}class Store{constructor(e={},...t){this.items=t,Object.assign(this,e)}[Symbol.iterator](){return this.items[Symbol.iterator]()}get length(){return this.items.length}valueOf(){return this.items}get properties(){let{items:e,...t}={...this};return t}get first(){return this.items[0]}get last(){return this.items[this.length-1]}add(e,t){return t?this.items.splice(t,0,e):this.items.push(e),this.length}remove(e,t){return void 0===t&&(t=this.items.indexOf(e)),t>=0&&1==this.items.splice(t,1).length}keep(e){let t=this.items.length;while(t--){let a=e.call(this.items,this.items[t]);void 0==a?this.items.splice(t,1):Object.is(a,this.items[t])||this.items.splice(t,1,a)}return this}toJSON(){return{...this.properties,items:this.items,type:this.constructor.name}}static from({type:e,items:t=[],...a},...r){if(e!=this.name)throw`Invalid data : 'type' should be '${this.name}' got '${e}'`;{let e=r.shift();return new this(a,...t.map(t=>e?e.from(t,...r):t))}}}},f9de:function(e,t,a){"use strict";a.d(t,"b",(function(){return Waypoint})),a.d(t,"a",(function(){return Location}));var r=a("bd67"),i=a("3634"),n=a("d425");class Waypoint extends r["a"]{constructor(e,t,a,r={}){!a||a instanceof i["a"]||(a=new i["a"](a)),super({latitude:e,longitude:t,altitude:a,...r})}set latlng({lat:e,lng:t}={}){this.latitude=e,this.longitude=t}get latlng(){return{lat:this.latitude,lng:this.longitude}}get point(){return new n["a"](this.latitude,this.longitude)}distanceTo(e,t){return new i["d"](this.point.rhumbDistanceTo(e.point),"m",t)}bearingTo(e,t){return new i["b"](this.point.rhumbBearingTo(e.point),"°",t)}destinationPoint(e,t){let a=this.point.rhumbDestinationPoint(e,t);return new this.constructor(a.lat,a.lng)}toGeoJSON(e="Feature"){const{latitude:t,longitude:a,altitude:r,...i}=this;switch(e){case"Feature":return{type:e,properties:{...i,altitude:r.toJSON()},geometry:this.toGeoJSON("Point")};case"Point":return{type:e,coordinates:this.toGeoJSON("Position")};case"Position":return[t,a,Number(r)];default:throw"not a valid GeoJSON object"}}static from({type:e,latitude:t,longitude:a,altitude:r,latlng:n,...s}){if(arguments[0]instanceof this)return arguments[0];if(e!=this.name)throw`Invalid data : 'type' should be '${this.name}' got '${e}'`;return r&&(r=i["a"].from(r)),n&&(t=t||n.lat,a=a||n.lng),new this(t,a,r,s)}}class Location extends Waypoint{constructor(e,t,a,{accuracy:r,speed:i,heading:n,timestamp:s,...o}={}){super(e,t,a,{accuracy:r,speed:i,heading:n,timestamp:s,...o})}_delayFrom({timestamp:e}){return this.timestamp-e}_climbFrom({altitude:e}){return this.altitude-e}_speedFrom(e){if(0==this._delayFrom(e))throw"Teleportation is not yet a possibility";return new i["g"](this.distanceTo(e)/this._delayFrom(e)*1e3)}_verticalSpeedFrom(e){if(0==this._delayFrom(e))throw"Teleportation is not yet a possibility";return new i["g"](this._climbFrom(e)/this._delayFrom(e)*1e3)}movementFrom(e){return{speed:this._speedFrom(e),verticalSpeed:this._verticalSpeedFrom(e),heading:e.bearingTo(this)}}toBounds(e=this.accuracy){const t=180*e/40075017,a=t/Math.cos(Math.PI/180*this.latitude);return[[this.latitude-t,this.longitude-a],[this.latitude+t,this.longitude+a]]}positionInSeconds(e,t=this.heading){if(this.speed&&t)return this.destinationPoint(this.speed*e,t.value);throw"cannot calculate futur position, speed & heading should be provided"}static from({accuracy:e,speed:t,heading:a,timestamp:r,...n}={}){return arguments[0]instanceof this?arguments[0]:(e&&(e=i["d"].from(e)),t&&(t=i["g"].from(t)),a&&(a=i["b"].from(a)),delete n._id,delete n._rev,super.from({...n,accuracy:e,speed:t,heading:a,timestamp:r}))}static fromGeolocationPosition(e){let t,a,r,n;return e.coords.altitude&&(t=new i["a"](e.coords.altitude,"m",{reference:"WGS84",accuracy:e.coords.altitudeAccuracy})),e.coords.accuracy&&(n=new i["d"](e.coords.accuracy,"m")),e.coords.speed&&(a=new i["g"](e.coords.speed,"m/s")),e.coords.heading&&(r=new i["b"](e.coords.heading,"°")),this.from({type:"Location",latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:n,altitude:t,speed:a,heading:r,timestamp:e.timestamp})}static fromLocate({latitude:e,longitude:t,accuracy:a,altitude:r,altitudeAccuracy:n,speed:s,heading:o,timestamp:c}){return r&&(r=new i["a"](r,"m",{reference:"WGS84",accuracy:n})),a&&(a=new i["d"](a,"m")),s&&(s=new i["g"](s,"m/s")),o&&(o=new i["b"](o,"°")),this.from({type:"Location",latitude:e,longitude:t,accuracy:a,altitude:r,speed:s,heading:o,timestamp:c})}}}});